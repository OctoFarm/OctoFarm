<% const base = '../' %>
<% const modal = base + '/octofarm-modal.ejs' %>

<div class="row">
    <div class="col-12">
        <% let disabledUsers = "" %>
        <% if(!serverSettings.server.loginRequired){ %>
            <% disabledUsers = "disabled=true" %>
            <div class="alert alert-warning " role="alert">
                The server has the login requirement turned off, the users below cannot be used.
            </div>
        <% } %>
    </div>
    <div class="col-12">
        <div class="float-right">
            <button id="createUserBtn" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#userCreateModal" <%=disabledUsers%>><i class="fas fa-user-plus"></i> New User</button>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12 mt-2 table-responsive">
        <table id="" class="table-hover table table-striped table-bordered">
            <thead>
            <tr>
                <th scope="col" class="sticky-table table-dark" style="">Name</th>
                <th scope="col" class="sticky-table table-dark" style="">Username</th>
                <th scope="col" class="sticky-table table-dark" style="">Group</th>
                <th scope="col" class="sticky-table table-dark" style="">Created Date</th>
                <th scope="col" class="sticky-table table-dark" style="">Actions</th>
            </tr>
            </thead>
            <tbody id="userTable">
            <% userList.forEach(user => { %>
                <% if(user.name === currentUser.name || currentUser.name === ""){ %>
                <!-- Current user, do not allow password reset, edit, delete! -->
                <tr id="userRow-<%=user._id%>">
                    <th id="userRowName-<%=user._id%>" scope="row"><%= user.name %></th>
                    <td id="userRowUserName-<%=user._id%>"><%= user.username %></td>
                    <td id="userRowUserGroup-<%=user._id%>"><%= user.group %></td>
                    <td><%= user.date.toLocaleDateString() %></td>
                    <td class="text-center">
                        <button id="resetPasswordBtn-<%=user._id%>" type="button" class="btn btn-warning  btn-sm" data-bs-toggle="modal" data-bs-target="#usersResetPasswordModal" disabled><i class="fas fa-user-shield"></i> Reset Password</button>
                        <button id="editUserBtn-<%=user._id%>" type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#userEditModal" disabled><i class="fas fa-user-edit"></i> Edit</button>
                        <button id="deleteUserBtn-<%=user._id%>" type="button" class="btn btn-danger btn-sm" disabled><i class="fas fa-user-minus"></i> Delete</button>
                    </td>
                </tr>
                <% } else { %>
                <tr id="userRow-<%=user._id%>">
                    <th id="userRowName-<%=user._id%>" scope="row"><%= user.name %></th>
                    <td id="userRowUserName-<%=user._id%>"><%= user.username %></td>
                    <td id="userRowUserGroup-<%=user._id%>"><%= user.group %></td>
                    <td><%= user.date.toLocaleDateString() %></td>
                    <td class="text-center">
                        <button id="resetPasswordBtn-<%=user._id%>" type="button" class="btn btn-warning  btn-sm" data-bs-toggle="modal" data-bs-target="#usersResetPasswordModal"><i class="fas fa-user-shield"></i> Reset Password</button>
                        <button id="editUserBtn-<%=user._id%>" type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#userEditModal"><i class="fas fa-user-edit"></i> Edit</button>
                        <button id="deleteUserBtn-<%=user._id%>" type="button" class="btn btn-danger btn-sm"><i class="fas fa-user-minus"></i> Delete</button>
                    </td>
                </tr>
                <% } %>

            <% }) %>
            </tbody>
        </table>
    </div>
</div>
