!function e(t,n,r){function a(c,i){if(!n[c]){if(!t[c]){var s="function"==typeof require&&require;if(!i&&s)return s(c,!0);if(o)return o(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[c]={exports:{}};t[c][0].call(l.exports,(function(e){return a(t[c][1][e]||e)}),l,l.exports,e,t,n,r)}return n[c].exports}for(var o="function"==typeof require&&require,c=0;c<r.length;c++)a(r[c]);return a}({1:[function(e,t,n){"use strict";var r=c(e("./lib/functions/calc.js")),a=c(e("./lib/octoprint.js")),o=c(e("./lib/functions/ui.js"));function c(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}var u=null;if(window.Worker)try{null===u&&((u=new Worker("/assets/js/workers/monitoringViewsWorker.min.js")).onmessage=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0!=t.data?p(t.data.currentOperations.operations,t.data.currentOperations.count,t.data.printersInformation):o.default.createAlert("error","Communication with the server has been suddenly lost, trying to re-establish connection...",1e4,"Clicked");case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){s(o,r,a,c,i,"next",e)}function i(e){s(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}())}catch(e){console.log(e)}else console.log("Web workers not available... sorry!");var l=[],d=function(e){var t=_.findIndex(l,(function(t){return t._id==e}));a.default.file(l[t],l[t].currentJob.filePath,"load")},f=function(e){var t=_.findIndex(l,(function(t){return t._id==e}));a.default.file(l[t],l[t].currentJob.filePath,"print")};function p(e,t,n){(l=n,0===e.length)&&document.querySelectorAll("[id^='currentOpCard-']").forEach((function(e){cardt.id.split("-")}));document.getElementById("completeCount").innerHTML="Complete: "+t.complete,document.getElementById("idleCount").innerHTML="Idle: "+t.idle,document.getElementById("activeCount").innerHTML="Active: "+t.active,document.getElementById("disconCount").innerHTML="Disconnected: "+t.disconnected,document.getElementById("offlineCount").innerHTML="Offline: "+t.offline,document.getElementById("farmProgress").innerHTML=t.farmProgress+"%",document.getElementById("farmProgress").style="width: ".concat(t.farmProgress,"%"),document.getElementById("farmProgress").classList="progress-bar progress-bar-striped bg-".concat(t.farmProgressColour),(e=_.orderBy(e,["progress"],["desc"])).forEach((function(t,n){var a=new Date;a=a.getTime();var o=new Date(a+1e3*t.timeRemaining).toDateString(),c=new Date(a+1e3*t.timeRemaining).toTimeString(),s=o+": "+(c=c.substring(0,8)),u="<button id='currentHarvest-".concat(t.index,"' type='button' title=\"Clear your finished print from current operations\" class='tag btn btn-success btn-sm mt-0 pt-0 pb-0'>Print Harvested?</button>"),l="<button id='restartCurrentPrint-".concat(t.index,"' type='button' title=\"Restart your current selected print\" class='tag btn btn-warning btn-sm mt-0 pt-0 pb-0'>Restart Print</button>"),p=null;if(void 0!==i(t.fileName)&&(p=t.fileName.replace(".gcode","")).length>15&&p.substring(0,16),document.getElementById("currentOpCard-"+t.index)){document.getElementById("viewPanel-"+t.index).style.display="inline-block",100===t.progress?(document.getElementById("finishedPrint-"+t.index).classList.remove("d-none"),document.getElementById("futureDate-"+t.index).classList.add("d-none"),document.getElementById("currentRestart-"+t.index).classList.remove("d-none"),document.getElementById("currentTime-"+t.index).classList.add("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.add("d-none")):(document.getElementById("finishedPrint-"+t.index).classList.add("d-none"),document.getElementById("futureDate-"+t.index).classList.remove("d-none"),document.getElementById("currentRestart-"+t.index).classList.add("d-none"),document.getElementById("currentTime-"+t.index).classList.remove("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.remove("d-none"));var m=document.getElementById("currentProgress-"+t.index);document.getElementById("currentTime-"+t.index).innerHTML=r.default.generateTime(t.timeRemaining),m.style="width: ".concat(t.progress,"%"),m.innerHTML=t.progress+"%",m.className="progress-bar progress-bar-striped bg-".concat(t.progressColour)}else document.getElementById("currentOperationsBody").insertAdjacentHTML("beforeend",'\n            <div class="col-2 pt-0 pb-0" id="viewPanel-'.concat(t.index,'">\n                <div id="currentOpCard-').concat(t.index,'"\n                class="card card-block text-white bg-secondary d-inline-block"\n                 style="width:100%;"\n              >\n                  <div class="card-header pb-1 pt-1 pl-2 pr-2">\n                     ').concat(t.name,'</div>\n                  <div class="card-body pb-0 pt-2 pl-2 pr-2 pb-1">\n                  <h6 id="currentFile-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;"> ').concat(p,' </h6>\n                  <h6 id="currentRestart-').concat(t.index,'" class="pb-0 text-center d-none" style="font-size:0.6rem;">').concat(l,'</h6>\n                  <h6 id="currentTime-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;">').concat(r.default.generateTime(t.timeRemaining),'</h6>\n        <h6 id="futureDate-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;"> ').concat(s,' </h6>\n        <h6 id="finishedPrint-').concat(t.index,'" class="pb-0 text-center d-none" style="font-size:0.6rem;"> ').concat(u,' </h6>\n                    <div id="currentProgressMain-').concat(t.index,'" class="progress">\n                      <div id="currentProgress-').concat(t.index,'"\n                        class="progress-bar progress-bar-striped bg-').concat(t.progressColour,'"\n                        role="progressbar"\n                        style="width: ').concat(t.progress,'%"\n                        aria-valuenow="').concat(t.progress,'"\n                        aria-valuemin="0"\n                        aria-valuemax="100"\n                      >\n                      ').concat(t.progress,"%\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                ")),document.getElementById("currentHarvest-"+t.index).addEventListener("click",(function(e){var n=document.getElementById("currentHarvest-"+t.index).id.split("-");d(n[1])})),document.getElementById("restartCurrentPrint-"+t.index).addEventListener("click",(function(e){var n=document.getElementById("restartCurrentPrint-"+t.index).id.split("-");f(n[1])}));document.getElementById("currentOpCard-"+t.index).style.order=n;var y=document.querySelectorAll("[id^='currentOpCard-']"),v=[];e.forEach((function(e){v.push(e.index)}));var g=[];y.forEach((function(e){var t=e.id.split("-");g.push(t[1])})),_.difference(g,v).forEach((function(e){document.getElementById("viewPanel-"+e).style.display="none"}))}))}document.querySelectorAll("[id^='currentHarvest-']").forEach((function(e){e.addEventListener("click",(function(t){var n=e.id.split("-");document.getElementById("viewPanel-"+n[1]).style.display="none",d(n[1])}))})),document.querySelectorAll("[id^='restartCurrentPrint-']").forEach((function(e){e.addEventListener("click",(function(t){var n=e.id.split("-");f(n[1])}))}))},{"./lib/functions/calc.js":2,"./lib/functions/ui.js":3,"./lib/octoprint.js":7}],2:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"randomString",value:function(){return Math.random().toString(36).substr(2,5)}},{key:"toFixed",value:function(e,t){return null!=e?e.toFixed(t):0}},{key:"generateTime",value:function(e){var t="";if(void 0===e||isNaN(e)||null===e)t="No Time Estimate";else{Math.floor(e/131400);var n=Math.floor(e/86400);e-=3600*n*24;var r=Math.floor(e/3600);e-=3600*r;var a=Math.floor(e/60);e-=60*a,e=Math.floor(e),t="".concat(n,"d, ").concat(r,"h, ").concat(a,"m, ").concat(e,"s"),0==a&&t.includes("0m")&&(t=t.replace(" 0m,","")),0==r&&t.includes("0h")&&(t=t.replace(" 0h,","")),0==n&&t.includes("0d")&&(t=t.replace("0d,","")),0==a&&0==r&&0==n&&0==e&&(t=t.replace("0s","Done"))}return t}},{key:"isBetween",value:function(e,t,n){return(e-t)*(e-n)<=0}},{key:"returnPrintCost",value:function(e,t){if(void 0===e)return"No cost settings to calculate from";var n=t/3600,r=parseFloat(e.powerConsumption)*parseFloat(e.electricityCosts)*n,a=parseFloat(e.purchasePrice),o=parseFloat(e.estimateLifespan);return(r+((o>0?a/o:0)+parseFloat(e.maintenanceCosts))*n).toFixed(2)}},{key:"bytes",value:function(e,t){if(void 0===e||isNaN(e)||null===e)return"No File Estimate";if(0==e)return"0 Bytes";var n=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,r)).toFixed(n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])}},{key:"dateClean",value:function(e){return e=new Date(e),"".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDay(),": ").concat(e.getHours(),":").concat(e.getSeconds())}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],3:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"getColour",value:function(e){return"Operational"===e?{name:"secondary",hex:"#262626",category:"Idle"}:"Paused"===e?{name:"warning",hex:"#583c0e",category:"Idle"}:"Printing"===e||"Pausing"===e||"Cancelling"===e?{name:"warning",hex:"#583c0e",category:"Active"}:"Error"===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Offline"===e?{name:"danger",hex:"#2e0905",category:"Offline"}:"Searching..."===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Closed"===e?{name:"danger",hex:"#2e0905",category:"Closed"}:"Complete"===e?{name:"success",hex:"#00330e",category:"Complete"}:{name:"danger",hex:"#2e0905",category:"Offline"}}},{key:"createMessage",value:function(e,t){var n=document.getElementById(t),r='\n      <div class="alert alert-'.concat(e.type,' alert-dismissible fade show" role="alert">\n        ').concat(e.msg,'\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    ');n.insertAdjacentHTML("beforeend",r)}},{key:"createAlert",value:function(e,t,n,r){r=null!=r?["click"]:[],Noty.setMaxVisible(50),new Noty({type:e,theme:"bootstrap-v4",closeWith:r,timeout:n,layout:"bottomRight",text:t}).show()}},{key:"doesElementNeedUpdating",value:function(e,t,n){e!==t[n]&&(t[n]=e)}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],4:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"URL",value:function(e){var t;return t||(t=document.createElement("input")).setAttribute("type","url"),t.value=e,t.validity.valid}},{key:"IP",value:function(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}},{key:"JSON",value:function(e){return!!/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}},{key:"getName",value:function(e){return void 0!==e.settingsAppearance?""===e.settingsAppearance.name||null===e.settingsAppearance.name?e.printerURL:e.settingsAppearance.name:e.printerURL}},{key:"stripHTML",value:function(e){var t=document.createElement("DIV");t.innerHTML=e;var n=t.textContent||t.innerText||"";return n.replace("â€‹",""),n=n.trim()}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.checkFilamentManager=function(){return i.apply(this,arguments)},n.returnDropDown=function(e){return s.apply(this,arguments)},n.selectFilament=function(e,t,n){return u.apply(this,arguments)};var r,a=(r=e("../octofarm.js"))&&r.__esModule?r:{default:r};function o(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function i(e){o(c,r,a,i,s,"next",e)}function s(e){o(c,r,a,i,s,"throw",e)}i(void 0)}))}}function i(){return(i=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.get("settings/server/get");case 2:return t=e.sent,e.next=5,t.json();case 5:return t=e.sent,e.abrupt("return",t.filamentManager);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(){return(s=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.get("filament/get/dropDownList");case 2:return n=e.sent,e.next=5,n.json();case 5:if(n=e.sent,!t){e.next=10;break}return e.abrupt("return",n.selected.historyDropDown);case 10:return e.abrupt("return",n.selected.normalDropDown);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return(u=c(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={tool:r,printerId:t,spoolId:n},e.next=3,a.default.post("filament/select",o);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"../octofarm.js":6}],6:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"get",value:function(e){var t="/".concat(e);return fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}})}},{key:"delete",value:function(e){var t="/".concat(e);return fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}})}},{key:"post",value:function(e,t){var n="/".concat(e);return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(e("./functions/ui.js")),a=o(e("./octofarm.js"));o(e("./functions/validate.js")),e("./modules/filamentGrab.js");function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o,c,u,l,d,f,p,m,y;return t=e,n=null,o=[{key:"post",value:function(e,t,n){var r="".concat(e.printerURL,"/api/").concat(t);return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)})}},{key:"folder",value:function(e,t,n){var r="".concat(e.printerURL,"/api/files/").concat(t);return fetch(r,{method:"POST",headers:{"X-Api-Key":e.apikey},body:n})}},{key:"move",value:function(e,t,n){var r="".concat(e.printerURL,"/api/").concat(t);return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)})}},{key:"delete",value:function(e,t){var n="".concat(e.printerURL,"/api/").concat(t);return fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}})}},{key:"selectTool",value:(y=i(regeneratorRuntime.mark((function t(n,r){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n.printerURL,r),a={command:"select",tool:r},t.next=4,e.post(n,"printer/tool",a);case 4:if(204!==t.sent.status){t.next=9;break}return t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(e,t){return y.apply(this,arguments)})},{key:"system",value:(m=i(regeneratorRuntime.mark((function t(n,a){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o="system/commands/core/"+a,bootbox.confirm({message:"Are your sure you want to ".concat(a," ").concat(n.printerName,"?"),buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(t){return i(regeneratorRuntime.mark((function c(){return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!t){c.next=5;break}return c.next=3,e.post(n,o);case 3:204===c.sent.status?r.default.createAlert("success","".concat(n.printerName,": ").concat(a," was successful"),3e3,"clicked"):r.default.createAlert("error","".concat(n.printerName,": ").concat(a," was unsuccessful. Please make sure printer is connected and commands are setup in Settings -> Server."),3e3,"clicked");case 5:case"end":return c.stop()}}),c)})))()}});case 2:case"end":return t.stop()}}),t)}))),function(e,t){return m.apply(this,arguments)})},{key:"move",value:(p=i(regeneratorRuntime.mark((function t(n,r,a,o,c){var i,s,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(){n.target.classList="btn btn-light"},s="printer/printhead",t.next=5,document.querySelectorAll("#pcAxisSteps > .btn.active");case 5:return u=(u=t.sent)[0].innerHTML,l=null,"home"===a?l={command:a,axes:o}:"jog"===a?(u=Number(null!=c?c+u:u),p=u,(f=o)in(d={command:a})?Object.defineProperty(d,f,{value:p,enumerable:!0,configurable:!0,writable:!0}):d[f]=p,l=d):"feedrate"===a&&(l={command:a,factor:u}),t.next=11,e.post(r,s,l);case 11:204===t.sent.status?(n.target.classList="btn btn-success",setTimeout(i,500)):(n.target.classList="btn btn-danger",setTimeout(i,500));case 13:case"end":return t.stop()}var d,f,p}),t)}))),function(e,t,n,r,a){return p.apply(this,arguments)})},{key:"file",value:(f=i(regeneratorRuntime.mark((function t(n,o,c,i){var s,u,l,d,f,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s="files/local/"+o,u=null,"load"!==c){t.next=9;break}return l={command:"select",print:!1},t.next=6,e.post(n,s,l);case 6:u=t.sent,t.next=26;break;case 9:if("print"!==c){t.next=22;break}return d={command:"select",print:!0},f={command:"flowrate",factor:parseInt(n.flowRate)},t.next=14,e.post(n,"printer/tool",f);case 14:return p={command:"feedrate",factor:parseInt(n.feedRate)},t.next=17,e.post(n,"printer/printhead",p);case 17:return t.next=19,e.post(n,s,d);case 19:u=t.sent,t.next=26;break;case 22:if("delete"!==c){t.next=26;break}return t.next=25,e.delete(n,s);case 25:u=t.sent;case 26:if(204!==u.status){t.next=38;break}if("delete"!==c){t.next=35;break}return m={i:n,fullPath:o},t.next=31,a.default.post("printers/removefile",m);case 31:t.sent,r.default.createAlert("success","".concat(n.printerName,": ").concat(c," completed"),3e3,"clicked"),t.next=36;break;case 35:r.default.createAlert("success","".concat(n.printerName,": ").concat(c," actioned"),3e3,"clicked");case 36:t.next=39;break;case 38:r.default.createAlert("error","".concat(n.printerName,": ").concat(c," failed"),3e3,"clicked");case 39:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return f.apply(this,arguments)})},{key:"jobAction",value:(d=i(regeneratorRuntime.mark((function t(n,r,o){var c,s,u,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.get("settings/server/get");case 2:return c=t.sent,t.next=5,c.json();case 5:return c=t.sent,s={command:"flowrate",factor:parseInt(n.flowRate)},t.next=9,e.post(n,"printer/tool",s);case 9:return u={command:"feedrate",factor:parseInt(n.feedRate)},t.next=12,e.post(n,"printer/printhead",u);case 12:if(n._id,l=!1,void 0!==c.filament&&(l=c.filament.filamentCheck),d=!1,null!=n.selectedFilament&&Array.isArray(n.selectedFilament)&&(d=n.selectedFilament.every((function(e){return null!==e}))),!l||d||"start"!==r.command){t.next=21;break}bootbox.confirm({message:"You have spools in the inventory, but none selected. Would you like to select a spool?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(t){return i(regeneratorRuntime.mark((function a(){var c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=3;break}a.next=15;break;case 3:if(null==n.selectedFilament||!Array.isArray(n.selectedFilament)){a.next=9;break}return c={command:"offset",offsets:{}},n.selectedFilament.forEach((function(e,t){null!=e&&(c.offsets["tool"+t]=e.spools.tempOffset)})),a.next=8,e.post(n,"printer/tool",c);case 8:a.sent;case 9:return a.next=11,e.post(n,"printer/printhead",u);case 11:return a.next=13,e.post(n,"job",r);case 13:a.sent,o.target.disabled=!1;case 15:case"end":return a.stop()}}),a)})))()}}),t.next=27;break;case 21:return t.next=23,e.post(n,"printer/printhead",u);case 23:return t.next=25,e.post(n,"job",r);case 25:t.sent,o.target.disabled=!1;case 27:case"end":return t.stop()}}),t)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"connect",value:(l=i(regeneratorRuntime.mark((function t(n,a){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null,o="connect"===n?{command:"connect",port:document.getElementById("pmSerialPort").value,baudrate:parseInt(document.getElementById("pmBaudrate").value),printerProfile:document.getElementById("pmProfile").value,save:!0}:{command:"disconnect"},t.next=4,e.post(a,"connection",o);case 4:204===t.sent.status?(r.default.createAlert("success","".concat(a.printerName,": has ").concat(o.command,"ed successfully."),3e3,"click"),"connect"===n?(document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0):(document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1)):r.default.createAlert("error","".concat(a.printerName,": could not ").concat(o.command,"."),3e3,"click");case 6:case"end":return t.stop()}}),t)}))),function(e,t){return l.apply(this,arguments)})},{key:"power",value:(u=i(regeneratorRuntime.mark((function e(t,n,a,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.includes("[PrinterURL]")&&(n=n.replace("[PrinterURL]",t.printerURL)),n.includes("[PrinterAPI]")&&(n=n.replace("[PrinterAPI]",t.apikey)),void 0!==o&&0!==o.length){e.next=9;break}return e.next=5,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"}});case 5:204!==e.sent.status?r.default.createAlert("error","".concat(t.printerName,": Could not complete ").concat(a),3e3):r.default.createAlert("success","".concat(t.printerName,": Successfully completed ").concat(a),3e3),e.next=13;break;case 9:return e.next=11,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":t.apikey},body:o});case 11:204!==e.sent.status?r.default.createAlert("error","".concat(t.printerName,": Could not complete ").concat(a),3e3):r.default.createAlert("success","".concat(t.printerName,": Successfully completed ").concat(a),3e3);case 13:return e.abrupt("return","done");case 14:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"getPowerStatus",value:(c=i(regeneratorRuntime.mark((function e(t,n,r){var a,o,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.includes("[PrinterURL]")&&(n=n.replace("[PrinterURL]",t.printerURL)),n.includes("[PrinterAPI]")&&(n=n.replace("[PrinterAPI]",t.apikey)),void 0!==r&&""!=r){e.next=16;break}return e.next=5,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"}});case 5:if(200===(a=e.sent).status&&204===a.status){e.next=10;break}return e.abrupt("return","No Status");case 10:return e.next=12,a.json();case 12:return a=e.sent,e.abrupt("return",a);case 14:e.next=32;break;case 16:return e.prev=16,e.next=19,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":t.apikey},body:r});case 19:if(o=e.sent,c="No Status",200!==o.status&&204!==o.status){e.next=25;break}return e.next=24,o.json();case 24:c=e.sent;case 25:(i=document.getElementById("printerStatus-"+t._id))&&("No Status"===c?i.style.color="black":c[Object.keys(c)[0]]?i.style.color="green":i.style.color="red"),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(16),console.log("Printer Power Check failed... classing offline:",e.t0);case 32:case"end":return e.stop()}}),e,null,[[16,29]])}))),function(e,t,n){return c.apply(this,arguments)})}],n&&s(t.prototype,n),o&&s(t,o),e}();n.default=u},{"./functions/ui.js":3,"./functions/validate.js":4,"./modules/filamentGrab.js":5,"./octofarm.js":6}]},{},[1]);
//# sourceMappingURL=currentOperationsViewRunner.min.js.map
