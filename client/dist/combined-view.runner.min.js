/*! For license information please see combined-view.runner.min.js.LICENSE.txt */
(()=>{var t={696:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},2868:(e,t,n)=>{e.exports=n(1867)},3155:(e,t,n)=>{"use strict";var r=n(4030),i=n(8079),o=n(4687),a=n(7512),s=n(9791),l=n(924),c=n(5903),u=n(5971);e.exports=function(e){return new Promise((function(t,n){var d=e.data,p=e.headers,f=e.responseType;r.isFormData(d)&&delete p["Content-Type"];var m=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",h=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";p.Authorization="Basic "+btoa(g+":"+h)}var b=s(e.baseURL,e.url);function y(){if(m){var r="getAllResponseHeaders"in m?l(m.getAllResponseHeaders()):null,o={data:f&&"text"!==f&&"json"!==f?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m};i(t,n,o),m=null}}if(m.open(e.method.toUpperCase(),a(b,e.params,e.paramsSerializer),!0),m.timeout=e.timeout,"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(y)},m.onabort=function(){m&&(n(u("Request aborted",e,"ECONNABORTED",m)),m=null)},m.onerror=function(){n(u("Network Error",e,null,m)),m=null},m.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",m)),m=null},r.isStandardBrowserEnv()){var v=(e.withCredentials||c(b))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;v&&(p[e.xsrfHeaderName]=v)}"setRequestHeader"in m&&r.forEach(p,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete p[t]:m.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(m.withCredentials=!!e.withCredentials),f&&"json"!==f&&(m.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&m.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){m&&(m.abort(),n(e),m=null)})),d||(d=null),m.send(d)}))}},1867:(e,t,n)=>{"use strict";var r=n(4030),i=n(3843),o=n(5891),a=n(3316);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var l=s(n(457));l.Axios=o,l.create=function(e){return s(a(l.defaults,e))},l.Cancel=n(6266),l.CancelToken=n(9747),l.isCancel=n(9416),l.all=function(e){return Promise.all(e)},l.spread=n(1545),l.isAxiosError=n(232),e.exports=l,e.exports.default=l},6266:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},9747:(e,t,n)=>{"use strict";var r=n(6266);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},9416:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},5891:(e,t,n)=>{"use strict";var r=n(4030),i=n(7512),o=n(8036),a=n(884),s=n(3316),l=n(9084),c=l.validators;function u(e){this.defaults=e,this.interceptors={request:new o,response:new o}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!r){var u=[a,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(o),i=Promise.resolve(e);u.length;)i=i.then(u.shift(),u.shift());return i}for(var d=e;n.length;){var p=n.shift(),f=n.shift();try{d=p(d)}catch(e){f(e);break}}try{i=a(d)}catch(e){return Promise.reject(e)}for(;o.length;)i=i.then(o.shift(),o.shift());return i},u.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=u},8036:(e,t,n)=>{"use strict";var r=n(4030);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},9791:(e,t,n)=>{"use strict";var r=n(957),i=n(7050);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},5971:(e,t,n)=>{"use strict";var r=n(3136);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},884:(e,t,n)=>{"use strict";var r=n(4030),i=n(8630),o=n(9416),a=n(457);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},3136:e=>{"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},3316:(e,t,n)=>{"use strict";var r=n(4030);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function l(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=l(void 0,e[i])):n[i]=l(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=l(void 0,t[e]))})),r.forEach(o,c),r.forEach(a,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=l(void 0,e[i])):n[i]=l(void 0,t[i])})),r.forEach(s,(function(r){r in t?n[r]=l(e[r],t[r]):r in e&&(n[r]=l(void 0,e[r]))}));var u=i.concat(o).concat(a).concat(s),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return r.forEach(d,c),n}},8079:(e,t,n)=>{"use strict";var r=n(5971);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8630:(e,t,n)=>{"use strict";var r=n(4030),i=n(457);e.exports=function(e,t,n){var o=this||i;return r.forEach(n,(function(n){e=n.call(o,e,t)})),e}},457:(e,t,n)=>{"use strict";var r=n(4030),i=n(7122),o=n(3136),a={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=n(3155)),l),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(0,JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,a=!n&&"json"===this.responseType;if(a||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(a)})),e.exports=c},3843:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},7512:(e,t,n)=>{"use strict";var r=n(4030);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},7050:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4687:(e,t,n)=>{"use strict";var r=n(4030);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},957:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},232:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},5903:(e,t,n)=>{"use strict";var r=n(4030);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},7122:(e,t,n)=>{"use strict";var r=n(4030);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},924:(e,t,n)=>{"use strict";var r=n(4030),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},1545:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},9084:(e,t,n)=>{"use strict";var r=n(696),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={},a=r.version.split(".");function s(e,t){for(var n=t?t.split("."):a,r=e.split("."),i=0;i<3;i++){if(n[i]>r[i])return!0;if(n[i]<r[i])return!1}return!1}i.transitional=function(e,t,n){var i=t&&s(t);function a(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,s){if(!1===e)throw new Error(a(r," has been removed in "+t));return i&&!o[r]&&(o[r]=!0,console.warn(a(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},e.exports={isOlderVersion:s,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],a=t[o];if(a){var s=e[o],l=void 0===s||a(s,o,e);if(!0!==l)throw new TypeError("option "+o+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},4030:(e,t,n)=>{"use strict";var r=n(3843),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:l,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){l(t[r])&&l(n)?t[r]=e(t[r],n):l(n)?t[r]=e({},n):o(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},3059:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",l=32,c=128,u=1/0,d=9007199254740991,p=NaN,f=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",l],["partialRight",64],["rearg",256]],g="[object Arguments]",h="[object Array]",b="[object Boolean]",y="[object Date]",v="[object Error]",w="[object Function]",E="[object GeneratorFunction]",_="[object Map]",L="[object Number]",B="[object Object]",T="[object Promise]",S="[object RegExp]",I="[object Set]",x="[object String]",P="[object Symbol]",C="[object WeakMap]",k="[object ArrayBuffer]",M="[object DataView]",A="[object Float32Array]",$="[object Float64Array]",O="[object Int8Array]",H="[object Int16Array]",R="[object Int32Array]",F="[object Uint8Array]",N="[object Uint8ClampedArray]",D="[object Uint16Array]",j="[object Uint32Array]",U=/\b__p \+= '';/g,W=/\b(__p \+=) '' \+/g,q=/(__e\(.*?\)|\b__t\)) \+\n'';/g,z=/&(?:amp|lt|gt|quot|#39);/g,J=/[&<>"']/g,V=RegExp(z.source),G=RegExp(J.source),Y=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,se=/,? & /,le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,he=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ve=/($^)/,we=/['\n\r\u2028\u2029\\]/g,Ee="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",_e="a-z\\xdf-\\xf6\\xf8-\\xff",Le="A-Z\\xc0-\\xd6\\xd8-\\xde",Be="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Te="["+Be+"]",Se="["+Ee+"]",Ie="\\d+",xe="["+_e+"]",Pe="[^\\ud800-\\udfff"+Be+Ie+"\\u2700-\\u27bf"+_e+Le+"]",Ce="\\ud83c[\\udffb-\\udfff]",ke="[^\\ud800-\\udfff]",Me="(?:\\ud83c[\\udde6-\\uddff]){2}",Ae="[\\ud800-\\udbff][\\udc00-\\udfff]",$e="["+Le+"]",Oe="(?:"+xe+"|"+Pe+")",He="(?:"+$e+"|"+Pe+")",Re="(?:['’](?:d|ll|m|re|s|t|ve))?",Fe="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ne="(?:"+Se+"|"+Ce+")?",De="[\\ufe0e\\ufe0f]?",je=De+Ne+"(?:\\u200d(?:"+[ke,Me,Ae].join("|")+")"+De+Ne+")*",Ue="(?:"+["[\\u2700-\\u27bf]",Me,Ae].join("|")+")"+je,We="(?:"+[ke+Se+"?",Se,Me,Ae,"[\\ud800-\\udfff]"].join("|")+")",qe=RegExp("['’]","g"),ze=RegExp(Se,"g"),Je=RegExp(Ce+"(?="+Ce+")|"+We+je,"g"),Ve=RegExp([$e+"?"+xe+"+"+Re+"(?="+[Te,$e,"$"].join("|")+")",He+"+"+Fe+"(?="+[Te,$e+Oe,"$"].join("|")+")",$e+"?"+Oe+"+"+Re,$e+"+"+Fe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ie,Ue].join("|"),"g"),Ge=RegExp("[\\u200d\\ud800-\\udfff"+Ee+"\\ufe0e\\ufe0f]"),Ye=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ke=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ze=-1,Qe={};Qe[A]=Qe[$]=Qe[O]=Qe[H]=Qe[R]=Qe[F]=Qe[N]=Qe[D]=Qe[j]=!0,Qe[g]=Qe[h]=Qe[k]=Qe[b]=Qe[M]=Qe[y]=Qe[v]=Qe[w]=Qe[_]=Qe[L]=Qe[B]=Qe[S]=Qe[I]=Qe[x]=Qe[C]=!1;var Xe={};Xe[g]=Xe[h]=Xe[k]=Xe[M]=Xe[b]=Xe[y]=Xe[A]=Xe[$]=Xe[O]=Xe[H]=Xe[R]=Xe[_]=Xe[L]=Xe[B]=Xe[S]=Xe[I]=Xe[x]=Xe[P]=Xe[F]=Xe[N]=Xe[D]=Xe[j]=!0,Xe[v]=Xe[w]=Xe[C]=!1;var et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tt=parseFloat,nt=parseInt,rt="object"==typeof global&&global&&global.Object===Object&&global,it="object"==typeof self&&self&&self.Object===Object&&self,ot=rt||it||Function("return this")(),at=t&&!t.nodeType&&t,st=at&&e&&!e.nodeType&&e,lt=st&&st.exports===at,ct=lt&&rt.process,ut=function(){try{return st&&st.require&&st.require("util").types||ct&&ct.binding&&ct.binding("util")}catch(e){}}(),dt=ut&&ut.isArrayBuffer,pt=ut&&ut.isDate,ft=ut&&ut.isMap,mt=ut&&ut.isRegExp,gt=ut&&ut.isSet,ht=ut&&ut.isTypedArray;function bt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function yt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function vt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Et(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function _t(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function Lt(e,t){return!(null==e||!e.length)&&At(e,t,0)>-1}function Bt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Tt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function St(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function It(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function xt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Pt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Ct=Rt("length");function kt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Mt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function At(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Mt(e,Ot,n)}function $t(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Ot(e){return e!=e}function Ht(e,t){var n=null==e?0:e.length;return n?Dt(e,t)/n:p}function Rt(e){return function(t){return null==t?i:t[e]}}function Ft(e){return function(t){return null==e?i:e[t]}}function Nt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Dt(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function jt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ut(e){return e?e.slice(0,sn(e)+1).replace(re,""):e}function Wt(e){return function(t){return e(t)}}function qt(e,t){return Tt(t,(function(t){return e[t]}))}function zt(e,t){return e.has(t)}function Jt(e,t){for(var n=-1,r=e.length;++n<r&&At(t,e[n],0)>-1;);return n}function Vt(e,t){for(var n=e.length;n--&&At(t,e[n],0)>-1;);return n}function Gt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Yt=Ft({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),Kt=Ft({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Zt(e){return"\\"+et[e]}function Qt(e){return Ge.test(e)}function Xt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function nn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function rn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function on(e){return Qt(e)?function(e){for(var t=Je.lastIndex=0;Je.test(e);)++t;return t}(e):Ct(e)}function an(e){return Qt(e)?function(e){return e.match(Je)||[]}(e):function(e){return e.split("")}(e)}function sn(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var ln=Ft({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function e(t){var n,r=(t=null==t?ot:cn.defaults(ot.Object(),t,cn.pick(ot,Ke))).Array,ie=t.Date,Ee=t.Error,_e=t.Function,Le=t.Math,Be=t.Object,Te=t.RegExp,Se=t.String,Ie=t.TypeError,xe=r.prototype,Pe=_e.prototype,Ce=Be.prototype,ke=t["__core-js_shared__"],Me=Pe.toString,Ae=Ce.hasOwnProperty,$e=0,Oe=(n=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",He=Ce.toString,Re=Me.call(Be),Fe=ot._,Ne=Te("^"+Me.call(Ae).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=lt?t.Buffer:i,je=t.Symbol,Ue=t.Uint8Array,We=De?De.allocUnsafe:i,Je=en(Be.getPrototypeOf,Be),Ge=Be.create,et=Ce.propertyIsEnumerable,rt=xe.splice,it=je?je.isConcatSpreadable:i,at=je?je.iterator:i,st=je?je.toStringTag:i,ct=function(){try{var e=co(Be,"defineProperty");return e({},"",{}),e}catch(e){}}(),ut=t.clearTimeout!==ot.clearTimeout&&t.clearTimeout,Ct=ie&&ie.now!==ot.Date.now&&ie.now,Ft=t.setTimeout!==ot.setTimeout&&t.setTimeout,un=Le.ceil,dn=Le.floor,pn=Be.getOwnPropertySymbols,fn=De?De.isBuffer:i,mn=t.isFinite,gn=xe.join,hn=en(Be.keys,Be),bn=Le.max,yn=Le.min,vn=ie.now,wn=t.parseInt,En=Le.random,_n=xe.reverse,Ln=co(t,"DataView"),Bn=co(t,"Map"),Tn=co(t,"Promise"),Sn=co(t,"Set"),In=co(t,"WeakMap"),xn=co(Be,"create"),Pn=In&&new In,Cn={},kn=No(Ln),Mn=No(Bn),An=No(Tn),$n=No(Sn),On=No(In),Hn=je?je.prototype:i,Rn=Hn?Hn.valueOf:i,Fn=Hn?Hn.toString:i;function Nn(e){if(ns(e)&&!za(e)&&!(e instanceof Wn)){if(e instanceof Un)return e;if(Ae.call(e,"__wrapped__"))return Do(e)}return new Un(e)}var Dn=function(){function e(){}return function(t){if(!ts(t))return{};if(Ge)return Ge(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function jn(){}function Un(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Wn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Jn;++t<n;)this.add(e[t])}function Gn(e){var t=this.__data__=new zn(e);this.size=t.size}function Yn(e,t){var n=za(e),r=!n&&qa(e),i=!n&&!r&&Ya(e),o=!n&&!r&&!i&&us(e),a=n||r||i||o,s=a?jt(e.length,Se):[],l=s.length;for(var c in e)!t&&!Ae.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||bo(c,l))||s.push(c);return s}function Kn(e){var t=e.length;return t?e[Jr(0,t-1)]:i}function Zn(e,t){return $o(Ii(e),ar(t,0,e.length))}function Qn(e){return $o(Ii(e))}function Xn(e,t,n){(n!==i&&!ja(e[t],n)||n===i&&!(t in e))&&ir(e,t,n)}function er(e,t,n){var r=e[t];Ae.call(e,t)&&ja(r,n)&&(n!==i||t in e)||ir(e,t,n)}function tr(e,t){for(var n=e.length;n--;)if(ja(e[n][0],t))return n;return-1}function nr(e,t,n,r){return dr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function rr(e,t){return e&&xi(t,Ms(t),e)}function ir(e,t,n){"__proto__"==t&&ct?ct(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function or(e,t){for(var n=-1,o=t.length,a=r(o),s=null==e;++n<o;)a[n]=s?i:Is(e,t[n]);return a}function ar(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function sr(e,t,n,r,o,a){var s,l=1&t,c=2&t,u=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!ts(e))return e;var d=za(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Ae.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Ii(e,s)}else{var p=fo(e),f=p==w||p==E;if(Ya(e))return Ei(e,l);if(p==B||p==g||f&&!o){if(s=c||f?{}:go(e),!l)return c?function(e,t){return xi(e,po(e),t)}(e,function(e,t){return e&&xi(t,As(t),e)}(s,e)):function(e,t){return xi(e,uo(e),t)}(e,rr(s,e))}else{if(!Xe[p])return o?e:{};s=function(e,t,n){var r,i=e.constructor;switch(t){case k:return _i(e);case b:case y:return new i(+e);case M:return function(e,t){var n=t?_i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case A:case $:case O:case H:case R:case F:case N:case D:case j:return Li(e,n);case _:return new i;case L:case x:return new i(e);case S:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case I:return new i;case P:return r=e,Rn?Be(Rn.call(r)):{}}}(e,p,l)}}a||(a=new Gn);var m=a.get(e);if(m)return m;a.set(e,s),ss(e)?e.forEach((function(r){s.add(sr(r,t,n,r,e,a))})):rs(e)&&e.forEach((function(r,i){s.set(i,sr(r,t,n,i,e,a))}));var h=d?i:(u?c?no:to:c?As:Ms)(e);return vt(h||e,(function(r,i){h&&(r=e[i=r]),er(s,i,sr(r,t,n,i,e,a))})),s}function lr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Be(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new Ie(o);return Co((function(){e.apply(i,n)}),t)}function ur(e,t,n,r){var i=-1,o=Lt,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=Tt(t,Wt(n))),r?(o=Bt,a=!1):t.length>=200&&(o=zt,a=!1,t=new Vn(t));e:for(;++i<s;){var u=e[i],d=null==n?u:n(u);if(u=r||0!==u?u:0,a&&d==d){for(var p=c;p--;)if(t[p]===d)continue e;l.push(u)}else o(t,d,r)||l.push(u)}return l}Nn.templateSettings={escape:Y,evaluate:K,interpolate:Z,variable:"",imports:{_:Nn}},Nn.prototype=jn.prototype,Nn.prototype.constructor=Nn,Un.prototype=Dn(jn.prototype),Un.prototype.constructor=Un,Wn.prototype=Dn(jn.prototype),Wn.prototype.constructor=Wn,qn.prototype.clear=function(){this.__data__=xn?xn(null):{},this.size=0},qn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qn.prototype.get=function(e){var t=this.__data__;if(xn){var n=t[e];return n===a?i:n}return Ae.call(t,e)?t[e]:i},qn.prototype.has=function(e){var t=this.__data__;return xn?t[e]!==i:Ae.call(t,e)},qn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xn&&t===i?a:t,this},zn.prototype.clear=function(){this.__data__=[],this.size=0},zn.prototype.delete=function(e){var t=this.__data__,n=tr(t,e);return!(n<0||(n==t.length-1?t.pop():rt.call(t,n,1),--this.size,0))},zn.prototype.get=function(e){var t=this.__data__,n=tr(t,e);return n<0?i:t[n][1]},zn.prototype.has=function(e){return tr(this.__data__,e)>-1},zn.prototype.set=function(e,t){var n=this.__data__,r=tr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Jn.prototype.clear=function(){this.size=0,this.__data__={hash:new qn,map:new(Bn||zn),string:new qn}},Jn.prototype.delete=function(e){var t=so(this,e).delete(e);return this.size-=t?1:0,t},Jn.prototype.get=function(e){return so(this,e).get(e)},Jn.prototype.has=function(e){return so(this,e).has(e)},Jn.prototype.set=function(e,t){var n=so(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,a),this},Vn.prototype.has=function(e){return this.__data__.has(e)},Gn.prototype.clear=function(){this.__data__=new zn,this.size=0},Gn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Gn.prototype.get=function(e){return this.__data__.get(e)},Gn.prototype.has=function(e){return this.__data__.has(e)},Gn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof zn){var r=n.__data__;if(!Bn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Jn(r)}return n.set(e,t),this.size=n.size,this};var dr=ki(vr),pr=ki(wr,!0);function fr(e,t){var n=!0;return dr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function mr(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(l===i?s==s&&!cs(s):n(s,l)))var l=s,c=a}return c}function gr(e,t){var n=[];return dr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function hr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=ho),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?hr(s,t-1,n,r,i):St(i,s):r||(i[i.length]=s)}return i}var br=Mi(),yr=Mi(!0);function vr(e,t){return e&&br(e,t,Ms)}function wr(e,t){return e&&yr(e,t,Ms)}function Er(e,t){return _t(t,(function(t){return Qa(e[t])}))}function _r(e,t){for(var n=0,r=(t=bi(t,e)).length;null!=e&&n<r;)e=e[Fo(t[n++])];return n&&n==r?e:i}function Lr(e,t,n){var r=t(e);return za(e)?r:St(r,n(e))}function Br(e){return null==e?e===i?"[object Undefined]":"[object Null]":st&&st in Be(e)?function(e){var t=Ae.call(e,st),n=e[st];try{e[st]=i;var r=!0}catch(e){}var o=He.call(e);return r&&(t?e[st]=n:delete e[st]),o}(e):function(e){return He.call(e)}(e)}function Tr(e,t){return e>t}function Sr(e,t){return null!=e&&Ae.call(e,t)}function Ir(e,t){return null!=e&&t in Be(e)}function xr(e,t,n){for(var o=n?Bt:Lt,a=e[0].length,s=e.length,l=s,c=r(s),u=1/0,d=[];l--;){var p=e[l];l&&t&&(p=Tt(p,Wt(t))),u=yn(p.length,u),c[l]=!n&&(t||a>=120&&p.length>=120)?new Vn(l&&p):i}p=e[0];var f=-1,m=c[0];e:for(;++f<a&&d.length<u;){var g=p[f],h=t?t(g):g;if(g=n||0!==g?g:0,!(m?zt(m,h):o(d,h,n))){for(l=s;--l;){var b=c[l];if(!(b?zt(b,h):o(e[l],h,n)))continue e}m&&m.push(h),d.push(g)}}return d}function Pr(e,t,n){var r=null==(e=So(e,t=bi(t,e)))?e:e[Fo(Zo(t))];return null==r?i:bt(r,e,n)}function Cr(e){return ns(e)&&Br(e)==g}function kr(e,t,n,r,o){return e===t||(null==e||null==t||!ns(e)&&!ns(t)?e!=e&&t!=t:function(e,t,n,r,o,a){var s=za(e),l=za(t),c=s?h:fo(e),u=l?h:fo(t),d=(c=c==g?B:c)==B,p=(u=u==g?B:u)==B,f=c==u;if(f&&Ya(e)){if(!Ya(t))return!1;s=!0,d=!1}if(f&&!d)return a||(a=new Gn),s||us(e)?Xi(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case M:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case k:return!(e.byteLength!=t.byteLength||!o(new Ue(e),new Ue(t)));case b:case y:case L:return ja(+e,+t);case v:return e.name==t.name&&e.message==t.message;case S:case x:return e==t+"";case _:var s=Xt;case I:var l=1&r;if(s||(s=nn),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var u=Xi(s(e),s(t),r,i,o,a);return a.delete(e),u;case P:if(Rn)return Rn.call(e)==Rn.call(t)}return!1}(e,t,c,n,r,o,a);if(!(1&n)){var m=d&&Ae.call(e,"__wrapped__"),w=p&&Ae.call(t,"__wrapped__");if(m||w){var E=m?e.value():e,T=w?t.value():t;return a||(a=new Gn),o(E,T,n,r,a)}}return!!f&&(a||(a=new Gn),function(e,t,n,r,o,a){var s=1&n,l=to(e),c=l.length;if(c!=to(t).length&&!s)return!1;for(var u=c;u--;){var d=l[u];if(!(s?d in t:Ae.call(t,d)))return!1}var p=a.get(e),f=a.get(t);if(p&&f)return p==t&&f==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=s;++u<c;){var h=e[d=l[u]],b=t[d];if(r)var y=s?r(b,h,d,t,e,a):r(h,b,d,e,t,a);if(!(y===i?h===b||o(h,b,n,r,a):y)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var v=e.constructor,w=t.constructor;v==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof w&&w instanceof w||(m=!1)}return a.delete(e),a.delete(t),m}(e,t,n,r,o,a))}(e,t,n,r,kr,o))}function Mr(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Be(e);o--;){var l=n[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var c=(l=n[o])[0],u=e[c],d=l[1];if(s&&l[2]){if(u===i&&!(c in e))return!1}else{var p=new Gn;if(r)var f=r(u,d,c,e,t,p);if(!(f===i?kr(d,u,3,r,p):f))return!1}}return!0}function Ar(e){return!(!ts(e)||(t=e,Oe&&Oe in t))&&(Qa(e)?Ne:ge).test(No(e));var t}function $r(e){return"function"==typeof e?e:null==e?il:"object"==typeof e?za(e)?Nr(e[0],e[1]):Fr(e):fl(e)}function Or(e){if(!_o(e))return hn(e);var t=[];for(var n in Be(e))Ae.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Hr(e,t){return e<t}function Rr(e,t){var n=-1,i=Va(e)?r(e.length):[];return dr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Fr(e){var t=lo(e);return 1==t.length&&t[0][2]?Bo(t[0][0],t[0][1]):function(n){return n===e||Mr(n,e,t)}}function Nr(e,t){return vo(e)&&Lo(t)?Bo(Fo(e),t):function(n){var r=Is(n,e);return r===i&&r===t?xs(n,e):kr(t,r,3)}}function Dr(e,t,n,r,o){e!==t&&br(t,(function(a,s){if(o||(o=new Gn),ts(a))!function(e,t,n,r,o,a,s){var l=xo(e,n),c=xo(t,n),u=s.get(c);if(u)Xn(e,n,u);else{var d=a?a(l,c,n+"",e,t,s):i,p=d===i;if(p){var f=za(c),m=!f&&Ya(c),g=!f&&!m&&us(c);d=c,f||m||g?za(l)?d=l:Ga(l)?d=Ii(l):m?(p=!1,d=Ei(c,!0)):g?(p=!1,d=Li(c,!0)):d=[]:os(c)||qa(c)?(d=l,qa(l)?d=ys(l):ts(l)&&!Qa(l)||(d=go(c))):p=!1}p&&(s.set(c,d),o(d,c,r,a,s),s.delete(c)),Xn(e,n,d)}}(e,t,s,n,Dr,r,o);else{var l=r?r(xo(e,s),a,s+"",e,t,o):i;l===i&&(l=a),Xn(e,s,l)}}),As)}function jr(e,t){var n=e.length;if(n)return bo(t+=t<0?n:0,n)?e[t]:i}function Ur(e,t,n){t=t.length?Tt(t,(function(e){return za(e)?function(t){return _r(t,1===e.length?e[0]:e)}:e})):[il];var r=-1;t=Tt(t,Wt(ao()));var i=Rr(e,(function(e,n,i){var o=Tt(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=Bi(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(i)}function Wr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=_r(e,a);n(s,a)&&Zr(o,bi(a,e),s)}return o}function qr(e,t,n,r){var i=r?$t:At,o=-1,a=t.length,s=e;for(e===t&&(t=Ii(t)),n&&(s=Tt(e,Wt(n)));++o<a;)for(var l=0,c=t[o],u=n?n(c):c;(l=i(s,u,l,r))>-1;)s!==e&&rt.call(s,l,1),rt.call(e,l,1);return e}function zr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;bo(i)?rt.call(e,i,1):ci(e,i)}}return e}function Jr(e,t){return e+dn(En()*(t-e+1))}function Vr(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=dn(t/2))&&(e+=e)}while(t);return n}function Gr(e,t){return ko(To(e,t,il),e+"")}function Yr(e){return Kn(js(e))}function Kr(e,t){var n=js(e);return $o(n,ar(t,0,n.length))}function Zr(e,t,n,r){if(!ts(e))return e;for(var o=-1,a=(t=bi(t,e)).length,s=a-1,l=e;null!=l&&++o<a;){var c=Fo(t[o]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=s){var d=l[c];(u=r?r(d,c,l):i)===i&&(u=ts(d)?d:bo(t[o+1])?[]:{})}er(l,c,u),l=l[c]}return e}var Qr=Pn?function(e,t){return Pn.set(e,t),e}:il,Xr=ct?function(e,t){return ct(e,"toString",{configurable:!0,enumerable:!1,value:tl(t),writable:!0})}:il;function ei(e){return $o(js(e))}function ti(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function ni(e,t){var n;return dr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ri(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!cs(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ii(e,t,il,n)}function ii(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,l=null===t,c=cs(t),u=t===i;o<a;){var d=dn((o+a)/2),p=n(e[d]),f=p!==i,m=null===p,g=p==p,h=cs(p);if(s)var b=r||g;else b=u?g&&(r||f):l?g&&f&&(r||!m):c?g&&f&&!m&&(r||!h):!m&&!h&&(r?p<=t:p<t);b?o=d+1:a=d}return yn(a,4294967294)}function oi(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!ja(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function ai(e){return"number"==typeof e?e:cs(e)?p:+e}function si(e){if("string"==typeof e)return e;if(za(e))return Tt(e,si)+"";if(cs(e))return Fn?Fn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function li(e,t,n){var r=-1,i=Lt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=Bt;else if(o>=200){var c=t?null:Vi(e);if(c)return nn(c);a=!1,i=zt,l=new Vn}else l=t?[]:s;e:for(;++r<o;){var u=e[r],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else i(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function ci(e,t){return null==(e=So(e,t=bi(t,e)))||delete e[Fo(Zo(t))]}function ui(e,t,n,r){return Zr(e,t,n(_r(e,t)),r)}function di(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ti(e,r?0:o,r?o+1:i):ti(e,r?o+1:0,r?i:o)}function pi(e,t){var n=e;return n instanceof Wn&&(n=n.value()),It(t,(function(e,t){return t.func.apply(t.thisArg,St([e],t.args))}),n)}function fi(e,t,n){var i=e.length;if(i<2)return i?li(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],l=-1;++l<i;)l!=o&&(a[o]=ur(a[o]||s,e[l],t,n));return li(hr(a,1),t,n)}function mi(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var l=r<a?t[r]:i;n(s,e[r],l)}return s}function gi(e){return Ga(e)?e:[]}function hi(e){return"function"==typeof e?e:il}function bi(e,t){return za(e)?e:vo(e,t)?[e]:Ro(vs(e))}var yi=Gr;function vi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ti(e,t,n)}var wi=ut||function(e){return ot.clearTimeout(e)};function Ei(e,t){if(t)return e.slice();var n=e.length,r=We?We(n):new e.constructor(n);return e.copy(r),r}function _i(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function Li(e,t){var n=t?_i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Bi(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,a=cs(e),s=t!==i,l=null===t,c=t==t,u=cs(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||r&&s&&c||!n&&c||!o)return 1;if(!r&&!a&&!u&&e<t||u&&n&&o&&!r&&!a||l&&n&&o||!s&&o||!c)return-1}return 0}function Ti(e,t,n,i){for(var o=-1,a=e.length,s=n.length,l=-1,c=t.length,u=bn(a-s,0),d=r(c+u),p=!i;++l<c;)d[l]=t[l];for(;++o<s;)(p||o<a)&&(d[n[o]]=e[o]);for(;u--;)d[l++]=e[o++];return d}function Si(e,t,n,i){for(var o=-1,a=e.length,s=-1,l=n.length,c=-1,u=t.length,d=bn(a-l,0),p=r(d+u),f=!i;++o<d;)p[o]=e[o];for(var m=o;++c<u;)p[m+c]=t[c];for(;++s<l;)(f||o<a)&&(p[m+n[s]]=e[o++]);return p}function Ii(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function xi(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var l=t[a],c=r?r(n[l],e[l],l,n,e):i;c===i&&(c=e[l]),o?ir(n,l,c):er(n,l,c)}return n}function Pi(e,t){return function(n,r){var i=za(n)?yt:nr,o=t?t():{};return i(n,e,ao(r,2),o)}}function Ci(e){return Gr((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&"function"==typeof a?(o--,a):i,s&&yo(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=Be(t);++r<o;){var l=n[r];l&&e(t,l,r,a)}return t}))}function ki(e,t){return function(n,r){if(null==n)return n;if(!Va(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Be(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Mi(e){return function(t,n,r){for(var i=-1,o=Be(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function Ai(e){return function(t){var n=Qt(t=vs(t))?an(t):i,r=n?n[0]:t.charAt(0),o=n?vi(n,1).join(""):t.slice(1);return r[e]()+o}}function $i(e){return function(t){return It(Qs(qs(t).replace(qe,"")),e,"")}}function Oi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Dn(e.prototype),r=e.apply(n,t);return ts(r)?r:n}}function Hi(e){return function(t,n,r){var o=Be(t);if(!Va(t)){var a=ao(n,3);t=Ms(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function Ri(e){return eo((function(t){var n=t.length,r=n,a=Un.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new Ie(o);if(a&&!l&&"wrapper"==io(s))var l=new Un([],!0)}for(r=l?r:n;++r<n;){var c=io(s=t[r]),u="wrapper"==c?ro(s):i;l=u&&wo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[io(u[0])].apply(l,u[3]):1==s.length&&wo(s)?l[c]():l.thru(s)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&za(r))return l.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Fi(e,t,n,o,a,s,l,u,d,p){var f=t&c,m=1&t,g=2&t,h=24&t,b=512&t,y=g?i:Oi(e);return function i(){for(var c=arguments.length,v=r(c),w=c;w--;)v[w]=arguments[w];if(h)var E=oo(i),_=Gt(v,E);if(o&&(v=Ti(v,o,a,h)),s&&(v=Si(v,s,l,h)),c-=_,h&&c<p){var L=tn(v,E);return zi(e,t,Fi,i.placeholder,n,v,L,u,d,p-c)}var B=m?n:this,T=g?B[e]:e;return c=v.length,u?v=Io(v,u):b&&c>1&&v.reverse(),f&&d<c&&(v.length=d),this&&this!==ot&&this instanceof i&&(T=y||Oi(T)),T.apply(B,v)}}function Ni(e,t){return function(n,r){return function(e,t,n,r){return vr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Di(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=ai(n),r=ai(r)),o=e(n,r)}return o}}function ji(e){return eo((function(t){return t=Tt(t,Wt(ao())),Gr((function(n){var r=this;return e(t,(function(e){return bt(e,r,n)}))}))}))}function Ui(e,t){var n=(t=t===i?" ":si(t)).length;if(n<2)return n?Vr(t,e):t;var r=Vr(t,un(e/on(t)));return Qt(t)?vi(an(r),0,e).join(""):r.slice(0,e)}function Wi(e){return function(t,n,o){return o&&"number"!=typeof o&&yo(t,n,o)&&(n=o=i),t=ms(t),n===i?(n=t,t=0):n=ms(n),function(e,t,n,i){for(var o=-1,a=bn(un((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,o=o===i?t<n?1:-1:ms(o),e)}}function qi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=bs(t),n=bs(n)),e(t,n)}}function zi(e,t,n,r,o,a,s,c,u,d){var p=8&t;t|=p?l:64,4&(t&=~(p?64:l))||(t&=-4);var f=[e,t,o,p?a:i,p?s:i,p?i:a,p?i:s,c,u,d],m=n.apply(i,f);return wo(e)&&Po(m,f),m.placeholder=r,Mo(m,e,t)}function Ji(e){var t=Le[e];return function(e,n){if(e=bs(e),(n=null==n?0:yn(gs(n),292))&&mn(e)){var r=(vs(e)+"e").split("e");return+((r=(vs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Vi=Sn&&1/nn(new Sn([,-0]))[1]==u?function(e){return new Sn(e)}:cl;function Gi(e){return function(t){var n=fo(t);return n==_?Xt(t):n==I?rn(t):function(e,t){return Tt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Yi(e,t,n,a,u,d,p,f){var m=2&t;if(!m&&"function"!=typeof e)throw new Ie(o);var g=a?a.length:0;if(g||(t&=-97,a=u=i),p=p===i?p:bn(gs(p),0),f=f===i?f:gs(f),g-=u?u.length:0,64&t){var h=a,b=u;a=u=i}var y=m?i:ro(e),v=[e,t,n,a,u,h,b,d,p,f];if(y&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==c&&8==n||r==c&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?Ti(u,l,t[4]):l,e[4]=u?tn(e[3],s):t[4]}(l=t[5])&&(u=e[5],e[5]=u?Si(u,l,t[6]):l,e[6]=u?tn(e[5],s):t[6]),(l=t[7])&&(e[7]=l),r&c&&(e[8]=null==e[8]?t[8]:yn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(v,y),e=v[0],t=v[1],n=v[2],a=v[3],u=v[4],!(f=v[9]=v[9]===i?m?0:e.length:bn(v[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)w=8==t||16==t?function(e,t,n){var o=Oi(e);return function a(){for(var s=arguments.length,l=r(s),c=s,u=oo(a);c--;)l[c]=arguments[c];var d=s<3&&l[0]!==u&&l[s-1]!==u?[]:tn(l,u);return(s-=d.length)<n?zi(e,t,Fi,a.placeholder,i,l,d,i,i,n-s):bt(this&&this!==ot&&this instanceof a?o:e,this,l)}}(e,t,f):t!=l&&33!=t||u.length?Fi.apply(i,v):function(e,t,n,i){var o=1&t,a=Oi(e);return function t(){for(var s=-1,l=arguments.length,c=-1,u=i.length,d=r(u+l),p=this&&this!==ot&&this instanceof t?a:e;++c<u;)d[c]=i[c];for(;l--;)d[c++]=arguments[++s];return bt(p,o?n:this,d)}}(e,t,n,a);else var w=function(e,t,n){var r=1&t,i=Oi(e);return function t(){return(this&&this!==ot&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Mo((y?Qr:Po)(w,v),e,t)}function Ki(e,t,n,r){return e===i||ja(e,Ce[n])&&!Ae.call(r,n)?t:e}function Zi(e,t,n,r,o,a){return ts(e)&&ts(t)&&(a.set(t,e),Dr(e,t,i,Zi,a),a.delete(t)),e}function Qi(e){return os(e)?i:e}function Xi(e,t,n,r,o,a){var s=1&n,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var u=a.get(e),d=a.get(t);if(u&&d)return u==t&&d==e;var p=-1,f=!0,m=2&n?new Vn:i;for(a.set(e,t),a.set(t,e);++p<l;){var g=e[p],h=t[p];if(r)var b=s?r(h,g,p,t,e,a):r(g,h,p,e,t,a);if(b!==i){if(b)continue;f=!1;break}if(m){if(!Pt(t,(function(e,t){if(!zt(m,t)&&(g===e||o(g,e,n,r,a)))return m.push(t)}))){f=!1;break}}else if(g!==h&&!o(g,h,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function eo(e){return ko(To(e,i,Jo),e+"")}function to(e){return Lr(e,Ms,uo)}function no(e){return Lr(e,As,po)}var ro=Pn?function(e){return Pn.get(e)}:cl;function io(e){for(var t=e.name+"",n=Cn[t],r=Ae.call(Cn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function oo(e){return(Ae.call(Nn,"placeholder")?Nn:e).placeholder}function ao(){var e=Nn.iteratee||ol;return e=e===ol?$r:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function lo(e){for(var t=Ms(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Lo(i)]}return t}function co(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Ar(n)?n:i}var uo=pn?function(e){return null==e?[]:(e=Be(e),_t(pn(e),(function(t){return et.call(e,t)})))}:hl,po=pn?function(e){for(var t=[];e;)St(t,uo(e)),e=Je(e);return t}:hl,fo=Br;function mo(e,t,n){for(var r=-1,i=(t=bi(t,e)).length,o=!1;++r<i;){var a=Fo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&es(i)&&bo(a,i)&&(za(e)||qa(e))}function go(e){return"function"!=typeof e.constructor||_o(e)?{}:Dn(Je(e))}function ho(e){return za(e)||qa(e)||!!(it&&e&&e[it])}function bo(e,t){var n=typeof e;return!!(t=null==t?d:t)&&("number"==n||"symbol"!=n&&be.test(e))&&e>-1&&e%1==0&&e<t}function yo(e,t,n){if(!ts(n))return!1;var r=typeof t;return!!("number"==r?Va(n)&&bo(t,n.length):"string"==r&&t in n)&&ja(n[t],e)}function vo(e,t){if(za(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!cs(e))||X.test(e)||!Q.test(e)||null!=t&&e in Be(t)}function wo(e){var t=io(e),n=Nn[t];if("function"!=typeof n||!(t in Wn.prototype))return!1;if(e===n)return!0;var r=ro(n);return!!r&&e===r[0]}(Ln&&fo(new Ln(new ArrayBuffer(1)))!=M||Bn&&fo(new Bn)!=_||Tn&&fo(Tn.resolve())!=T||Sn&&fo(new Sn)!=I||In&&fo(new In)!=C)&&(fo=function(e){var t=Br(e),n=t==B?e.constructor:i,r=n?No(n):"";if(r)switch(r){case kn:return M;case Mn:return _;case An:return T;case $n:return I;case On:return C}return t});var Eo=ke?Qa:bl;function _o(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ce)}function Lo(e){return e==e&&!ts(e)}function Bo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Be(n))}}function To(e,t,n){return t=bn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=bn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var l=r(t+1);++o<t;)l[o]=i[o];return l[t]=n(s),bt(e,this,l)}}function So(e,t){return t.length<2?e:_r(e,ti(t,0,-1))}function Io(e,t){for(var n=e.length,r=yn(t.length,n),o=Ii(e);r--;){var a=t[r];e[r]=bo(a,n)?o[a]:i}return e}function xo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Po=Ao(Qr),Co=Ft||function(e,t){return ot.setTimeout(e,t)},ko=Ao(Xr);function Mo(e,t,n){var r=t+"";return ko(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return vt(m,(function(n){var r="_."+n[0];t&n[1]&&!Lt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(se):[]}(r),n)))}function Ao(e){var t=0,n=0;return function(){var r=vn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function $o(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=Jr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var Oo,Ho,Ro=(Oo=Oa((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(ue,"$1"):n||e)})),t}),(function(e){return 500===Ho.size&&Ho.clear(),e})),Ho=Oo.cache,Oo);function Fo(e){if("string"==typeof e||cs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function No(e){if(null!=e){try{return Me.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Do(e){if(e instanceof Wn)return e.clone();var t=new Un(e.__wrapped__,e.__chain__);return t.__actions__=Ii(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var jo=Gr((function(e,t){return Ga(e)?ur(e,hr(t,1,Ga,!0)):[]})),Uo=Gr((function(e,t){var n=Zo(t);return Ga(n)&&(n=i),Ga(e)?ur(e,hr(t,1,Ga,!0),ao(n,2)):[]})),Wo=Gr((function(e,t){var n=Zo(t);return Ga(n)&&(n=i),Ga(e)?ur(e,hr(t,1,Ga,!0),i,n):[]}));function qo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gs(n);return i<0&&(i=bn(r+i,0)),Mt(e,ao(t,3),i)}function zo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=gs(n),o=n<0?bn(r+o,0):yn(o,r-1)),Mt(e,ao(t,3),o,!0)}function Jo(e){return null!=e&&e.length?hr(e,1):[]}function Vo(e){return e&&e.length?e[0]:i}var Go=Gr((function(e){var t=Tt(e,gi);return t.length&&t[0]===e[0]?xr(t):[]})),Yo=Gr((function(e){var t=Zo(e),n=Tt(e,gi);return t===Zo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?xr(n,ao(t,2)):[]})),Ko=Gr((function(e){var t=Zo(e),n=Tt(e,gi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?xr(n,i,t):[]}));function Zo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Qo=Gr(Xo);function Xo(e,t){return e&&e.length&&t&&t.length?qr(e,t):e}var ea=eo((function(e,t){var n=null==e?0:e.length,r=or(e,t);return zr(e,Tt(t,(function(e){return bo(e,n)?+e:e})).sort(Bi)),r}));function ta(e){return null==e?e:_n.call(e)}var na=Gr((function(e){return li(hr(e,1,Ga,!0))})),ra=Gr((function(e){var t=Zo(e);return Ga(t)&&(t=i),li(hr(e,1,Ga,!0),ao(t,2))})),ia=Gr((function(e){var t=Zo(e);return t="function"==typeof t?t:i,li(hr(e,1,Ga,!0),i,t)}));function oa(e){if(!e||!e.length)return[];var t=0;return e=_t(e,(function(e){if(Ga(e))return t=bn(e.length,t),!0})),jt(t,(function(t){return Tt(e,Rt(t))}))}function aa(e,t){if(!e||!e.length)return[];var n=oa(e);return null==t?n:Tt(n,(function(e){return bt(t,i,e)}))}var sa=Gr((function(e,t){return Ga(e)?ur(e,t):[]})),la=Gr((function(e){return fi(_t(e,Ga))})),ca=Gr((function(e){var t=Zo(e);return Ga(t)&&(t=i),fi(_t(e,Ga),ao(t,2))})),ua=Gr((function(e){var t=Zo(e);return t="function"==typeof t?t:i,fi(_t(e,Ga),i,t)})),da=Gr(oa),pa=Gr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,aa(e,n)}));function fa(e){var t=Nn(e);return t.__chain__=!0,t}function ma(e,t){return t(e)}var ga=eo((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return or(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Wn&&bo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ma,args:[o],thisArg:i}),new Un(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),ha=Pi((function(e,t,n){Ae.call(e,n)?++e[n]:ir(e,n,1)})),ba=Hi(qo),ya=Hi(zo);function va(e,t){return(za(e)?vt:dr)(e,ao(t,3))}function wa(e,t){return(za(e)?wt:pr)(e,ao(t,3))}var Ea=Pi((function(e,t,n){Ae.call(e,n)?e[n].push(t):ir(e,n,[t])})),_a=Gr((function(e,t,n){var i=-1,o="function"==typeof t,a=Va(e)?r(e.length):[];return dr(e,(function(e){a[++i]=o?bt(t,e,n):Pr(e,t,n)})),a})),La=Pi((function(e,t,n){ir(e,n,t)}));function Ba(e,t){return(za(e)?Tt:Rr)(e,ao(t,3))}var Ta=Pi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Sa=Gr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&yo(e,t[0],t[1])?t=[]:n>2&&yo(t[0],t[1],t[2])&&(t=[t[0]]),Ur(e,hr(t,1),[])})),Ia=Ct||function(){return ot.Date.now()};function xa(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Yi(e,c,i,i,i,i,t)}function Pa(e,t){var n;if("function"!=typeof t)throw new Ie(o);return e=gs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Ca=Gr((function(e,t,n){var r=1;if(n.length){var i=tn(n,oo(Ca));r|=l}return Yi(e,r,t,n,i)})),ka=Gr((function(e,t,n){var r=3;if(n.length){var i=tn(n,oo(ka));r|=l}return Yi(t,r,e,n,i)}));function Ma(e,t,n){var r,a,s,l,c,u,d=0,p=!1,f=!1,m=!0;if("function"!=typeof e)throw new Ie(o);function g(t){var n=r,o=a;return r=a=i,d=t,l=e.apply(o,n)}function h(e){return d=e,c=Co(y,t),p?g(e):l}function b(e){var n=e-u;return u===i||n>=t||n<0||f&&e-d>=s}function y(){var e=Ia();if(b(e))return v(e);c=Co(y,function(e){var n=t-(e-u);return f?yn(n,s-(e-d)):n}(e))}function v(e){return c=i,m&&r?g(e):(r=a=i,l)}function w(){var e=Ia(),n=b(e);if(r=arguments,a=this,u=e,n){if(c===i)return h(u);if(f)return wi(c),c=Co(y,t),g(u)}return c===i&&(c=Co(y,t)),l}return t=bs(t)||0,ts(n)&&(p=!!n.leading,s=(f="maxWait"in n)?bn(bs(n.maxWait)||0,t):s,m="trailing"in n?!!n.trailing:m),w.cancel=function(){c!==i&&wi(c),d=0,r=u=a=c=i},w.flush=function(){return c===i?l:v(Ia())},w}var Aa=Gr((function(e,t){return cr(e,1,t)})),$a=Gr((function(e,t,n){return cr(e,bs(t)||0,n)}));function Oa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ie(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Oa.Cache||Jn),n}function Ha(e){if("function"!=typeof e)throw new Ie(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Oa.Cache=Jn;var Ra=yi((function(e,t){var n=(t=1==t.length&&za(t[0])?Tt(t[0],Wt(ao())):Tt(hr(t,1),Wt(ao()))).length;return Gr((function(r){for(var i=-1,o=yn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return bt(e,this,r)}))})),Fa=Gr((function(e,t){var n=tn(t,oo(Fa));return Yi(e,l,i,t,n)})),Na=Gr((function(e,t){var n=tn(t,oo(Na));return Yi(e,64,i,t,n)})),Da=eo((function(e,t){return Yi(e,256,i,i,i,t)}));function ja(e,t){return e===t||e!=e&&t!=t}var Ua=qi(Tr),Wa=qi((function(e,t){return e>=t})),qa=Cr(function(){return arguments}())?Cr:function(e){return ns(e)&&Ae.call(e,"callee")&&!et.call(e,"callee")},za=r.isArray,Ja=dt?Wt(dt):function(e){return ns(e)&&Br(e)==k};function Va(e){return null!=e&&es(e.length)&&!Qa(e)}function Ga(e){return ns(e)&&Va(e)}var Ya=fn||bl,Ka=pt?Wt(pt):function(e){return ns(e)&&Br(e)==y};function Za(e){if(!ns(e))return!1;var t=Br(e);return t==v||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!os(e)}function Qa(e){if(!ts(e))return!1;var t=Br(e);return t==w||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Xa(e){return"number"==typeof e&&e==gs(e)}function es(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function ts(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ns(e){return null!=e&&"object"==typeof e}var rs=ft?Wt(ft):function(e){return ns(e)&&fo(e)==_};function is(e){return"number"==typeof e||ns(e)&&Br(e)==L}function os(e){if(!ns(e)||Br(e)!=B)return!1;var t=Je(e);if(null===t)return!0;var n=Ae.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Me.call(n)==Re}var as=mt?Wt(mt):function(e){return ns(e)&&Br(e)==S},ss=gt?Wt(gt):function(e){return ns(e)&&fo(e)==I};function ls(e){return"string"==typeof e||!za(e)&&ns(e)&&Br(e)==x}function cs(e){return"symbol"==typeof e||ns(e)&&Br(e)==P}var us=ht?Wt(ht):function(e){return ns(e)&&es(e.length)&&!!Qe[Br(e)]},ds=qi(Hr),ps=qi((function(e,t){return e<=t}));function fs(e){if(!e)return[];if(Va(e))return ls(e)?an(e):Ii(e);if(at&&e[at])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[at]());var t=fo(e);return(t==_?Xt:t==I?nn:js)(e)}function ms(e){return e?(e=bs(e))===u||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function gs(e){var t=ms(e),n=t%1;return t==t?n?t-n:t:0}function hs(e){return e?ar(gs(e),0,f):0}function bs(e){if("number"==typeof e)return e;if(cs(e))return p;if(ts(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ts(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ut(e);var n=me.test(e);return n||he.test(e)?nt(e.slice(2),n?2:8):fe.test(e)?p:+e}function ys(e){return xi(e,As(e))}function vs(e){return null==e?"":si(e)}var ws=Ci((function(e,t){if(_o(t)||Va(t))xi(t,Ms(t),e);else for(var n in t)Ae.call(t,n)&&er(e,n,t[n])})),Es=Ci((function(e,t){xi(t,As(t),e)})),_s=Ci((function(e,t,n,r){xi(t,As(t),e,r)})),Ls=Ci((function(e,t,n,r){xi(t,Ms(t),e,r)})),Bs=eo(or),Ts=Gr((function(e,t){e=Be(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&yo(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=As(a),l=-1,c=s.length;++l<c;){var u=s[l],d=e[u];(d===i||ja(d,Ce[u])&&!Ae.call(e,u))&&(e[u]=a[u])}return e})),Ss=Gr((function(e){return e.push(i,Zi),bt(Os,i,e)}));function Is(e,t,n){var r=null==e?i:_r(e,t);return r===i?n:r}function xs(e,t){return null!=e&&mo(e,t,Ir)}var Ps=Ni((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=He.call(t)),e[t]=n}),tl(il)),Cs=Ni((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=He.call(t)),Ae.call(e,t)?e[t].push(n):e[t]=[n]}),ao),ks=Gr(Pr);function Ms(e){return Va(e)?Yn(e):Or(e)}function As(e){return Va(e)?Yn(e,!0):function(e){if(!ts(e))return function(e){var t=[];if(null!=e)for(var n in Be(e))t.push(n);return t}(e);var t=_o(e),n=[];for(var r in e)("constructor"!=r||!t&&Ae.call(e,r))&&n.push(r);return n}(e)}var $s=Ci((function(e,t,n){Dr(e,t,n)})),Os=Ci((function(e,t,n,r){Dr(e,t,n,r)})),Hs=eo((function(e,t){var n={};if(null==e)return n;var r=!1;t=Tt(t,(function(t){return t=bi(t,e),r||(r=t.length>1),t})),xi(e,no(e),n),r&&(n=sr(n,7,Qi));for(var i=t.length;i--;)ci(n,t[i]);return n})),Rs=eo((function(e,t){return null==e?{}:function(e,t){return Wr(e,t,(function(t,n){return xs(e,n)}))}(e,t)}));function Fs(e,t){if(null==e)return{};var n=Tt(no(e),(function(e){return[e]}));return t=ao(t),Wr(e,n,(function(e,n){return t(e,n[0])}))}var Ns=Gi(Ms),Ds=Gi(As);function js(e){return null==e?[]:qt(e,Ms(e))}var Us=$i((function(e,t,n){return t=t.toLowerCase(),e+(n?Ws(t):t)}));function Ws(e){return Zs(vs(e).toLowerCase())}function qs(e){return(e=vs(e))&&e.replace(ye,Yt).replace(ze,"")}var zs=$i((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Js=$i((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Vs=Ai("toLowerCase"),Gs=$i((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Ys=$i((function(e,t,n){return e+(n?" ":"")+Zs(t)})),Ks=$i((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Zs=Ai("toUpperCase");function Qs(e,t,n){return e=vs(e),(t=n?i:t)===i?function(e){return Ye.test(e)}(e)?function(e){return e.match(Ve)||[]}(e):function(e){return e.match(le)||[]}(e):e.match(t)||[]}var Xs=Gr((function(e,t){try{return bt(e,i,t)}catch(e){return Za(e)?e:new Ee(e)}})),el=eo((function(e,t){return vt(t,(function(t){t=Fo(t),ir(e,t,Ca(e[t],e))})),e}));function tl(e){return function(){return e}}var nl=Ri(),rl=Ri(!0);function il(e){return e}function ol(e){return $r("function"==typeof e?e:sr(e,1))}var al=Gr((function(e,t){return function(n){return Pr(n,e,t)}})),sl=Gr((function(e,t){return function(n){return Pr(e,n,t)}}));function ll(e,t,n){var r=Ms(t),i=Er(t,r);null!=n||ts(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Er(t,Ms(t)));var o=!(ts(n)&&"chain"in n&&!n.chain),a=Qa(e);return vt(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=Ii(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,St([this.value()],arguments))})})),e}function cl(){}var ul=ji(Tt),dl=ji(Et),pl=ji(Pt);function fl(e){return vo(e)?Rt(Fo(e)):function(e){return function(t){return _r(t,e)}}(e)}var ml=Wi(),gl=Wi(!0);function hl(){return[]}function bl(){return!1}var yl,vl=Di((function(e,t){return e+t}),0),wl=Ji("ceil"),El=Di((function(e,t){return e/t}),1),_l=Ji("floor"),Ll=Di((function(e,t){return e*t}),1),Bl=Ji("round"),Tl=Di((function(e,t){return e-t}),0);return Nn.after=function(e,t){if("function"!=typeof t)throw new Ie(o);return e=gs(e),function(){if(--e<1)return t.apply(this,arguments)}},Nn.ary=xa,Nn.assign=ws,Nn.assignIn=Es,Nn.assignInWith=_s,Nn.assignWith=Ls,Nn.at=Bs,Nn.before=Pa,Nn.bind=Ca,Nn.bindAll=el,Nn.bindKey=ka,Nn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return za(e)?e:[e]},Nn.chain=fa,Nn.chunk=function(e,t,n){t=(n?yo(e,t,n):t===i)?1:bn(gs(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,l=r(un(o/t));a<o;)l[s++]=ti(e,a,a+=t);return l},Nn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Nn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return St(za(n)?Ii(n):[n],hr(t,1))},Nn.cond=function(e){var t=null==e?0:e.length,n=ao();return e=t?Tt(e,(function(e){if("function"!=typeof e[1])throw new Ie(o);return[n(e[0]),e[1]]})):[],Gr((function(n){for(var r=-1;++r<t;){var i=e[r];if(bt(i[0],this,n))return bt(i[1],this,n)}}))},Nn.conforms=function(e){return function(e){var t=Ms(e);return function(n){return lr(n,e,t)}}(sr(e,1))},Nn.constant=tl,Nn.countBy=ha,Nn.create=function(e,t){var n=Dn(e);return null==t?n:rr(n,t)},Nn.curry=function e(t,n,r){var o=Yi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Nn.curryRight=function e(t,n,r){var o=Yi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Nn.debounce=Ma,Nn.defaults=Ts,Nn.defaultsDeep=Ss,Nn.defer=Aa,Nn.delay=$a,Nn.difference=jo,Nn.differenceBy=Uo,Nn.differenceWith=Wo,Nn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ti(e,(t=n||t===i?1:gs(t))<0?0:t,r):[]},Nn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ti(e,0,(t=r-(t=n||t===i?1:gs(t)))<0?0:t):[]},Nn.dropRightWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!0,!0):[]},Nn.dropWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!0):[]},Nn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&yo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=gs(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:gs(r))<0&&(r+=o),r=n>r?0:hs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Nn.filter=function(e,t){return(za(e)?_t:gr)(e,ao(t,3))},Nn.flatMap=function(e,t){return hr(Ba(e,t),1)},Nn.flatMapDeep=function(e,t){return hr(Ba(e,t),u)},Nn.flatMapDepth=function(e,t,n){return n=n===i?1:gs(n),hr(Ba(e,t),n)},Nn.flatten=Jo,Nn.flattenDeep=function(e){return null!=e&&e.length?hr(e,u):[]},Nn.flattenDepth=function(e,t){return null!=e&&e.length?hr(e,t=t===i?1:gs(t)):[]},Nn.flip=function(e){return Yi(e,512)},Nn.flow=nl,Nn.flowRight=rl,Nn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Nn.functions=function(e){return null==e?[]:Er(e,Ms(e))},Nn.functionsIn=function(e){return null==e?[]:Er(e,As(e))},Nn.groupBy=Ea,Nn.initial=function(e){return null!=e&&e.length?ti(e,0,-1):[]},Nn.intersection=Go,Nn.intersectionBy=Yo,Nn.intersectionWith=Ko,Nn.invert=Ps,Nn.invertBy=Cs,Nn.invokeMap=_a,Nn.iteratee=ol,Nn.keyBy=La,Nn.keys=Ms,Nn.keysIn=As,Nn.map=Ba,Nn.mapKeys=function(e,t){var n={};return t=ao(t,3),vr(e,(function(e,r,i){ir(n,t(e,r,i),e)})),n},Nn.mapValues=function(e,t){var n={};return t=ao(t,3),vr(e,(function(e,r,i){ir(n,r,t(e,r,i))})),n},Nn.matches=function(e){return Fr(sr(e,1))},Nn.matchesProperty=function(e,t){return Nr(e,sr(t,1))},Nn.memoize=Oa,Nn.merge=$s,Nn.mergeWith=Os,Nn.method=al,Nn.methodOf=sl,Nn.mixin=ll,Nn.negate=Ha,Nn.nthArg=function(e){return e=gs(e),Gr((function(t){return jr(t,e)}))},Nn.omit=Hs,Nn.omitBy=function(e,t){return Fs(e,Ha(ao(t)))},Nn.once=function(e){return Pa(2,e)},Nn.orderBy=function(e,t,n,r){return null==e?[]:(za(t)||(t=null==t?[]:[t]),za(n=r?i:n)||(n=null==n?[]:[n]),Ur(e,t,n))},Nn.over=ul,Nn.overArgs=Ra,Nn.overEvery=dl,Nn.overSome=pl,Nn.partial=Fa,Nn.partialRight=Na,Nn.partition=Ta,Nn.pick=Rs,Nn.pickBy=Fs,Nn.property=fl,Nn.propertyOf=function(e){return function(t){return null==e?i:_r(e,t)}},Nn.pull=Qo,Nn.pullAll=Xo,Nn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?qr(e,t,ao(n,2)):e},Nn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?qr(e,t,i,n):e},Nn.pullAt=ea,Nn.range=ml,Nn.rangeRight=gl,Nn.rearg=Da,Nn.reject=function(e,t){return(za(e)?_t:gr)(e,Ha(ao(t,3)))},Nn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=ao(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return zr(e,i),n},Nn.rest=function(e,t){if("function"!=typeof e)throw new Ie(o);return Gr(e,t=t===i?t:gs(t))},Nn.reverse=ta,Nn.sampleSize=function(e,t,n){return t=(n?yo(e,t,n):t===i)?1:gs(t),(za(e)?Zn:Kr)(e,t)},Nn.set=function(e,t,n){return null==e?e:Zr(e,t,n)},Nn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Zr(e,t,n,r)},Nn.shuffle=function(e){return(za(e)?Qn:ei)(e)},Nn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&yo(e,t,n)?(t=0,n=r):(t=null==t?0:gs(t),n=n===i?r:gs(n)),ti(e,t,n)):[]},Nn.sortBy=Sa,Nn.sortedUniq=function(e){return e&&e.length?oi(e):[]},Nn.sortedUniqBy=function(e,t){return e&&e.length?oi(e,ao(t,2)):[]},Nn.split=function(e,t,n){return n&&"number"!=typeof n&&yo(e,t,n)&&(t=n=i),(n=n===i?f:n>>>0)?(e=vs(e))&&("string"==typeof t||null!=t&&!as(t))&&!(t=si(t))&&Qt(e)?vi(an(e),0,n):e.split(t,n):[]},Nn.spread=function(e,t){if("function"!=typeof e)throw new Ie(o);return t=null==t?0:bn(gs(t),0),Gr((function(n){var r=n[t],i=vi(n,0,t);return r&&St(i,r),bt(e,this,i)}))},Nn.tail=function(e){var t=null==e?0:e.length;return t?ti(e,1,t):[]},Nn.take=function(e,t,n){return e&&e.length?ti(e,0,(t=n||t===i?1:gs(t))<0?0:t):[]},Nn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ti(e,(t=r-(t=n||t===i?1:gs(t)))<0?0:t,r):[]},Nn.takeRightWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!1,!0):[]},Nn.takeWhile=function(e,t){return e&&e.length?di(e,ao(t,3)):[]},Nn.tap=function(e,t){return t(e),e},Nn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Ie(o);return ts(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ma(e,t,{leading:r,maxWait:t,trailing:i})},Nn.thru=ma,Nn.toArray=fs,Nn.toPairs=Ns,Nn.toPairsIn=Ds,Nn.toPath=function(e){return za(e)?Tt(e,Fo):cs(e)?[e]:Ii(Ro(vs(e)))},Nn.toPlainObject=ys,Nn.transform=function(e,t,n){var r=za(e),i=r||Ya(e)||us(e);if(t=ao(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:ts(e)&&Qa(o)?Dn(Je(e)):{}}return(i?vt:vr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Nn.unary=function(e){return xa(e,1)},Nn.union=na,Nn.unionBy=ra,Nn.unionWith=ia,Nn.uniq=function(e){return e&&e.length?li(e):[]},Nn.uniqBy=function(e,t){return e&&e.length?li(e,ao(t,2)):[]},Nn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?li(e,i,t):[]},Nn.unset=function(e,t){return null==e||ci(e,t)},Nn.unzip=oa,Nn.unzipWith=aa,Nn.update=function(e,t,n){return null==e?e:ui(e,t,hi(n))},Nn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ui(e,t,hi(n),r)},Nn.values=js,Nn.valuesIn=function(e){return null==e?[]:qt(e,As(e))},Nn.without=sa,Nn.words=Qs,Nn.wrap=function(e,t){return Fa(hi(t),e)},Nn.xor=la,Nn.xorBy=ca,Nn.xorWith=ua,Nn.zip=da,Nn.zipObject=function(e,t){return mi(e||[],t||[],er)},Nn.zipObjectDeep=function(e,t){return mi(e||[],t||[],Zr)},Nn.zipWith=pa,Nn.entries=Ns,Nn.entriesIn=Ds,Nn.extend=Es,Nn.extendWith=_s,ll(Nn,Nn),Nn.add=vl,Nn.attempt=Xs,Nn.camelCase=Us,Nn.capitalize=Ws,Nn.ceil=wl,Nn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=bs(n))==n?n:0),t!==i&&(t=(t=bs(t))==t?t:0),ar(bs(e),t,n)},Nn.clone=function(e){return sr(e,4)},Nn.cloneDeep=function(e){return sr(e,5)},Nn.cloneDeepWith=function(e,t){return sr(e,5,t="function"==typeof t?t:i)},Nn.cloneWith=function(e,t){return sr(e,4,t="function"==typeof t?t:i)},Nn.conformsTo=function(e,t){return null==t||lr(e,t,Ms(t))},Nn.deburr=qs,Nn.defaultTo=function(e,t){return null==e||e!=e?t:e},Nn.divide=El,Nn.endsWith=function(e,t,n){e=vs(e),t=si(t);var r=e.length,o=n=n===i?r:ar(gs(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Nn.eq=ja,Nn.escape=function(e){return(e=vs(e))&&G.test(e)?e.replace(J,Kt):e},Nn.escapeRegExp=function(e){return(e=vs(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Nn.every=function(e,t,n){var r=za(e)?Et:fr;return n&&yo(e,t,n)&&(t=i),r(e,ao(t,3))},Nn.find=ba,Nn.findIndex=qo,Nn.findKey=function(e,t){return kt(e,ao(t,3),vr)},Nn.findLast=ya,Nn.findLastIndex=zo,Nn.findLastKey=function(e,t){return kt(e,ao(t,3),wr)},Nn.floor=_l,Nn.forEach=va,Nn.forEachRight=wa,Nn.forIn=function(e,t){return null==e?e:br(e,ao(t,3),As)},Nn.forInRight=function(e,t){return null==e?e:yr(e,ao(t,3),As)},Nn.forOwn=function(e,t){return e&&vr(e,ao(t,3))},Nn.forOwnRight=function(e,t){return e&&wr(e,ao(t,3))},Nn.get=Is,Nn.gt=Ua,Nn.gte=Wa,Nn.has=function(e,t){return null!=e&&mo(e,t,Sr)},Nn.hasIn=xs,Nn.head=Vo,Nn.identity=il,Nn.includes=function(e,t,n,r){e=Va(e)?e:js(e),n=n&&!r?gs(n):0;var i=e.length;return n<0&&(n=bn(i+n,0)),ls(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&At(e,t,n)>-1},Nn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gs(n);return i<0&&(i=bn(r+i,0)),At(e,t,i)},Nn.inRange=function(e,t,n){return t=ms(t),n===i?(n=t,t=0):n=ms(n),function(e,t,n){return e>=yn(t,n)&&e<bn(t,n)}(e=bs(e),t,n)},Nn.invoke=ks,Nn.isArguments=qa,Nn.isArray=za,Nn.isArrayBuffer=Ja,Nn.isArrayLike=Va,Nn.isArrayLikeObject=Ga,Nn.isBoolean=function(e){return!0===e||!1===e||ns(e)&&Br(e)==b},Nn.isBuffer=Ya,Nn.isDate=Ka,Nn.isElement=function(e){return ns(e)&&1===e.nodeType&&!os(e)},Nn.isEmpty=function(e){if(null==e)return!0;if(Va(e)&&(za(e)||"string"==typeof e||"function"==typeof e.splice||Ya(e)||us(e)||qa(e)))return!e.length;var t=fo(e);if(t==_||t==I)return!e.size;if(_o(e))return!Or(e).length;for(var n in e)if(Ae.call(e,n))return!1;return!0},Nn.isEqual=function(e,t){return kr(e,t)},Nn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?kr(e,t,i,n):!!r},Nn.isError=Za,Nn.isFinite=function(e){return"number"==typeof e&&mn(e)},Nn.isFunction=Qa,Nn.isInteger=Xa,Nn.isLength=es,Nn.isMap=rs,Nn.isMatch=function(e,t){return e===t||Mr(e,t,lo(t))},Nn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Mr(e,t,lo(t),n)},Nn.isNaN=function(e){return is(e)&&e!=+e},Nn.isNative=function(e){if(Eo(e))throw new Ee("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ar(e)},Nn.isNil=function(e){return null==e},Nn.isNull=function(e){return null===e},Nn.isNumber=is,Nn.isObject=ts,Nn.isObjectLike=ns,Nn.isPlainObject=os,Nn.isRegExp=as,Nn.isSafeInteger=function(e){return Xa(e)&&e>=-9007199254740991&&e<=d},Nn.isSet=ss,Nn.isString=ls,Nn.isSymbol=cs,Nn.isTypedArray=us,Nn.isUndefined=function(e){return e===i},Nn.isWeakMap=function(e){return ns(e)&&fo(e)==C},Nn.isWeakSet=function(e){return ns(e)&&"[object WeakSet]"==Br(e)},Nn.join=function(e,t){return null==e?"":gn.call(e,t)},Nn.kebabCase=zs,Nn.last=Zo,Nn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=gs(n))<0?bn(r+o,0):yn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Mt(e,Ot,o,!0)},Nn.lowerCase=Js,Nn.lowerFirst=Vs,Nn.lt=ds,Nn.lte=ps,Nn.max=function(e){return e&&e.length?mr(e,il,Tr):i},Nn.maxBy=function(e,t){return e&&e.length?mr(e,ao(t,2),Tr):i},Nn.mean=function(e){return Ht(e,il)},Nn.meanBy=function(e,t){return Ht(e,ao(t,2))},Nn.min=function(e){return e&&e.length?mr(e,il,Hr):i},Nn.minBy=function(e,t){return e&&e.length?mr(e,ao(t,2),Hr):i},Nn.stubArray=hl,Nn.stubFalse=bl,Nn.stubObject=function(){return{}},Nn.stubString=function(){return""},Nn.stubTrue=function(){return!0},Nn.multiply=Ll,Nn.nth=function(e,t){return e&&e.length?jr(e,gs(t)):i},Nn.noConflict=function(){return ot._===this&&(ot._=Fe),this},Nn.noop=cl,Nn.now=Ia,Nn.pad=function(e,t,n){e=vs(e);var r=(t=gs(t))?on(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ui(dn(i),n)+e+Ui(un(i),n)},Nn.padEnd=function(e,t,n){e=vs(e);var r=(t=gs(t))?on(e):0;return t&&r<t?e+Ui(t-r,n):e},Nn.padStart=function(e,t,n){e=vs(e);var r=(t=gs(t))?on(e):0;return t&&r<t?Ui(t-r,n)+e:e},Nn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(vs(e).replace(re,""),t||0)},Nn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&yo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ms(e),t===i?(t=e,e=0):t=ms(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=En();return yn(e+o*(t-e+tt("1e-"+((o+"").length-1))),t)}return Jr(e,t)},Nn.reduce=function(e,t,n){var r=za(e)?It:Nt,i=arguments.length<3;return r(e,ao(t,4),n,i,dr)},Nn.reduceRight=function(e,t,n){var r=za(e)?xt:Nt,i=arguments.length<3;return r(e,ao(t,4),n,i,pr)},Nn.repeat=function(e,t,n){return t=(n?yo(e,t,n):t===i)?1:gs(t),Vr(vs(e),t)},Nn.replace=function(){var e=arguments,t=vs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Nn.result=function(e,t,n){var r=-1,o=(t=bi(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[Fo(t[r])];a===i&&(r=o,a=n),e=Qa(a)?a.call(e):a}return e},Nn.round=Bl,Nn.runInContext=e,Nn.sample=function(e){return(za(e)?Kn:Yr)(e)},Nn.size=function(e){if(null==e)return 0;if(Va(e))return ls(e)?on(e):e.length;var t=fo(e);return t==_||t==I?e.size:Or(e).length},Nn.snakeCase=Gs,Nn.some=function(e,t,n){var r=za(e)?Pt:ni;return n&&yo(e,t,n)&&(t=i),r(e,ao(t,3))},Nn.sortedIndex=function(e,t){return ri(e,t)},Nn.sortedIndexBy=function(e,t,n){return ii(e,t,ao(n,2))},Nn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ri(e,t);if(r<n&&ja(e[r],t))return r}return-1},Nn.sortedLastIndex=function(e,t){return ri(e,t,!0)},Nn.sortedLastIndexBy=function(e,t,n){return ii(e,t,ao(n,2),!0)},Nn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ri(e,t,!0)-1;if(ja(e[n],t))return n}return-1},Nn.startCase=Ys,Nn.startsWith=function(e,t,n){return e=vs(e),n=null==n?0:ar(gs(n),0,e.length),t=si(t),e.slice(n,n+t.length)==t},Nn.subtract=Tl,Nn.sum=function(e){return e&&e.length?Dt(e,il):0},Nn.sumBy=function(e,t){return e&&e.length?Dt(e,ao(t,2)):0},Nn.template=function(e,t,n){var r=Nn.templateSettings;n&&yo(e,t,n)&&(t=i),e=vs(e),t=_s({},t,r,Ki);var o,a,s=_s({},t.imports,r.imports,Ki),l=Ms(s),c=qt(s,l),u=0,d=t.interpolate||ve,p="__p += '",f=Te((t.escape||ve).source+"|"+d.source+"|"+(d===Z?de:ve).source+"|"+(t.evaluate||ve).source+"|$","g"),m="//# sourceURL="+(Ae.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ze+"]")+"\n";e.replace(f,(function(t,n,r,i,s,l){return r||(r=i),p+=e.slice(u,l).replace(we,Zt),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),p+="';\n";var g=Ae.call(t,"variable")&&t.variable;if(g){if(ce.test(g))throw new Ee("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(a?p.replace(U,""):p).replace(W,"$1").replace(q,"$1;"),p="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var h=Xs((function(){return _e(l,m+"return "+p).apply(i,c)}));if(h.source=p,Za(h))throw h;return h},Nn.times=function(e,t){if((e=gs(e))<1||e>d)return[];var n=f,r=yn(e,f);t=ao(t),e-=f;for(var i=jt(r,t);++n<e;)t(n);return i},Nn.toFinite=ms,Nn.toInteger=gs,Nn.toLength=hs,Nn.toLower=function(e){return vs(e).toLowerCase()},Nn.toNumber=bs,Nn.toSafeInteger=function(e){return e?ar(gs(e),-9007199254740991,d):0===e?e:0},Nn.toString=vs,Nn.toUpper=function(e){return vs(e).toUpperCase()},Nn.trim=function(e,t,n){if((e=vs(e))&&(n||t===i))return Ut(e);if(!e||!(t=si(t)))return e;var r=an(e),o=an(t);return vi(r,Jt(r,o),Vt(r,o)+1).join("")},Nn.trimEnd=function(e,t,n){if((e=vs(e))&&(n||t===i))return e.slice(0,sn(e)+1);if(!e||!(t=si(t)))return e;var r=an(e);return vi(r,0,Vt(r,an(t))+1).join("")},Nn.trimStart=function(e,t,n){if((e=vs(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=si(t)))return e;var r=an(e);return vi(r,Jt(r,an(t))).join("")},Nn.truncate=function(e,t){var n=30,r="...";if(ts(t)){var o="separator"in t?t.separator:o;n="length"in t?gs(t.length):n,r="omission"in t?si(t.omission):r}var a=(e=vs(e)).length;if(Qt(e)){var s=an(e);a=s.length}if(n>=a)return e;var l=n-on(r);if(l<1)return r;var c=s?vi(s,0,l).join(""):e.slice(0,l);if(o===i)return c+r;if(s&&(l+=c.length-l),as(o)){if(e.slice(l).search(o)){var u,d=c;for(o.global||(o=Te(o.source,vs(pe.exec(o))+"g")),o.lastIndex=0;u=o.exec(d);)var p=u.index;c=c.slice(0,p===i?l:p)}}else if(e.indexOf(si(o),l)!=l){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Nn.unescape=function(e){return(e=vs(e))&&V.test(e)?e.replace(z,ln):e},Nn.uniqueId=function(e){var t=++$e;return vs(e)+t},Nn.upperCase=Ks,Nn.upperFirst=Zs,Nn.each=va,Nn.eachRight=wa,Nn.first=Vo,ll(Nn,(yl={},vr(Nn,(function(e,t){Ae.call(Nn.prototype,t)||(yl[t]=e)})),yl),{chain:!1}),Nn.VERSION="4.17.21",vt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Nn[e].placeholder=Nn})),vt(["drop","take"],(function(e,t){Wn.prototype[e]=function(n){n=n===i?1:bn(gs(n),0);var r=this.__filtered__&&!t?new Wn(this):this.clone();return r.__filtered__?r.__takeCount__=yn(n,r.__takeCount__):r.__views__.push({size:yn(n,f),type:e+(r.__dir__<0?"Right":"")}),r},Wn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),vt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Wn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ao(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),vt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Wn.prototype[e]=function(){return this[n](1).value()[0]}})),vt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Wn.prototype[e]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(il)},Wn.prototype.find=function(e){return this.filter(e).head()},Wn.prototype.findLast=function(e){return this.reverse().find(e)},Wn.prototype.invokeMap=Gr((function(e,t){return"function"==typeof e?new Wn(this):this.map((function(n){return Pr(n,e,t)}))})),Wn.prototype.reject=function(e){return this.filter(Ha(ao(e)))},Wn.prototype.slice=function(e,t){e=gs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Wn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=gs(t))<0?n.dropRight(-t):n.take(t-e)),n)},Wn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Wn.prototype.toArray=function(){return this.take(f)},vr(Wn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Nn[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(Nn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof Wn,c=s[0],u=l||za(t),d=function(e){var t=o.apply(Nn,St([e],s));return r&&p?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var p=this.__chain__,f=!!this.__actions__.length,m=a&&!p,g=l&&!f;if(!a&&u){t=g?t:new Wn(this);var h=e.apply(t,s);return h.__actions__.push({func:ma,args:[d],thisArg:i}),new Un(h,p)}return m&&g?e.apply(this,s):(h=this.thru(d),m?r?h.value()[0]:h.value():h)})})),vt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=xe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Nn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(za(i)?i:[],e)}return this[n]((function(n){return t.apply(za(n)?n:[],e)}))}})),vr(Wn.prototype,(function(e,t){var n=Nn[t];if(n){var r=n.name+"";Ae.call(Cn,r)||(Cn[r]=[]),Cn[r].push({name:t,func:n})}})),Cn[Fi(i,2).name]=[{name:"wrapper",func:i}],Wn.prototype.clone=function(){var e=new Wn(this.__wrapped__);return e.__actions__=Ii(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ii(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ii(this.__views__),e},Wn.prototype.reverse=function(){if(this.__filtered__){var e=new Wn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Wn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=za(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=yn(t,e+a);break;case"takeRight":e=bn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,c=r?s:a-1,u=this.__iteratees__,d=u.length,p=0,f=yn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return pi(e,this.__actions__);var m=[];e:for(;l--&&p<f;){for(var g=-1,h=e[c+=t];++g<d;){var b=u[g],y=b.iteratee,v=b.type,w=y(h);if(2==v)h=w;else if(!w){if(1==v)continue e;break e}}m[p++]=h}return m},Nn.prototype.at=ga,Nn.prototype.chain=function(){return fa(this)},Nn.prototype.commit=function(){return new Un(this.value(),this.__chain__)},Nn.prototype.next=function(){this.__values__===i&&(this.__values__=fs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Nn.prototype.plant=function(e){for(var t,n=this;n instanceof jn;){var r=Do(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Nn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Wn){var t=e;return this.__actions__.length&&(t=new Wn(this)),(t=t.reverse()).__actions__.push({func:ma,args:[ta],thisArg:i}),new Un(t,this.__chain__)}return this.thru(ta)},Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){return pi(this.__wrapped__,this.__actions__)},Nn.prototype.first=Nn.prototype.head,at&&(Nn.prototype[at]=function(){return this}),Nn}();ot._=cn,(r=function(){return cn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},6092:function(e){var t;t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=t.deepExtend=t.animationEndEvents=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.inArray=function(e,t,n){var r=void 0;if(n){for(r in t)if(t.hasOwnProperty(r)&&t[r]===e)return!0}else for(r in t)if(t.hasOwnProperty(r)&&t[r]===e)return!0;return!1},t.stopPropagation=function(e){void 0!==(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.generateID=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="noty_"+e+"_";return t+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.outerHeight=function(e){var t=e.offsetHeight,n=window.getComputedStyle(e);return t+(parseInt(n.marginTop)+parseInt(n.marginBottom))},t.addListener=o,t.hasClass=a,t.addClass=function(e,t){var n=l(e),r=n+t;a(n,t)||(e.className=r.substring(1))},t.removeClass=function(e,t){var n=l(e),r=void 0;a(e,t)&&(r=n.replace(" "+t+" "," "),e.className=r.substring(1,r.length-1))},t.remove=s,t.classList=l,t.visibilityChangeFlow=function(){var e=void 0,t=void 0;function n(){i.PageHidden?setTimeout((function(){Object.keys(i.Store).forEach((function(e){i.Store.hasOwnProperty(e)&&i.Store[e].options.visibilityControl&&i.Store[e].stop()}))}),100):setTimeout((function(){Object.keys(i.Store).forEach((function(e){i.Store.hasOwnProperty(e)&&i.Store[e].options.visibilityControl&&i.Store[e].resume()})),i.queueRenderAll()}),100)}void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),t&&o(document,t,(function(){i.PageHidden=document[e],n()})),o(window,"blur",(function(){i.PageHidden=!0,n()})),o(window,"focus",(function(){i.PageHidden=!1,n()}))},t.createAudioElements=function(e){if(e.hasSound){var t=document.createElement("audio");e.options.sounds.sources.forEach((function(e){var n=document.createElement("source");n.src=e,n.type="audio/"+e.match(/\.([^.]+)$/)[1],t.appendChild(n)})),e.barDom?e.barDom.appendChild(t):document.querySelector("body").appendChild(t),t.volume=e.options.sounds.volume,e.soundPlayed||(t.play(),e.soundPlayed=!0),t.onended=function(){s(t)}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1));function o(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t=t.split(" ");for(var i=0;i<t.length;i++)document.addEventListener?e.addEventListener(t[i],n,r):document.attachEvent&&e.attachEvent("on"+t[i],n)}function a(e,t){return("string"==typeof e?e:l(e)).indexOf(" "+t+" ")>=0}function s(e){e.parentNode&&e.parentNode.removeChild(e)}function l(e){return(" "+(e&&e.className||"")+" ").replace(/\s+/gi," ")}t.animationEndEvents="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",t.deepExtend=function e(t){t=t||{};for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var o in i)i.hasOwnProperty(o)&&(Array.isArray(i[o])?t[o]=i[o]:"object"===r(i[o])&&null!==i[o]?t[o]=e(t[o],i[o]):t[o]=i[o])}return t},t.css=function(){var e=["Webkit","O","Moz","ms"],t={};function n(n,r,i){var o;o=(o=r).replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()})),r=t[o]||(t[o]=function(t){var n=document.body.style;if(t in n)return t;for(var r=e.length,i=t.charAt(0).toUpperCase()+t.slice(1),o=void 0;r--;)if((o=e[r]+i)in n)return o;return t}(o)),n.style[r]=i}return function(e,t){var r=arguments,i=void 0,o=void 0;if(2===r.length)for(i in t)t.hasOwnProperty(i)&&void 0!==(o=t[i])&&t.hasOwnProperty(i)&&n(e,i,o);else n(e,r[1],r[2])}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Defaults=t.Store=t.Queues=t.DefaultMaxVisible=t.docTitle=t.DocModalCount=t.PageHidden=void 0,t.getQueueCounts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"global",t=0,n=s;return l.hasOwnProperty(e)&&(n=l[e].maxVisible,Object.keys(c).forEach((function(n){c[n].options.queue!==e||c[n].closed||t++}))),{current:t,maxVisible:n}},t.addToQueue=function(e){l.hasOwnProperty(e.options.queue)||(l[e.options.queue]={maxVisible:s,queue:[]}),l[e.options.queue].queue.push(e)},t.removeFromQueue=function(e){if(l.hasOwnProperty(e.options.queue)){var t=[];Object.keys(l[e.options.queue].queue).forEach((function(n){l[e.options.queue].queue[n].id!==e.id&&t.push(l[e.options.queue].queue[n])})),l[e.options.queue].queue=t}},t.queueRender=u,t.queueRenderAll=function(){Object.keys(l).forEach((function(e){u(e)}))},t.ghostFix=function(e){var t=r.generateID("ghost"),n=document.createElement("div");n.setAttribute("id",t),r.css(n,{height:r.outerHeight(e.barDom)+"px"}),e.barDom.insertAdjacentHTML("afterend",n.outerHTML),r.remove(e.barDom),n=document.getElementById(t),r.addClass(n,"noty_fix_effects_height"),r.addListener(n,r.animationEndEvents,(function(){r.remove(n)}))},t.build=function(e){!function(e){if(e.options.container)e.layoutDom=document.querySelector(e.options.container);else{var t="noty_layout__"+e.options.layout;e.layoutDom=document.querySelector("div#"+t),e.layoutDom||(e.layoutDom=document.createElement("div"),e.layoutDom.setAttribute("id",t),e.layoutDom.setAttribute("role","alert"),e.layoutDom.setAttribute("aria-live","polite"),r.addClass(e.layoutDom,"noty_layout"),document.querySelector("body").appendChild(e.layoutDom))}}(e);var t='<div class="noty_body">'+e.options.text+"</div>"+function(e){if(d(e)){var t=document.createElement("div");return r.addClass(t,"noty_buttons"),Object.keys(e.options.buttons).forEach((function(n){t.appendChild(e.options.buttons[n].dom)})),e.options.buttons.forEach((function(e){t.appendChild(e.dom)})),t.outerHTML}return""}(e)+'<div class="noty_progressbar"></div>';e.barDom=document.createElement("div"),e.barDom.setAttribute("id",e.id),r.addClass(e.barDom,"noty_bar noty_type__"+e.options.type+" noty_theme__"+e.options.theme),e.barDom.innerHTML=t,m(e,"onTemplate")},t.hasButtons=d,t.handleModal=function(e){var n,o;e.options.modal&&(0===i&&(n=document.querySelector("body"),o=document.createElement("div"),r.addClass(o,"noty_modal"),n.insertBefore(o,n.firstChild),r.addClass(o,"noty_modal_open"),r.addListener(o,r.animationEndEvents,(function(){r.removeClass(o,"noty_modal_open")}))),t.DocModalCount=i+=1)},t.handleModalClose=function(e){if(e.options.modal&&i>0&&(t.DocModalCount=i-=1,i<=0)){var n=document.querySelector(".noty_modal");n&&(r.removeClass(n,"noty_modal_open"),r.addClass(n,"noty_modal_close"),r.addListener(n,r.animationEndEvents,(function(){r.remove(n)})))}},t.queueClose=p,t.dequeueClose=f,t.fire=m,t.openFlow=function(e){m(e,"afterShow"),p(e),r.addListener(e.barDom,"mouseenter",(function(){f(e)})),r.addListener(e.barDom,"mouseleave",(function(){p(e)}))},t.closeFlow=function(e){delete c[e.id],e.closing=!1,m(e,"afterClose"),r.remove(e.barDom),0!==e.layoutDom.querySelectorAll(".noty_bar").length||e.options.container||r.remove(e.layoutDom),(r.inArray("docVisible",e.options.titleCount.conditions)||r.inArray("docHidden",e.options.titleCount.conditions))&&a.decrement(),u(e.options.queue)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.PageHidden=!1;var i=t.DocModalCount=0,o={originalTitle:null,count:0,changed:!1,timer:-1},a=t.docTitle={increment:function(){o.count++,a._update()},decrement:function(){o.count--,o.count<=0?a._clear():a._update()},_update:function(){var e=document.title;o.changed?document.title="("+o.count+") "+o.originalTitle:(o.originalTitle=e,document.title="("+o.count+") "+e,o.changed=!0)},_clear:function(){o.changed&&(o.count=0,document.title=o.originalTitle,o.changed=!1)}},s=t.DefaultMaxVisible=5,l=t.Queues={global:{maxVisible:s,queue:[]}},c=t.Store={};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"global";if(l.hasOwnProperty(e)){var t=l[e].queue.shift();t&&t.show()}}function d(e){return!(!e.options.buttons||!Object.keys(e.options.buttons).length)}function p(e){e.options.timeout&&(e.options.progressBar&&e.progressDom&&r.css(e.progressDom,{transition:"width "+e.options.timeout+"ms linear",width:"0%"}),clearTimeout(e.closeTimer),e.closeTimer=setTimeout((function(){e.close()}),e.options.timeout))}function f(e){e.options.timeout&&e.closeTimer&&(clearTimeout(e.closeTimer),e.closeTimer=-1,e.options.progressBar&&e.progressDom&&r.css(e.progressDom,{transition:"width 0ms linear",width:"100%"}))}function m(e,t){e.listeners.hasOwnProperty(t)&&e.listeners[t].forEach((function(t){"function"==typeof t&&t.apply(e)}))}t.Defaults={type:"alert",layout:"topRight",theme:"mint",text:"",timeout:!1,progressBar:!0,closeWith:["click"],animation:{open:"noty_effects_open",close:"noty_effects_close"},id:!1,force:!1,killer:!1,queue:"global",container:!1,buttons:[],callbacks:{beforeShow:null,onShow:null,afterShow:null,onClose:null,afterClose:null,onClick:null,onHover:null,onTemplate:null},sounds:{sources:[],volume:1,conditions:[]},titleCount:{conditions:[]},modal:!1,visibilityControl:!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotyButton=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.NotyButton=function e(t,n,o){var a=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i(this,e),this.dom=document.createElement("button"),this.dom.innerHTML=t,this.id=s.id=s.id||r.generateID("button"),this.cb=o,Object.keys(s).forEach((function(e){a.dom.setAttribute(e,s[e])})),r.addClass(this.dom,n||"noty_btn"),this}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.Push=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/service-worker.js";return i(this,e),this.subData={},this.workerPath=t,this.listeners={onPermissionGranted:[],onPermissionDenied:[],onSubscriptionSuccess:[],onSubscriptionCancel:[],onWorkerError:[],onWorkerSuccess:[],onWorkerNotSupported:[]},this}return r(e,[{key:"on",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return"function"==typeof t&&this.listeners.hasOwnProperty(e)&&this.listeners[e].push(t),this}},{key:"fire",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.listeners.hasOwnProperty(e)&&this.listeners[e].forEach((function(e){"function"==typeof e&&e.apply(t,n)}))}},{key:"create",value:function(){console.log("NOT IMPLEMENTED YET")}},{key:"isSupported",value:function(){var e=!1;try{e=window.Notification||window.webkitNotifications||navigator.mozNotification||window.external&&void 0!==window.external.msIsSiteMode()}catch(e){}return e}},{key:"getPermissionStatus",value:function(){var e="default";if(window.Notification&&window.Notification.permissionLevel)e=window.Notification.permissionLevel;else if(window.webkitNotifications&&window.webkitNotifications.checkPermission)switch(window.webkitNotifications.checkPermission()){case 1:e="default";break;case 0:e="granted";break;default:e="denied"}else window.Notification&&window.Notification.permission?e=window.Notification.permission:navigator.mozNotification?e="granted":window.external&&void 0!==window.external.msIsSiteMode()&&(e=window.external.msIsSiteMode()?"granted":"default");return e.toString().toLowerCase()}},{key:"getEndpoint",value:function(e){var t=e.endpoint,n=e.subscriptionId;return n&&-1===t.indexOf(n)&&(t+="/"+n),t}},{key:"isSWRegistered",value:function(){try{return"activated"===navigator.serviceWorker.controller.state}catch(e){return!1}}},{key:"unregisterWorker",value:function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.unregister(),e.fire("onSubscriptionCancel")}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}))}},{key:"requestSubscription",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this,r=this.getPermissionStatus(),i=function(r){"granted"===r?(e.fire("onPermissionGranted"),"serviceWorker"in navigator?navigator.serviceWorker.register(e.workerPath).then((function(){navigator.serviceWorker.ready.then((function(e){n.fire("onWorkerSuccess"),e.pushManager.subscribe({userVisibleOnly:t}).then((function(e){var t=e.getKey("p256dh"),r=e.getKey("auth");n.subData={endpoint:n.getEndpoint(e),p256dh:t?window.btoa(String.fromCharCode.apply(null,new Uint8Array(t))):null,auth:r?window.btoa(String.fromCharCode.apply(null,new Uint8Array(r))):null},n.fire("onSubscriptionSuccess",[n.subData])})).catch((function(e){n.fire("onWorkerError",[e])}))}))})):n.fire("onWorkerNotSupported")):"denied"===r&&(e.fire("onPermissionDenied"),e.unregisterWorker())};"default"===r?window.Notification&&window.Notification.requestPermission?window.Notification.requestPermission(i):window.webkitNotifications&&window.webkitNotifications.checkPermission&&window.webkitNotifications.requestPermission(i):i(r)}}]),e}()},function(e,t,n){(function(t,r){var i;i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,a=void 0,s=void 0,l=function(e,t){g[o]=e,g[o+1]=t,2===(o+=2)&&(s?s(h):E())},c="undefined"!=typeof window?window:void 0,u=c||{},d=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function m(){var e=setTimeout;return function(){return e(h,1)}}var g=new Array(1e3);function h(){for(var e=0;e<o;e+=2)(0,g[e])(g[e+1]),g[e]=void 0,g[e+1]=void 0;o=0}var b,y,v,w,E=void 0;function _(e,t){var n=arguments,r=this,i=new this.constructor(T);void 0===i[B]&&D(i);var o,a=r._state;return a?(o=n[a-1],l((function(){return F(a,i,o,r._result)}))):$(r,i,e,t),i}function L(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(T);return C(t,e),t}p?E=function(){return t.nextTick(h)}:d?(y=0,v=new d(h),w=document.createTextNode(""),v.observe(w,{characterData:!0}),E=function(){w.data=y=++y%2}):f?((b=new MessageChannel).port1.onmessage=h,E=function(){return b.port2.postMessage(0)}):E=void 0===c?function(){try{var e=n(9);return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(h)}:m()}catch(e){return m()}}():m();var B=Math.random().toString(36).substring(16);function T(){}var S=void 0,I=new H;function x(e){try{return e.then}catch(e){return I.error=e,I}}function P(t,n,r){n.constructor===t.constructor&&r===_&&n.constructor.resolve===L?function(e,t){1===t._state?M(e,t._result):2===t._state?A(e,t._result):$(t,void 0,(function(t){return C(e,t)}),(function(t){return A(e,t)}))}(t,n):r===I?(A(t,I.error),I.error=null):void 0===r?M(t,n):e(r)?function(e,t,n){l((function(e){var r=!1,i=function(n,i,o,a){try{n.call(i,(function(n){r||(r=!0,t!==n?C(e,n):M(e,n))}),(function(t){r||(r=!0,A(e,t))}))}catch(e){return e}}(n,t,0,0,e._label);!r&&i&&(r=!0,A(e,i))}),e)}(t,n,r):M(t,n)}function C(e,t){var n,r;e===t?A(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?M(e,t):P(e,t,x(t)))}function k(e){e._onerror&&e._onerror(e._result),O(e)}function M(e,t){e._state===S&&(e._result=t,e._state=1,0!==e._subscribers.length&&l(O,e))}function A(e,t){e._state===S&&(e._state=2,e._result=t,l(k,e))}function $(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=n,i[o+2]=r,0===o&&e._state&&l(O,e)}function O(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?F(n,r,i,o):i(o);e._subscribers.length=0}}function H(){this.error=null}var R=new H;function F(t,n,r,i){var o=e(r),a=void 0,s=void 0,l=void 0,c=void 0;if(o){if(a=function(e,t){try{return e(t)}catch(e){return R.error=e,R}}(r,i),a===R?(c=!0,s=a.error,a.error=null):l=!0,n===a)return void A(n,new TypeError("A promises callback cannot return that same promise."))}else a=i,l=!0;n._state!==S||(o&&l?C(n,a):c?A(n,s):1===t?M(n,a):2===t&&A(n,a))}var N=0;function D(e){e[B]=N++,e._state=void 0,e._result=void 0,e._subscribers=[]}function j(e,t){this._instanceConstructor=e,this.promise=new e(T),this.promise[B]||D(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&M(this.promise,this._result))):A(this.promise,new Error("Array Methods must be provided an Array"))}function U(e){this[B]=N++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof U?function(e,t){try{t((function(t){C(e,t)}),(function(t){A(e,t)}))}catch(t){A(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return j.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)},j.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===L){var i=x(e);if(i===_&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===U){var o=new n(T);P(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},j.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===S&&(this._remaining--,2===e?A(r,n):this._result[t]=n),0===this._remaining&&M(r,this._result)},j.prototype._willSettleAt=function(e,t){var n=this;$(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},U.all=function(e){return new j(this,e).promise},U.race=function(e){var t=this;return i(e)?new t((function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},U.resolve=L,U.reject=function(e){var t=new this(T);return A(t,e),t},U._setScheduler=function(e){s=e},U._setAsap=function(e){l=e},U._asap=l,U.prototype={constructor:U,then:_,catch:function(e){return this.then(null,e)}},U.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=U},U.Promise=U,U},e.exports=i()}).call(t,n(7),n(8))},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(5);var i,o=(i=n(4))&&i.__esModule?i:{default:i},a=u(n(0)),s=u(n(1)),l=n(2),c=n(3);function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d(this,e),this.options=a.deepExtend({},s.Defaults,t),s.Store[this.options.id]?s.Store[this.options.id]:(this.id=this.options.id||a.generateID("bar"),this.closeTimer=-1,this.barDom=null,this.layoutDom=null,this.progressDom=null,this.showing=!1,this.shown=!1,this.closed=!1,this.closing=!1,this.killable=this.options.timeout||this.options.closeWith.length>0,this.hasSound=this.options.sounds.sources.length>0,this.soundPlayed=!1,this.listeners={beforeShow:[],onShow:[],afterShow:[],onClose:[],afterClose:[],onClick:[],onHover:[],onTemplate:[]},this.promises={show:null,close:null},this.on("beforeShow",this.options.callbacks.beforeShow),this.on("onShow",this.options.callbacks.onShow),this.on("afterShow",this.options.callbacks.afterShow),this.on("onClose",this.options.callbacks.onClose),this.on("afterClose",this.options.callbacks.afterClose),this.on("onClick",this.options.callbacks.onClick),this.on("onHover",this.options.callbacks.onHover),this.on("onTemplate",this.options.callbacks.onTemplate),this)}return r(e,[{key:"on",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return"function"==typeof t&&this.listeners.hasOwnProperty(e)&&this.listeners[e].push(t),this}},{key:"show",value:function(){var t=this;if(this.showing||this.shown)return this;!0===this.options.killer?e.closeAll():"string"==typeof this.options.killer&&e.closeAll(this.options.killer);var n=s.getQueueCounts(this.options.queue);if(n.current>=n.maxVisible||s.PageHidden&&this.options.visibilityControl)return s.addToQueue(this),s.PageHidden&&this.hasSound&&a.inArray("docHidden",this.options.sounds.conditions)&&a.createAudioElements(this),s.PageHidden&&a.inArray("docHidden",this.options.titleCount.conditions)&&s.docTitle.increment(),this;if(s.Store[this.id]=this,s.fire(this,"beforeShow"),this.showing=!0,this.closing)return this.showing=!1,this;if(s.build(this),s.handleModal(this),this.options.force?this.layoutDom.insertBefore(this.barDom,this.layoutDom.firstChild):this.layoutDom.appendChild(this.barDom),this.hasSound&&!this.soundPlayed&&a.inArray("docVisible",this.options.sounds.conditions)&&a.createAudioElements(this),a.inArray("docVisible",this.options.titleCount.conditions)&&s.docTitle.increment(),this.shown=!0,this.closed=!1,s.hasButtons(this)&&Object.keys(this.options.buttons).forEach((function(e){var n=t.barDom.querySelector("#"+t.options.buttons[e].id);a.addListener(n,"click",(function(n){a.stopPropagation(n),t.options.buttons[e].cb(t)}))})),this.progressDom=this.barDom.querySelector(".noty_progressbar"),a.inArray("click",this.options.closeWith)&&(a.addClass(this.barDom,"noty_close_with_click"),a.addListener(this.barDom,"click",(function(e){a.stopPropagation(e),s.fire(t,"onClick"),t.close()}),!1)),a.addListener(this.barDom,"mouseenter",(function(){s.fire(t,"onHover")}),!1),this.options.timeout&&a.addClass(this.barDom,"noty_has_timeout"),this.options.progressBar&&a.addClass(this.barDom,"noty_has_progressbar"),a.inArray("button",this.options.closeWith)){a.addClass(this.barDom,"noty_close_with_button");var r=document.createElement("div");a.addClass(r,"noty_close_button"),r.innerHTML="×",this.barDom.appendChild(r),a.addListener(r,"click",(function(e){a.stopPropagation(e),t.close()}),!1)}return s.fire(this,"onShow"),null===this.options.animation.open?this.promises.show=new o.default((function(e){e()})):"function"==typeof this.options.animation.open?this.promises.show=new o.default(this.options.animation.open.bind(this)):(a.addClass(this.barDom,this.options.animation.open),this.promises.show=new o.default((function(e){a.addListener(t.barDom,a.animationEndEvents,(function(){a.removeClass(t.barDom,t.options.animation.open),e()}))}))),this.promises.show.then((function(){var e=t;setTimeout((function(){s.openFlow(e)}),100)})),this}},{key:"stop",value:function(){return s.dequeueClose(this),this}},{key:"resume",value:function(){return s.queueClose(this),this}},{key:"setTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(this.stop(),this.options.timeout=e,this.barDom){this.options.timeout?a.addClass(this.barDom,"noty_has_timeout"):a.removeClass(this.barDom,"noty_has_timeout");var t=this;setTimeout((function(){t.resume()}),100)}return this}))},{key:"setText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.barDom&&(this.barDom.querySelector(".noty_body").innerHTML=e),t&&(this.options.text=e),this}},{key:"setType",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.barDom){var r=a.classList(this.barDom).split(" ");r.forEach((function(e){"noty_type__"===e.substring(0,11)&&a.removeClass(t.barDom,e)})),a.addClass(this.barDom,"noty_type__"+e)}return n&&(this.options.type=e),this}},{key:"setTheme",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.barDom){var r=a.classList(this.barDom).split(" ");r.forEach((function(e){"noty_theme__"===e.substring(0,12)&&a.removeClass(t.barDom,e)})),a.addClass(this.barDom,"noty_theme__"+e)}return n&&(this.options.theme=e),this}},{key:"close",value:function(){var e=this;return this.closed?this:this.shown?(s.fire(this,"onClose"),this.closing=!0,null===this.options.animation.close||!1===this.options.animation.close?this.promises.close=new o.default((function(e){e()})):"function"==typeof this.options.animation.close?this.promises.close=new o.default(this.options.animation.close.bind(this)):(a.addClass(this.barDom,this.options.animation.close),this.promises.close=new o.default((function(t){a.addListener(e.barDom,a.animationEndEvents,(function(){e.options.force?a.remove(e.barDom):s.ghostFix(e),t()}))}))),this.promises.close.then((function(){s.closeFlow(e),s.handleModalClose(e)})),this.closed=!0,this):(s.removeFromQueue(this),this)}}],[{key:"closeAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object.keys(s.Store).forEach((function(t){e?s.Store[t].options.queue===e&&s.Store[t].killable&&s.Store[t].close():s.Store[t].killable&&s.Store[t].close()})),this}},{key:"clearQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"global";return s.Queues.hasOwnProperty(e)&&(s.Queues[e].queue=[]),this}},{key:"overrideDefaults",value:function(e){return s.Defaults=a.deepExtend({},s.Defaults,e),this}},{key:"setMaxVisible",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.DefaultMaxVisible,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";return s.Queues.hasOwnProperty(t)||(s.Queues[t]={maxVisible:e,queue:[]}),s.Queues[t].maxVisible=e,this}},{key:"button",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new l.NotyButton(e,t,n,r)}},{key:"version",value:function(){return"3.2.0-beta"}},{key:"Push",value:function(e){return new c.Push(e)}},{key:"Queues",get:function(){return s.Queues}},{key:"PageHidden",get:function(){return s.PageHidden}}]),e}();t.default=p,"undefined"!=typeof window&&a.visibilityChangeFlow(),e.exports=t.default},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||u||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){}])},e.exports=t()}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";let t="none";let n=null,i=null;function o(e,t){n=e,i=t}function a(){return n}function s(){return i}var l=r(6092),c=r.n(l);const u=[document.getElementById("printerSettingsModal"),document.getElementById("printerManagerModal"),document.getElementById("printerLogsModal"),document.getElementById("printerStatistics"),document.getElementById("printerSelectModal")];class d{static getColour(e){return"Operational"===e?{name:"secondary",hex:"#262626",category:"Idle"}:"Paused"===e?{name:"warning",hex:"#583c0e",category:"Idle"}:"Printing"===e||"Pausing"===e||"Cancelling"===e?{name:"warning",hex:"#583c0e",category:"Active"}:"Error"===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Offline"===e?{name:"danger",hex:"#2e0905",category:"Offline"}:"Searching..."===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Closed"===e?{name:"danger",hex:"#2e0905",category:"Closed"}:"Complete"===e?{name:"success",hex:"#00330e",category:"Complete"}:{name:"danger",hex:"#2e0905",category:"Offline"}}static createMessage(e,t){const n=document.getElementById(t),r=`\n      <div class="alert alert-${e.type} alert-dismissible fade show" role="alert">\n        ${e.msg}\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    `;n.insertAdjacentHTML("beforeend",r)}static createAlert(e,t,n,r){r=null!=r?["click"]:[],c().setMaxVisible(50);let i=new(c())({type:e,theme:"bootstrap-v4",closeWith:r,timeout:n,layout:"bottomRight",text:t});return i.show(),i}static doesElementNeedUpdating(e,t,n){t&&JSON.stringify(e)!==JSON.stringify(t[n])&&(t[n]=e)}static clearSelect(e){document.querySelectorAll("*[id^="+e+"]").forEach((e=>{e.value=""}))}static addSelectListeners(e){document.querySelectorAll("*[id^="+e+"]").forEach((e=>{"input"===e.localName&&(e.addEventListener("focus",(t=>{e.value!==e.placeholder&&(e.value=e.placeholder)})),e.addEventListener("focusout",(t=>{e.value!==e.placeholder&&(e.placeholder=e.value)})))}))}static returnSpinnerTemplate(){return'<i class="fas fa-spinner fa-spin"></i>'}static removeLoaderFromElementInnerHTML(e){e&&e.innerHTML.includes("spinner")&&(e.innerHTML=e.innerHTML.replace(d.returnSpinnerTemplate(),""))}static addLoaderToElementsInnerHTML(e){e.innerHTML.includes("spinner")||(e.innerHTML+=d.returnSpinnerTemplate())}static checkIfAnyModalShown(){return u.map((e=>e.classList.contains("show"))).includes(!0)}static checkIfSpecificModalShown(e){const t=u.filter((t=>t.id===e));return!!t[0]&&t[0].classList.contains("show")}static async delay(e){return new Promise((t=>{setTimeout(t,e)}))}static removeLine(e){e.remove()}static disableElements(e){e.forEach((e=>{e.disabled=!0}))}static enableElements(e){e.forEach((e=>{e.disabled=!1}))}static blankElementValue(e){e.forEach((e=>{e.value=""}))}static setElementValueFromPlaceholder(e){e.forEach((e=>{e.value=e.placeholder}))}static setElementPlaceholderFromValue(e){e.forEach((e=>{e.placeholder=e.value}))}static generateTime(e){let t="";if(void 0===e||isNaN(e)||null===e)t="No Time Estimate";else{const n=Math.floor(e/86400);e-=3600*n*24;const r=Math.floor(e/3600);e-=3600*r;const i=Math.floor(e/60);e-=60*i,t=`${n}d, ${r}h, ${i}m, ${e=Math.floor(e)}s`,0==i&&t.includes("0m")&&(t=t.replace(" 0m,","")),0==r&&t.includes("0h")&&(t=t.replace(" 0h,","")),0==n&&t.includes("0d")&&(t=t.replace("0d,","")),0==i&&0==r&&0==n&&0==e&&(t=t.replace("0s","Done"))}return t}static milisecondsToDays(e){return isNaN(e)?0:Math.floor(e/86400)}static generateMilisecondsTime(e){let t=e/1e3,n="";if(void 0!==t&&!isNaN(t)&&null!==t){const r=Math.floor(t/86400);t-=3600*r*24;const i=Math.floor(t/3600);t-=3600*i;const o=Math.floor(t/60);return t-=60*o,t=Math.floor(t),n=`${r}d, ${i}h, ${o}m, ${t}s`,0==o&&n.includes("0m")&&(n=n.replace(" 0m,","")),0==i&&n.includes("0h")&&(n=n.replace(" 0h,","")),0==r&&n.includes("0d")&&(n=n.replace("0d,","")),0==t&&(n=n.replace(", 0s","")),0==o&&0==i&&0==r&&0==t&&(n=n.replace("0s",e+" ms")),e||(n="No Interval"),n}n="No Interval"}static isPrinterDisabled(e){return!e.target.innerHTML.includes("running")&&(!!e.target.innerHTML.includes("wheelchair")||void 0)}static addDisplayNoneToElement(e){e.classList.contains("d-none")&&e.classList.remove("d-none")}static removeDisplayNoneFromElement(e){e.classList.contains("d-none")||e.classList.add("d-none")}static togglePrinterDisableState(e,t){const n=document.getElementById(`printerCard-${t}`);e.target.innerHTML.includes("running")?(e.target.classList="btn btn-outline-light btn-sm",e.target.innerHTML='<i class="fas fa-wheelchair"></i> Disabled',e.target.title="Printer is Disabled, click to enable",n.classList="printerDisabled"):e.target.innerHTML.includes("wheelchair")&&(e.target.classList="btn btn-outline-success btn-sm",e.target.innerHTML='<i class="fas fa-running"></i> Enabled',e.target.title="Printer is Enabled, click to disable",n.classList="")}static getValueOrPlaceHolder(e){return e?""===e.value?void 0:e.value:void 0}static returnProgressColour(e,t){return e<45?t?"bg-danger":"bg-success":e<75?"bg-warning":t?"bg-success":"bg-danger"}static convertValueToTemplate(e,t){const n=d.camelCaseToWords(e),r=`opBulk-${e}`;return"string"==typeof t?`\n        <div class="input-group mb-3 col-3">\n          <div class="input-group-prepend">\n            <span class="input-group-text" id="basic-addon1">${n}</span>\n          </div>\n          <input id="${r}" type="text" class="form-control" placeholder="${t}" aria-label="Username" aria-describedby="basic-addon1">\n        </div>\n      `:"number"==typeof t?`\n        <div class="input-group mb-3 col-3">\n          <div class="input-group-prepend">\n            <span class="input-group-text" id="basic-addon1">${n}</span>\n          </div>\n          <input id="${r}" type="number" class="form-control" placeholder="${t}" aria-label="Username" aria-describedby="basic-addon1">\n        </div>\n      `:"boolean"==typeof t?`\n        <div class="col-4">\n          <form class="was-validated">\n            <div class="custom-control custom-checkbox mb-3">\n                <input id="${r}" type="checkbox" class="custom-control-input" required ${t?"checked='true'":""}>\n                <label class="custom-control-label" for="${r}">${n}</label>\n                <div class="valid-feedback">${n} is on.</div>\n                 <div class="invalid-feedback">${n} is off.</div>\n            </div>\n          </form>\n        </div>\n      `:void 0}static camelCaseToWords(e){return e.match(/^[a-z]+|[A-Z][a-z]*/g).map((function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()})).join(" ")}}let p=null,f=null,m=null;function g(e,t){p=new Worker("/assets/dist/sse.client.min.js"),p.postMessage({url:e}),p.onmessage=function(e){e.data&&t(e.data)}}function h(){"hidden"===document.visibilityState?null!==p&&(console.log("Screen Abandonded, closing web worker..."),p.terminate(),p=null):null===p&&(console.log("Screen resumed... opening web worker..."),g(m,f))}class b{static randomString(){return Math.random().toString(36).substr(2,5)}static perc(e,t=2){return`${e?.toFixed(t)||0}%`}static toFixed(e,t=0){return e?.toFixed(t)||0}static generateTime(e){let t="";if(void 0===e||isNaN(e)||null===e)t="No Time Estimate";else{const n=Math.floor(e/86400);e-=3600*n*24;const r=Math.floor(e/3600);e-=3600*r;const i=Math.floor(e/60);e-=60*i,t=`${n}d, ${r}h, ${i}m, ${e=Math.floor(e)}s`,0===i&&t.includes("0m")&&(t=t.replace(" 0m,","")),0===r&&t.includes("0h")&&(t=t.replace(" 0h,","")),0===n&&t.includes("0d")&&(t=t.replace("0d,","")),0===i&&0===r&&0===n&&0===e&&(t=t.replace("0s","Done"))}return t}static isBetween(e,t,n){return(e-t)*(e-n)<=0}static bytes(e,t){if(void 0===e||isNaN(e)||null===e)return"No File Estimate";if(0==e)return"0 Bytes";const n=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(n))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}`}static dateClean(e){return`${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][(e=new Date(e)).getDay()]} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]} ${e.getFullYear()} - ${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`}static generateCost(e){return e?e.toFixed(2):0}static getPercentage(e,t){return(100*e/t).toFixed(0)}static firstDayOfMonth(){const e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)}static lastDayOfMonth(){const e=new Date;return new Date(e.getFullYear(),e.getMonth()+1,0)}}var y=r(2868),v=r.n(y);class w extends Error{static hasErrorNotificationBeenTriggered=!1;constructor(e,t){super(),Object.assign(e,t),this.name="OctoFarm Error",this.type=e.type,this.code=e.code,this.message=e.message,this.errors=e.errors,this.meta=e.meta,this.statusCode=e.statusCode,this.color=e.color,w.hasErrorNotificationBeenTriggered=!0}}const E="CLIENT",L="SERVER",B="NETWORK",T={BAD_REQUEST:{type:B,color:"danger",code:"BAD_REQUEST",message:"Bad request",statusCode:400},UNAUTHORIZED:{type:B,color:"danger",code:"UNAUTHORIZED",message:"Unauthorized",statusCode:401},FORBIDDEN:{type:B,color:"danger",code:"FORBIDDEN",message:"Forbidden",statusCode:403},RESOURCE_NOT_FOUND:{type:B,color:"danger",code:"RESOURCE_NOT_FOUND",message:"Resource not found",statusCode:404},NO_CONNECTION:{type:B,color:"danger",code:"NO_CONNECTION",message:"No connection to resource available",statusCode:0},INTERNAL_SERVER_ERROR:{type:L,color:"danger",code:"INTERNAL_SERVER_ERROR",message:"Something went wrong, Please try again later.",statusCode:500},BAD_GATEWAY:{type:L,color:"danger",code:"BAD_GATEWAY",message:"Bad gateway",statusCode:502},SERVICE_UNAVAILABLE:{type:L,color:"danger",code:"SERVICE_UNAVAILABLE",message:"Service unavailable",statusCode:503},GATEWAY_TIMEOUT:{type:L,color:"danger",code:"GATEWAY_TIMEOUT",message:"Gateway timeout",statusCode:504},UNKNOWN:{type:L,color:"danger",code:"UNKNOWN",message:"Unknown Error Response",statusCode:999}},S={FAILED_VALIDATION_PATH:{type:E,color:"danger",code:"FAILED_VALIDATION_PATH",message:"Input validation failed, no path was supplied",statusCode:412},FAILED_VALIDATION_KEY:{type:E,color:"danger",code:"FAILED_VALIDATION_KEY",message:"Input validation failed, no key was supplied",statusCode:412},FAILED_STATE_UPDATE:{type:E,color:"warning",code:"FAILED_STATE_UPDATE",message:"There was an issue updating the printer state",statusCode:412},UNKNOWN_ERROR:{type:"UNKNOWN",color:"danger",code:"UNKNOWN_ERROR",message:"We encountered an unknown error! Please help the developer out and send a issue report!",statusCode:999}};v().interceptors.request.use((function(e){return I.validatePath(e.url),e}),(function(e){return Promise.reject(e)})),v().interceptors.response.use((function(e){return e}),(function(e){if(window.serverOffline)return{data:!1};switch(e?.response?.status){case 0:throw new w(T.NO_CONNECTION);case 400:throw new w(T.BAD_REQUEST);case 401:throw new w(T.UNAUTHORIZED);case 403:throw new w(T.FORBIDDEN);case 404:throw new w(T.RESOURCE_NOT_FOUND);case 500:throw new w(T.INTERNAL_SERVER_ERROR);case 502:throw new w(T.BAD_GATEWAY);case 503:throw new w(T.SERVICE_UNAVAILABLE);case 504:throw new w(T.GATEWAY_TIMEOUT);default:throw new w(T.UNKNOWN)}}));class I{static base="/api";static printerRoute="/printers";static disablePrinterRoute=this.printerRoute+"/disable/";static enablePrinterRoute=this.printerRoute+"/enable/";static serverSettingsRoute="/settings/server";static filamentRoute="/filament";static filamentStatistics=`${this.filamentRoute}/get/statistics`;static logsRoute=`${this.serverSettingsRoute}/logs`;static updateSettingsRoute=`${this.serverSettingsRoute}/update`;static userRoute="/users/users";static healthCheckRoute=`${this.printerRoute}/healthChecks`;static farmOverviewRoute=`${this.printerRoute}/farmOverview`;static connectionOverviewRoute=`${this.printerRoute}/connectionOverview`;static validatePath(e){if(!e)throw new URL(path,window.location.origin),new w(S.FAILED_VALIDATION_PATH)}static async getPrinter(e){if(!e)throw"Cant fetch printer without defined 'id' input";const t={i:e};return await this.post(`${this.printerRoute}/printerInfo/`,t)}static async listPrinters(e=!1){let t=`${this.printerRoute}/printerInfo`;return e&&(t+="?disabled=true"),this.post(t)}static async disablePrinter(e){return this.patch(`${this.disablePrinterRoute}${e}`)}static async enablePrinter(e){return this.patch(`${this.enablePrinterRoute}${e}`)}static async refreshPrinterSettings(e){const t={i:e};return this.post(`${this.printerRoute}/updatePrinterSettings`,t)}static async generateLogDump(){return this.post(`${this.logsRoute}/generateLogDump`,{})}static async deleteLogFile(e){return this.delete(`${this.logsRoute}/${e}`)}static async clearOldLogs(){return this.delete(`${this.logsRoute}/clear-old`)}static async getHistoryStatistics(){return this.get("history/statisticsData")}static async getClientSettings(){return this.get("settings/client/get")}static async getServerSettings(){return this.get(`${this.serverSettingsRoute}/get`)}static async getUser(e){return this.get(`${this.userRoute}/${e}`)}static async createNewUser(e){return this.post(`${this.userRoute}`,e)}static async editUser(e,t){return this.patch(`${this.userRoute}/${e}`,t)}static async deleteUser(e){return this.delete(`${this.userRoute}/${e}`)}static async resetUserPassword(e,t){return this.patch(`${this.userRoute}/${e}`,t)}static async getFilamentStatistics(){return this.get(this.filamentStatistics)}static async updateServerSettings(e){return this.post(this.updateSettingsRoute,e)}static async restartServer(){return this.post(`${this.serverSettingsRoute}/restart`,{})}static async getCustomGcode(e){let t="settings/customGcode";return e&&(t=t+"/"+e),this.get(t)}static async getOctoPrintUniqueFolders(){return this.get(`${this.printerRoute}/listUniqueFolders`)}static getCurrentOpState(){return this.get("client/currentOpSorting")}static getHealthChecks(){return this.get(this.healthCheckRoute)}static getFarmOverview(){return this.get(this.farmOverviewRoute)}static getConnectionOverview(){return this.get(this.connectionOverviewRoute)}static updateCurrentOpState({iterie:e,order:t}){return this.post("client/currentOpSorting",{iterie:e,order:t})}static async get(e){const t=new URL(e,window.location.origin).href;return v().get(t).then((e=>e.data))}static async post(e,t){const n=new URL(e,window.location.origin).href;return v().post(n,t).then((e=>e.data))}static async delete(e){const t=new URL(e,window.location.origin).href;return v().delete(t).then((e=>e.data))}static async patch(e,t){const n=new URL(e,window.location.origin).href;return v().patch(n,t).then((e=>e.data))}}class x{static validatePrinter(e){if(!e.apikey)throw new Error("Api key not provided");if(!e.printerURL)throw new Error("Printer URL not provided")}static get(e,t){this.validatePrinter(e);const n=`${e.printerURL}/${t}`;return fetch(n,{method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}}).catch((e=>{console.log(e)}))}static postNOAPI(e,t,n){this.validatePrinter(e);const r=`${e.printerURL}/${t}`;return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)}).catch((e=>{console.log(e)}))}static post(e,t,n){this.validatePrinter(e);const r=`${e.printerURL}/api/${t}`;return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)}).catch((e=>{console.log(e)}))}static folder(e,t,n){this.validatePrinter(e);const r=`${e.printerURL}/api/files/${t}`;return fetch(r,{method:"POST",headers:{"X-Api-Key":e.apikey},body:n}).catch((e=>{console.log(e)}))}static delete(e,t){this.validatePrinter(e);const n=`${e.printerURL}/api/${t}`;return fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}}).catch((e=>{console.log(e)}))}static async selectTool(e,t){const n={command:"select",tool:t};return 204===(await x.post(e,"printer/tool",n)).status}static async system(e,t){const n="system/commands/core/"+t;bootbox.confirm({message:`Are your sure you want to ${t} ${e.printerName}?`,buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},async callback(r){r&&(204===(await x.post(e,n).catch((e=>{d.createAlert("danger",e,4e3,"Clicked")}))).status?d.createAlert("success",`${e.printerName}: ${t} was successful`,3e3,"clicked"):d.createAlert("error",`${e.printerName}: ${t} was unsuccessful. Please make sure printer is connected and commands are setup in Settings -> Server.`,3e3,"clicked"))}})}static async systemNoConfirm(e,t){const n="system/commands/core/"+t;return await x.post(e,n)}static async move(e,t,n,r,i){const o=function(){e.target.classList="btn btn-light"};let a=null,s=await document.querySelectorAll("#pcAxisSteps > .btn.active");s=s[0].innerHTML;let l=null;"home"===n?l={command:n,axes:r}:"jog"===n?(s=Number(null!=i?i+s:s),l={command:n,[r]:s}):"feedrate"===n&&(l={command:n,factor:s}),a=await x.post(t,"printer/printhead",l),204===a.status?(e.target.classList="btn btn-success",setTimeout(o,500)):(e.target.classList="btn btn-danger",setTimeout(o,500))}static async checkFile(e,t){const n="api/files/local/"+t;return(await x.get(e,n)).status}static async file(e,t,n,r=!0){const i="files/local/"+t;let o=null;if("load"===n){const t={command:"select",print:!1};await x.updateFeedAndFlow(e),await x.updateFilamentOffsets(e),await x.updateBedOffsets(e),o=await x.post(e,i,t)}else if("print"===n){const t={command:"select",print:!0};await x.updateFeedAndFlow(e),await x.updateFilamentOffsets(e),await x.updateBedOffsets(e),o=await x.post(e,i,t)}else"delete"===n&&(o=await x.delete(e,i));console.log(o?.status),console.log(r),204===o?.status||200===o?.status?"delete"===n?r&&d.createAlert("success",`${e.printerName}: delete completed`,3e3,"clicked"):r&&d.createAlert("success",`${e.printerName}: ${n} actioned`,3e3,"clicked"):r&&d.createAlert("error",`${e.printerName}: ${n} failed`,3e3,"clicked")}static async updateFeedAndFlow(e){const t={command:"flowrate",factor:parseInt(e.flowRate)};await x.post(e,"printer/tool",t);const n={command:"feedrate",factor:parseInt(e.feedRate)};await x.post(e,"printer/printhead",n)}static async updateBedOffsets(e){if(null!=e.selectedFilament&&Array.isArray(e.selectedFilament)){const t=parseInt(e?.selectedFilament[0]?.spools?.bedOffset);if(t){const n={command:"offset",offset:t};await x.post(e,"printer/bed",n)}}}static async updateFilamentOffsets(e){if(null!=e.selectedFilament&&Array.isArray(e.selectedFilament)){const t={command:"offset",offsets:{}};e.selectedFilament.forEach(((e,n)=>{null!=e&&(t.offsets["tool"+n]=parseInt(e.spools.tempOffset))})),await x.post(e,"printer/tool",t)}}static async jobAction(e,t,n){let r=await I.get("settings/server/get"),i=!1;void 0!==r.filament&&(i=r.filament.filamentCheck);let o=!1;if(null!=e.selectedFilament&&Array.isArray(e.selectedFilament)&&(o=e.selectedFilament.every((function(e){return null!==e}))),"start"===t.command&&(await x.updateFeedAndFlow(e),await x.updateFilamentOffsets(e),await x.updateBedOffsets(e)),!i||o||"start"!==t.command)return await x.post(e,"job",t);bootbox.confirm({message:"You have spools in the inventory, but none selected. Would you like to select a spool?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},async callback(n){if(!n)return await x.post(e,"job",t)}}),n&&(n.target.disabled=!1)}static async connect(e,t){let n;n="connect"===e?{command:"connect",port:document.getElementById("pmSerialPort").value,baudrate:parseInt(document.getElementById("pmBaudrate").value),printerProfile:document.getElementById("pmProfile").value,save:!0}:{command:"disconnect"};const r=await x.post(t,"connection",n);void 0!==r&&204===r.status?(d.createAlert("success",`${t.printerName}: ${n.command}ion attempt was successful`,3e3,"click"),"connect"===e?(document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0):(document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1)):(document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1,d.createAlert("error",`${t.printerName}: could not ${n.command}.`,3e3,"click"))}static async power(e,t,n,r){if(t.includes("[PrinterURL]")&&(t=t.replace("[PrinterURL]",e.printerURL)),t.includes("[PrinterAPI]")&&(t=t.replace("[PrinterAPI]",e.apikey)),void 0===r||0===r.length)try{const r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}});200!==r.status||204!==r.status?d.createAlert("error",`${e.printerName}: Could not complete ${n}`,3e3):d.createAlert("success",`${e.printerName}: Successfully completed ${n}`,3e3)}catch(t){d.createAlert("error",`${e.printerName}: Could not complete ${n} - Error: ${t}`,3e3)}else try{const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:r});200!==i.status||204!==i.status?d.createAlert("error",`${e.printerName}: Could not complete ${n}`,3e3):d.createAlert("success",`${e.printerName}: Successfully completed ${n}`,3e3)}catch(t){d.createAlert("error",`${e.printerName}: Could not complete ${n} - Error: ${t}`,3e3)}return"done"}static async getPowerStatus(e,t,n){if(t.includes("[PrinterURL]")&&(t=t.replace("[PrinterURL]",e.printerURL)),t.includes("[PrinterAPI]")&&(t=t.replace("[PrinterAPI]",e.apikey)),void 0===n||""===n||null===n){let n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}});return 200!==n.status||204!==n.status?"No Status":(n=await n.json(),n)}try{const r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:n});let i="No Status";200!==r.status&&204!==r.status||(i=await r.json());const o=document.getElementById("printerStatus-"+e._id);o&&("No Status"===i?o.style.color="black":i[Object.keys(i)[0]]?o.style.color="green":o.style.color="red")}catch(e){console.log("Printer Power Check failed... classing offline:",e)}}}let P=[];const C=function(e){const t=_.findIndex(P,(function(t){return t._id==e}));x.file(P[t],P[t].currentJob.filePath,"load")},k=function(e){const t=_.findIndex(P,(function(t){return t._id==e}));x.file(P[t],P[t].currentJob.filePath,"print")};document.querySelectorAll("[id^='currentHarvest-']").forEach((e=>{e.addEventListener("click",(t=>{const n=e.id.split("-");C(n[1])}))})),document.querySelectorAll("[id^='restartCurrentPrint-']").forEach((e=>{e.addEventListener("click",(t=>{const n=e.id.split("-");k(n[1])}))}));const M=document.getElementById("currentOperationsSort");M&&I.getCurrentOpState().then((e=>{const{currentIterie:t,currentOrder:n}=e;"progress"===t&&"desc"===n&&(M.innerHTML=document.getElementById("ci-progress-down").innerHTML),"progress"===t&&"asc"===n&&(M.innerHTML=document.getElementById("ci-progress-up").innerHTML),"timeRemaining"===t&&"desc"===n&&(M.innerHTML=document.getElementById("ci-time-down").innerHTML),"timeRemaining"===t&&"asc"===n&&(M.innerHTML=document.getElementById("ci-time-up").innerHTML),"fileName"===t&&"desc"===n&&(M.innerHTML=document.getElementById("ci-file-down").innerHTML),"fileName"===t&&"asc"===n&&(M.innerHTML=document.getElementById("ci-file-up").innerHTML),"sortIndex"===t&&"desc"===n&&(M.innerHTML=document.getElementById("ci-index-down").innerHTML),"sortIndex"===t&&"asc"===n&&(M.innerHTML=document.getElementById("ci-index-up").innerHTML),document.getElementById("ci-progress-up").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-progress-up").innerHTML,await I.updateCurrentOpState({iterie:"progress",order:"asc"})})),document.getElementById("ci-progress-down").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-progress-down").innerHTML,await I.updateCurrentOpState({iterie:"progress",order:"desc"})})),document.getElementById("ci-time-up").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-time-up").innerHTML,await I.updateCurrentOpState({iterie:"timeRemaining",order:"asc"})})),document.getElementById("ci-time-down").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-time-down").innerHTML,await I.updateCurrentOpState({iterie:"timeRemaining",order:"desc"})})),document.getElementById("ci-file-up").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-file-up").innerHTML,await I.updateCurrentOpState({iterie:"fileName",order:"asc"})})),document.getElementById("ci-file-down").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-file-down").innerHTML,await I.updateCurrentOpState({iterie:"fileName",order:"desc"})})),document.getElementById("ci-index-up").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-index-up").innerHTML,await I.updateCurrentOpState({iterie:"sortIndex",order:"asc"})})),document.getElementById("ci-index-down").addEventListener("click",(async()=>{M.innerHTML=document.getElementById("ci-index-down").innerHTML,await I.updateCurrentOpState({iterie:"sortIndex",order:"desc"})}))})).catch((e=>{}));class A{static saveSort(e,t){localStorage.setItem("fileSort",JSON.stringify({meta:e,reverse:t}))}static async loadSort(e,t){const n=await I.getPrinter(e),r=JSON.parse(localStorage.getItem("fileSort"));if(null!==r){const e=r.reverse;"file"===r.meta&&(void 0!==t?this.sortFileName(n,e,t):this.sortFileName(n,e)),"date"===r.meta&&(void 0!==t?this.sortUploadDate(n,e,t):this.sortUploadDate(n,e)),"time"===r.meta&&(void 0!==t?this.sortPrintTime(n,e,t):this.sortPrintTime(n,e))}else this.sortUploadDate(n,!0);this.setListeners(n)}static setListeners(e){const t=document.getElementById("sortFileNameUp"),n=document.getElementById("sortFileNameDown"),r=document.getElementById("sortPrintTimeUp"),i=document.getElementById("sortPrintTimeDown"),o=document.getElementById("sortDateUp"),a=document.getElementById("sortDateDown");t&&t.addEventListener("click",(t=>{this.sortFileName(e,!0)})),n&&n.addEventListener("click",(t=>{this.sortFileName(e)})),r&&r.addEventListener("click",(t=>{this.sortPrintTime(e,!0)})),i&&i.addEventListener("click",(t=>{this.sortPrintTime(e)})),o&&o.addEventListener("click",(t=>{this.sortUploadDate(e)})),a&&a.addEventListener("click",(t=>{this.sortUploadDate(e,!0)}))}static sortFileName(e,t,n){const r=document.getElementById("fileSortDropdownMenu");r&&(e.fileList.fileList=_.sortBy(e.fileList.fileList,[function(e){return e.display}]),e.fileList.folderList=_.sortBy(e.fileList.folderList,[function(e){return e.name}]),t?(e.fileList.fileList=e.fileList.fileList.reverse(),e.fileList.folderList=e.fileList.folderList.reverse(),r.innerHTML='<i class="fas fa-sort-alpha-up"></i> File Name',this.saveSort("file",!0)):(r.innerHTML='<i class="fas fa-sort-alpha-down"></i> File Name',this.saveSort("file",!1)),z.drawFiles(e,!0))}static sortUploadDate(e,t,n){const r=document.getElementById("fileSortDropdownMenu");r&&(e.fileList.fileList=_.sortBy(e.fileList.fileList,[function(e){return e.uploadDate}]),e.fileList.folderList=_.sortBy(e.fileList.folderList,[function(e){return e.name}]),t?(e.fileList.fileList=e.fileList.fileList.reverse(),e.fileList.folderList=e.fileList.folderList.reverse(),r.innerHTML='<i class="fas fa-sort-numeric-down"></i> Upload Date',this.saveSort("date",!0)):(r.innerHTML='<i class="fas fa-sort-numeric-up"></i> Upload Date',this.saveSort("date",!1)),z.drawFiles(e,n))}static sortPrintTime(e,t,n){const r=document.getElementById("fileSortDropdownMenu");r&&(e.fileList.fileList=_.sortBy(e.fileList.fileList,[function(e){return e.expectedPrintTime}]),e.fileList.folderList=_.sortBy(e.fileList.folderList,[function(e){return e.name}]),t?(e.fileList.fileList=e.fileList.fileList.reverse(),e.fileList.folderList=e.fileList.folderList.reverse(),r.innerHTML='<i class="fas fa-sort-numeric-up"></i> Print Time',this.saveSort("time",!1)):(r.innerHTML='<i class="fas fa-sort-numeric-down"></i> Print Time',this.saveSort("time",!0)),z.drawFiles(e,n))}}class O{static getSelectableList(e){return`\n<tr id="${e.id}" class="${e.state}" data-jplist-item>\n    <td>\n        <div class="custom-control custom-checkbox">\n            <input type="checkbox" class="custom-control-input Idle" id="checkBox-${e.id}" value="${e.id}">\n            <label class="custom-control-label" for="checkBox-${e.id}">\n            </label>\n        </div>\n    </td>\n    <th scope="row">${e.index}</th>\n    <td>${e.name}</td>\n    <td class="${e.state}">${e.state}</td>\n    <td class="g-${e.group.replace(/[^\w\s]/gi,"-").toLowerCase()}">${e.group}</td>\n    <td>${e.spool}</td>\n</tr>\n`}static getEditableList(e){return`\n<tr id="editPrinterCard-${e.id}" class="${e.state}" data-jplist-item>\n  <th scope="row">${e.index}</th>\n  <td><input id="editInputName-${e.id}" type="text" class="form-control Idle" placeholder="${e.name}" aria-label="Username" aria-describedby="basic-addon1"></td>\n                          <td><input id="editInputURL-${e.id}" type="text" class="form-control Idle" placeholder="${e.printerURL}" aria-label="Username" aria-describedby="basic-addon1"></td>\n                          <td class="${e.state} d-none">${e.state}</td>\n                          <td><input id="editInputGroup-${e.id}" type="text" class="form-control Idle" placeholder="${e.group}" aria-label="Username" aria-describedby="basic-addon1"></td>\n                          <td class="${e.group.replace(/[^\w\-]+/g,"-").toLowerCase()}"><input id="editInputCamera-${e.id}" type="text" class="form-control Idle" placeholder="${e.cameraURL}" aria-label="Username" aria-describedby="basic-addon1"></td>\n                          <td><input id="editInputApikey-${e.id}" type="text" class="form-control Idle" placeholder="${e.apikey}" aria-label="Username" aria-describedby="basic-addon1"></td>\n    </tr>`}static isOffline(e,t,n){return!!t||!!n||"Offline"!==e}static async create(e,t,n,r){let i=document.getElementById("saveEditsBtn");i&&i.remove(),n&&(document.getElementById("printerSelectTitle").innerHTML=n),e.innerHTML="",e.innerHTML='\n<div class="row">\n    <div class="col-lg-12">\n      <div class="pb-2" id="selectMessageBox"></div>\n    </div>\n    <div class="col-md-3">\n      <div class="input-group mb-3">\n        <div class="input-group-prepend">\n            <label class="input-group-text" for="printerStateList">State: </label>\n        </div>\n        <select class="custom-select" id="printerStateList" data-jplist-control="select-filter" data-group="printer-list" data-name="state">\n          <option selected href="#" data-value="all"data-path="default">\n            Filter\n          </option>\n          <option href="#" value="active" data-path=".Active">\n            Active\n          </option>\n          <option href="#" value="idle" data-path=".Idle">\n            Idle\n          </option>\n          <option href="#" value="complete" data-path=".Complete">\n            Complete\n          </option>\n          <option href="#" value="disconnected" data-path=".Disconnected">\n            Disconnected\n          </option>\n        </select>\n      </div>\n    </div>\n    <div class="col-md-3">\n     <div class="input-group mb-3">\n        <div class="input-group-prepend">\n            <label class="input-group-text" for="printerGroupList">Group: </label>\n        </div>\n        <select class="custom-select" id="printerGroupList"\n                data-jplist-control="select-filter"\n                data-group="printer-list"\n                data-name="group">\n\x3c!--                            Filled dynamically --\x3e\n        </select>\n      </div>\n    </div>\n    <div id="selectBtns" class="col-md-3 text-center">\n    </div>\n    <div id="actionBtn" class="col-md-3  text-center">\n    </div>\n</div>\n<table class="table table-dark">\n  <thead>\n    <tr>\n      <th id="selectColumn" scope="col">Select</th>\n      <th scope="col">Index</th>\n      <th scope="col">Name</th>\n      <th scope="col" id="urlColumn" class="d-none">Printer URL</th>\n      <th id="stateColumn" scope="col">State</th>\n      <th scope="col">Group</th>\n      <th id="spoolColumn" scope="col">Spool</th>\n      <th id="cameraColumn" scope="col" class="d-none">Camera URL</th>\n      <th id="apiColumn" scope="col" class="d-none">API KEY</th>\n    </tr>\n  </thead>\n  <tbody id="printerSelectBody" data-jplist-group="printer-list">\n\x3c!-- Filled dynamically --\x3e\n  </tbody>\n</table>\n';let o=document.getElementById("selectMessageBox");o.innerHTML="";let a=!1;"Printer Deletion"===n?(a=!0,o.innerHTML='\n<div class="alert alert-info" role="alert">\nSelect which printers you\'d like to delete. Press action when you have selected all the printers you\'d like to remove.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n This is unrecoverable! If you remove the database entry for your printer, any links in the database will be lost... i.e. History/Statistics. Unless you have a backup in place.\n</div>\n'):"Edit Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\nUpdate any of the printer values below and press action when you\'ve made your changes.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\n OctoFarm will then update only the changed printers.\n</div>\n':"Disconnect Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\nPlease select which printers you\'d like to disconnect from OctoPrint.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\nThis will by default skip Active printers. This is not an emergency stop button!\n</div>\n\n':"Connect Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\nPlease select which printers you\'d like to connect to from OctoPrint. Selected printers will attempt a connection with the preferred port settings from OctoPrint.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\nThis can be updated in your printer settings on OctoFarm/OctoPrint. You will need to re-scan for OctoFarm to detect the changes if updated on OctoPrint.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n If this doesn\'t exist the connection attempt will fall back to AUTO and could fail/put your printer in an error state. \n</div>\n':"Install Plugins"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\nPlease select which printers you\'d like to action a plugin installation on... You will be able to choose multiple plugins on the next pop up.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\n  Your plugin installation will be skipped if it\'s already installed...\n</div>\n':"Power On/Off Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\nPlease select your list of printers to action the power command on. You will be able to choose the actual command on the next pop up.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n  These commands will run without user interaction... It will skip by default any active printers.\n</div>\n':"Pre-Heat Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\n  Please select your list of printers to action the pre-heat command. You will configure the temperatures on the next pop up.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n  Due to this allowing for temps to be actioned on the fly it will not check printer state before doing so.\n</div>\n':"Control Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\n  Please select your list of printers you\'d like to bulk control.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n  Due to this allowing for temps to be actioned on the fly it will not check printer state before doing so.\n</div>\n':"Send Gcode to Printers"===n?o.innerHTML='\n<div class="alert alert-info text-dark" role="alert">\n  Please select your list of printers you\'d like to send gcode commands to.\n</div>\n<div class="alert alert-info text-dark" role="alert">\n  Commands split up by a new line will be sent sequentially to the terminal.\n</div>\n<div class="alert alert-danger text-dark" role="alert">\n  Due to this allowing for gcode commands to be sent on the fly it will not check printer state before doing so.\n</div>\n':"Start a Bulk Print"===n?o.innerHTML='\n  <div class="alert alert-info" role="alert">\n    Please select which printers you\'d like to start printing on! Press action when you have selected all the printers you\'d like.\n  </div>\n  <div class="alert alert-info" role="alert">\n    <p class="mb-0"><strong>Single-File Mode:</strong> This will distribute 1 file across all selected printers and action a print.</p>\n    <hr>\n    <p class="mb-0"><strong>Multi-File Mode:</strong> This will distribute the first file to the first selected printer, the second file goes to the second selected printer and so on.</p>\n  </div>\n  <div class="alert alert-warning text-dark" role="alert">\n    <strong>NOTE: </strong> Multi-File mode expects and equal number of printers and files... \n  </div>\n':"Disable Printers"===n?o.innerHTML='\n<div class="alert alert-info" role="alert">\n  Please select the list of printers you\'d like to disable.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\n  A disabled printer will not make any connection attempts until re-enabled. You will not see it in the UI and it will not effect any stats like Offline printer count.\n</div>\n':"Enable Printers"===n&&(o.innerHTML='\n<div class="alert alert-info" role="alert">\n  Please select the list of printers you\'d like to enable.\n</div>\n<div class="alert alert-warning text-dark" role="alert">\n    Enabling a printer will restore it to it\'s previous functionality.\n</div>\n');const s=[],l=[];let c=!1;"Enable Printers"===n&&(c=!0);const u=await I.listPrinters(c);u.forEach((e=>{if(void 0!==e.printerState&&this.isOffline(e.printerState.colour.category,t,a)){let t="";e.selectedFilament&&0!==e.selectedFilament.length?e.selectedFilament.forEach(((e,n)=>{t+=null!==e?`Tool ${n}: ${e.spools.name} - ${e.spools.material} <br>`:`Tool ${n}: No Spool Selected <br>`})):t="No Spool Selected";const n={id:e._id,index:e.sortIndex,name:e.printerName,printerURL:e.printerURL,state:e.printerState.colour.category,group:e.group,spool:t,cameraURL:e.camURL,apikey:e.apikey};l.push(n)}if(""!==e.group){const t={display:e.group,tag:e.group.replace(/[^\w\s]/gi,"-").toLowerCase()};s.push(t)}}));const d=_.uniqBy(s,(function(e){return e.tag}));if(0!==l.length){const e=document.getElementById("printerSelectBody");t?(document.getElementById("spoolColumn").classList.add("d-none"),document.getElementById("stateColumn").classList.add("d-none"),document.getElementById("cameraColumn").classList.remove("d-none"),document.getElementById("apiColumn").classList.remove("d-none"),document.getElementById("selectColumn").classList.add("d-none"),document.getElementById("urlColumn").classList.remove("d-none"),l.forEach((t=>{e.insertAdjacentHTML("beforeend",this.getEditableList(t))}))):l.forEach((t=>{e.insertAdjacentHTML("beforeend",this.getSelectableList(t))}));const n=document.getElementById("printerGroupList");n.innerHTML="",n.insertAdjacentHTML("beforeend",'<option selected value="all" data-path="default">Filter</option>'),d.forEach(((e,t)=>{n.insertAdjacentHTML("beforeend",`<option value="${e.tag}" data-path=".g-${e.tag}">${e.display}</option>`)})),u.forEach((e=>{const t=document.getElementById(`editInputGroup-${e._id}`);t&&d.forEach(((e,n)=>{t.insertAdjacentHTML("beforeend",`<option value="${e.tag}" data-path=".g-${e.tag}">${e.display}</option>`)}))}))}else document.getElementById("printerSelectBody").insertAdjacentHTML("beforeend","<tr><td>No Online Printers</td></tr>");O.addListeners(t,r)}static addListeners(e,t){e?d.addSelectListeners("editInput"):(document.getElementById("selectBtns").innerHTML='\n                    <button id="selectAll" type="button" class="btn btn-secondary"><i class="fas fa-check-square"></i> Select All</button>\n                    <button id="selectNone" type="button" class="btn btn-secondary"><i class="fas fa-square"></i> Deselect All</button>\n            ',document.getElementById("selectAll").addEventListener("click",(e=>{document.querySelectorAll('input[type="checkbox"]:not(:checked)').forEach((e=>{e.checked=!0}))})),document.getElementById("selectNone").addEventListener("click",(e=>{document.querySelectorAll('input[type="checkbox"]:checked').forEach((e=>{e.checked=!1}))}))),t&&(document.getElementById("actionBtn").insertAdjacentHTML("beforeend",'\n                      <button id="saveEditsBtn" class="btn btn-success" data-dismiss="modal" aria-label="Close">Action</button>\n      '),document.getElementById("saveEditsBtn").addEventListener("click",t)),jplist.init()}static getSelected(){const e=document.querySelectorAll('input[type="checkbox"]:checked'),t=[];return e.forEach((e=>{e.id.includes("checkBox")&&t.push(e)})),t}static selectFilter(){}}const H={MESSAGE:document.getElementById("bulkActionInfoMessage"),PROGRESS_BAR:document.getElementById("bulkActionProgressBar"),TABLE:document.getElementById("bulkActionResultsTable"),COMPLETE_COUNT:document.getElementById("bulkActionCompleteCount"),SKIPPED_COUNT:document.getElementById("bulkActionSkipped"),ERROR_COUNT:document.getElementById("bulkActionError"),WARNING_COUNT:document.getElementById("bulkActionWarning")},R='<i class="fas fa-forward text-warning"></i>',F='<i class="fas fa-exclamation-triangle text-warning"></i>',N='<i class="fas fa-times text-danger"></i>',D='<i class="fas fa-check text-success"></i>';function j(e,t,n,r){const i=document.getElementById("result-"+e),o=document.getElementById("message-"+e);"skipped"===t?(i.innerHTML.includes("fa-spin")?i.innerHTML=R:i.innerHTML=i.innerHTML+"<br>"+R,H.SKIPPED_COUNT.innerHTML=parseInt(H.SKIPPED_COUNT.innerHTML)+1):"danger"===t?(i.innerHTML.includes("fa-spin")?i.innerHTML=N:i.innerHTML=i.innerHTML+"<br>"+N,H.ERROR_COUNT.innerHTML=parseInt(H.ERROR_COUNT.innerHTML)+1):"success"===t?(i.innerHTML.includes("fa-spin")?i.innerHTML=D:i.innerHTML=i.innerHTML+"<br>"+D,H.COMPLETE_COUNT.innerHTML=parseInt(H.COMPLETE_COUNT.innerHTML)+1):"warning"===t&&(i.innerHTML.includes("fa-spin")?i.innerHTML=F:i.innerHTML=i.innerHTML+"<br>"+F,H.WARNING_COUNT.innerHTML=parseInt(H.WARNING_COUNT.innerHTML)+1),0!==o.innerHTML.length?o.innerHTML=r?o.innerHTML+n:o.innerHTML+"<br>"+n:o.innerHTML=n}function U(e,t){e<t&&(H.PROGRESS_BAR.classList="progress-bar bg-warning"),e===t&&(H.MESSAGE.innerHTML='<i class="fas fa-info"></i> Actions complete! You may check the results below.',H.PROGRESS_BAR.classList="progress-bar bg-success",H.MESSAGE.classList="alert alert-success text-dark");const n=b.getPercentage(e,t);H.PROGRESS_BAR.style.width=n+"%",H.PROGRESS_BAR.innerHTML=n+"%"}const W=".gcode,.gco,.g,.ctb,.fdg,.nc,.gc,.stl",q=new class{constructor(){this.data=[]}add(e){e.active=!1,this.data.push(e)}remove(){this.data.shift()}first(){return this.data[0]}activate(e){this.data[e].active=!0}size(){return this.data.length}all(){let e=[];return this.data.forEach(((t,n)=>{e.push(this.data[n])})),e}};setInterval((async()=>{if(q.size()>0){const e=q.first();if(!e.active){q.activate(0);const t=new Date;let n=await e.upload(e);n=JSON.parse(n),n.index=e.index,n.uploadDate=t.getTime()/1e3,q.remove(),await I.post("printers/newFiles",n),await A.loadSort(e.index);const r=document.getElementById("uploadsRemaining");r&&(r.innerHTML=`${q.size()}`);const i=document.getElementById(`fileCounts-${e.index}`);i&&"1"===i.innerHTML&&(i.innerHTML="0"),r&&"1"===r.innerHTML&&(r.innerHTML="0")}}const e=q.all();e.forEach((t=>{const n=e.reduce((function(e,n){return e+(n.index==t.index)}),0),r=document.getElementById(`fileCounts-${t.index}`);r&&(r.innerHTML=` ${n}`)}))}),1e3);class z{static async handleFiles(e,t,n){e=[...e];for(let r=0;r<e.length;r++){const i={},o=document.getElementById("fileUploadCountSpinner");o&&(o.classList.contains("fa-spin")||(o.classList="fas fa-spinner fa-spin"));const a=document.getElementById("uploadsSpinnerIcon");a&&(a.innerHTML="<i class='fas fa-spinner fa-spin'></i>"),i.file=e[r],void 0!==n&&(i.print=!0),i.index=t._id,i.printerInfo=t;const s=document.getElementById("currentFolder");i.currentFolder=s?s.innerHTML:"local/",i.upload=z.fileUpload,q.add(i)}}static createUpload(e,t,n,r){const i=q.size(),o=document.getElementById("uploadsSpinnerIcon"),a=document.getElementById("uploadsRemaining");a&&(a.innerHTML=`${i}`),o&&(o.innerHTML="<i class='fas fa-spinner fa-spin'></i>",isNaN(n/r*100)&&(o.innerHTML="<i class='fas fa-spinner'></i>"));const s=document.getElementById("fileUploadCount");if(s&&(s.innerHTML=`File Queue: ${i}`,i<1)){s.innerHTML="File Queue: 0";const e=document.getElementById("fileUploadCountSpinner");e.classList.contains("fa-spin")&&(e.classList="fas fa-spinner")}const l=document.getElementById("uploadCurrentProgress");if(l){l.classList="progress-bar progress-bar-striped bg-warning";let e=n/r*100;isNaN(e)&&(e=0),l.innerHTML=`${Math.floor(e)}%`,l.style.width=`${e}%`,100===e&&(l.classList="progress-bar progress-bar-striped bg-success")}const c=document.getElementById(`fileProgress-${e}`);if(c){c.classList="progress-bar progress-bar-striped bg-warning";let e=n/r*100;isNaN(e)&&(e=0),c.innerHTML=`${Math.floor(e)}%`,c.style.width=`${e}%`,100===e&&(c.classList="progress-bar progress-bar-striped bg-success")}const u=document.getElementById("filesViewProgressWrapper-"+e);if(u){u.classList.contains("d-none")&&u.classList.remove("d-none");const t=document.getElementById("filesViewProgressBar-"+e);t.classList="progress-bar progress-bar-striped bg-warning";let i=n/r*100;isNaN(i)&&(i=0),t.innerHTML=`${Math.floor(i)}%`,t.style.width=`${i}%`,100===i&&(u.classList.contains("d-none")||u.classList.add("d-none"))}}static fileUpload(e){return new Promise((function(t,n){z.removeNoFiles();const{currentFolder:r}=e,{index:i}=e,{printerInfo:o}=e,a=new FormData;let s="";r.includes("local/")&&(s=r.replace("local/","")),a.append("file",e.file),a.append("path",s),e.print&&a.append("print",!0);const l=`${o.printerURL}/api/files/local`,c=new XMLHttpRequest;e=e.file;const u=document.getElementById("uploadsPrinterName"),p=document.getElementById("uploadsFileName");u&&(u.innerHTML=o.printerName),p&&(p.innerHTML=e.name),c.open("POST",l),c.upload.onprogress=function(t){t.lengthComputable&&z.createUpload(o._id,e.name,t.loaded,t.total)},c.setRequestHeader("X-Api-Key",o.apikey),c.onloadstart=function(t){z.createUpload(o._id,e.name,t.loaded,t.total)},c.onloadend=async function(n){z.createUpload(o._id,e.name,n.loaded,n.total),this.status>=200&&this.status<300?(t(c.response),d.createAlert("success",`${e.name} has finished uploading to Printer: ${o.printerName}`,3e3,"clicked"),document.getElementById("uploadsSpinnerIcon").innerHTML="<i class='fas fa-spinner'></i>"):(q.remove(),t(c.response),d.createAlert("error",`Sorry but ${e.name} could not be uploaded... is CORS enabled and OctoPrint online?`,3e3,"clicked"))},c.onerror=function(){t(c.response),d.createAlert("error",`Sorry but ${e.name} could not be uploaded... is CORS enabled and OctoPrint online?`,3e3,""),q.remove()},W.split(",").some((t=>e.name.includes(t)))?c.send(a):d.createAlert("error",`Sorry but ${e.name} is not a gcode file, could not be uploading.`,3e3,"")}))}static async actionBtnGate(e,t){const n=t.split("*"),r=n[1],i=n[2];"fileActionStart"===r?await J.startPrint(e,i):"fileActionSelect"===r?await J.selectFile(e,i):"fileActionUpdate"===r?await J.updateFile(e,t,i):"fileActionMove"===r?await J.moveFile(e,i):"fileActionDownload"===r||("fileActionDelete"===r?await J.deleteFile(e,i):"folderActionMove"===r?await J.moveFolder(e,i):"folderActionDelete"===r&&await J.deleteFolder(e,i))}static async reSyncFiles(e,t){e.target.innerHTML="<i class='fas fa-sync fa-spin'></i> Re-Syncing...";const n=await I.post("printers/resyncFile",{i:t._id});e.target.classList="btn btn-success mb-0",e.target.innerHTML="<i class='fas fa-sync'></i> Re-Sync",setTimeout((function(){e.target.classList="btn btn-success mb-0",e.target.innerHTML="<i class='fas fa-sync'></i> Re-Sync"}),500),t.fileList=n,await A.loadSort(t._id)}static async openFolder(e,t,n){const r=document.getElementById("fileBackBtn");if(void 0===t||"button"!==t.type){if(void 0!==e)e=e.replace("file-",""),document.getElementById("currentFolder").innerHTML=`local/${e}`,r.disabled=!1;else{const e=document.getElementById("currentFolder").innerHTML;if("local"!==e){const t=e.substring(0,e.lastIndexOf("/"));document.getElementById("currentFolder").innerHTML=t,r.disabled="local"===t}else r.disabled=!0}await A.loadSort(n._id)}else await A.loadSort(n._id)}static async refreshFiles(e,t){if(q.size()<=1)for(let n=0;n<e.fileList.fileList.length;n++){const r=e.fileList.fileList[n];let i=document.getElementById("currentFolder")?.innerHTML;if(i&&(i.includes("local/")&&(i=i.replace("local/","")),r.path===i&&document.getElementById(`file-${r.fullPath}`))){let n="";r.toolUnits?.length&&r.toolUnits.forEach(((e,t)=>{n+=`<i class="fas fa-weight"></i> ${e} / <i class="fas fa-dollar-sign"></i> Cost: ${r.toolCosts[t]}<br>`}));let i='<center><i class="fas fa-file-code fa-2x"></i></center>';r.thumbnail&&(i=`<center><img src='${e.printerURL}/${r.thumbnail}' width="100%"></center>`);let o=new Date(1e3*r.uploadDate);const a=o.toDateString(),s=o.toTimeString().substring(0,8);o=`${a} ${s}`,document.getElementById("fileHistoryRate-"+r.fullPath).innerHTML=t+'<i class="fas fa-thumbs-up"></i> 0 / <i class="fas fa-thumbs-down"></i> 0',document.getElementById(`fileDate-${r.fullPath}`).innerHTML=` ${o}`,document.getElementById(`fileSize-${r.fullPath}`).innerHTML=` ${b.bytes(r.fileSize)}`,document.getElementById(`fileTool-${r.fullPath}`).innerHTML=` ${n}`,document.getElementById(`fileTime-${r.fullPath}`).innerHTML=` ${b.generateTime(r.expectedPrintTime)}`,document.getElementById(`fileCost-${r.fullPath}`).innerHTML=` Print Cost: ${r.printCost?.toFixed(2)}`,document.getElementById(`fileThumbnail-${r.fullPath}`).innerHTML=` ${i}`,document.getElementById(`fileDateClean-${r.fullPath}`).innerHTML=r.uploadDate}}}static removeNoFiles(){const e=document.getElementById("noFilesToBeShown");e&&e.remove()}static drawFiles(e,t){try{const n=document.getElementById(`fileList-${e._id}`);if(n){const{fileList:r}=e;n.innerHTML="";let i=document.getElementById("currentFolder").innerHTML;i.includes("local/")&&(i=i.replace("local/","")),r.folderList.length>0&&r.folderList.forEach((t=>{t.path==i&&n.insertAdjacentHTML("beforeend",`<a\n              id="file-${t.name}"\n              href="#"\n              class="list-group-item list-group-item-action flex-column align-items-start bg-dark folderAction"\n              style="display: block;\n                padding: 0.7rem 0.1rem;"\n            >\n              <div class="row">\n                <div\n                  class="col-lg-1"\n                  style="display:flex; justify-content:center; align-items:center;"\n                >\n                  <center><i class="fas fa-folder fa-2x"></i></center>\n                </div>\n                <div class="col-lg-11">\n                  <small class="float-right"\n                    >\x3c!--Display file and folder count here eventually--\x3e</small\n                  >\n                  <div class="d-flex w-100 justify-content-between">\n                    <h5 class="mb-1 float-left">\n                      ${t.display.replace(/_/g," ")}\n                    </h5>\n                    <div\n                      class="float-right btn-group flex-wrap btn-group-sm"\n                      role="group"\n                      aria-label="Basic example"\n                    >\n                      <button id="${e._id}*folderActionMove*${t.name}" type="button" class="btn btn-warning">\n                        <i class="fas fa-people-carry"></i> Move\n                      </button>\n                      <button id="${e._id}*folderActionDelete*${t.name}" type="button" class="btn btn-danger">\n                        <i class="fas fa-trash-alt"></i> Delete\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </a>\n            `)}));const o=document.getElementById("printerFileCount");o&&(o.innerHTML=`<i class="fas fa-file"></i> ${e.fileList.fileList.length} <i class="fas fa-folder"></i> ${e.fileList.folderList.length}`);const a=document.getElementById("fileManagerFileCount-"+e._id);a&&(a.innerHTML=`Files: ${e.fileList.fileList.length}`);const s=document.getElementById("fileManagerFolderCount-"+e._id);s&&(s.innerHTML=`Folders: ${e.fileList.folderList.length}`);const l=r.fileList.filter((e=>void 0!==t||e.path===i));l.length>0?l.forEach((t=>{let r="";t.toolUnits.forEach(((e,n)=>{r+=`<i class="fas fa-weight"></i> ${e} / <i class="fas fa-dollar-sign"></i> Cost: ${t.toolCosts[n]}<br>`}));let i='<center><i class="fas fa-file-code fa-2x"></i></center>';void 0!==t.thumbnail&&null!==t.thumbnail&&(i=`<center><img src='${e.printerURL}/${t.thumbnail}' width="100%"></center>`);let o=new Date(1e3*t.uploadDate);const a=o.toDateString(),s=o.toTimeString().substring(0,8);let l="bg-secondary";!0===t.last?l="bg-dark-success":!1===t.last&&(l="bg-dark-failed"),o=`${a} ${s}`;const c=` <div\n            id="file-${t.fullPath}"\n            href="#"\n          class="list-group-item list-group-item-action flex-column align-items-start ${l}"\n            style="display: block;\n            padding: 0.7rem 0.1rem;"\n            >\n            <div class="row">\n                <div\n                            id="fileThumbnail-${t.fullPath}"\n          class="col-lg-2"\n            style="display:flex; justify-content:center; align-items:center;"\n                >\n                ${i}\n                </div>\n                <div class="col-lg-10">\n                <div class="row">\n                <div class="col-12">\n                <h5 class="mb-1 name">${t.display}</h5>         \n                <small class="mb-1 name">${t.fullPath}</small>         \n                </div>\n                </div>\n                <div class="row">\n                <div class="col-12">\n                <p class="mb-1 float-right">\n                <span title="File specific success / failure rate from OctoPrint" id="fileHistoryRate-${t.fullPath}"><i class="fas fa-thumbs-up"></i> ${t.success} / <i class="fas fa-thumbs-down"></i> ${t.failed}</span><br>\n                <i class="fas fa-stopwatch"></i> \n                <span class="time" id="fileTime-${t.fullPath}">\n                    ${b.generateTime(t.expectedPrintTime)}</span> <br> \n                <i class="fas fa-dollar-sign"></i> \n                <span title="Expected Printer Cost" class="cost" id="fileCost-${t.fullPath}"> Print Cost: ${t.printCost?.toFixed(2)} </span>    <br> \n            <span title="Expected Filament Cost"> </span>\n\n                </p>\n                <p class="mb-1 float-left">\n                <i class="fas fa-clock"></i><span id="fileDateClean-${t.fullPath}" class="date d-none"> ${t.uploadDate}</span><span id="fileDate-${t.fullPath}"> ${o}</span><br>\n                <i class="fas fa-hdd"></i><span class="size" id="fileSize-${t.fullPath}"> ${b.bytes(t.fileSize)}</span> <br>\n            <span class="usage" title="Expected Filament Usage/Cost" id="fileTool-${t.fullPath}"> ${r} </span>\n\n                </p> \n                </div>\n                </div>\n                </div>\n                <div class="col-lg-12">\n                <div\n          class="d-flex btn-group flex-wrap btn-group-sm"\n            role="group"\n            aria-label="Basic example"\n                >\n                <button\n            title="Re-Sync File"\n            id="${e._id}*fileActionUpdate*${t.fullPath}"\n            role="button"\n          class="btn btn-dark"\n                >\n                <i class="fas fa-sync"></i> Re-Sync\n                </button>\n                <button           title="Start printing file"\n            id="${e._id}*fileActionStart*${t.fullPath}" type="button" class="btn btn-success">\n          <i class="fas fa-play"></i> Start\n              </button>\n              <button  title="Select file" id="${e._id}*fileActionSelect*${t.fullPath}" type="button" class="btn btn-info">\n        <i class="fas fa-file-upload"></i> Select\n            </button>\n            <button          title="Move file" id="${e._id}*fileActionMove*${t.fullPath}" type="button" class="btn btn-warning">\n      <i class="fas fa-people-carry"></i> Move\n          </button>\n          <button          title="Download file" onclick="window.open('${e.printerURL}/downloads/files/local/${t.fullPath}')" type="button" class="btn btn-dark">\n    <i class="fas fa-download"></i> Download\n        </button>\n        <button title="Delete file" id="${e.printerURL}*fileActionDelete*${t.fullPath}" type="button" class="btn btn-danger">\n  <i class="fas fa-trash-alt"></i> Delete\n      </button>\n      </div>\n      </div>\n      </div>\n      </div>\n      </div>`;n.insertAdjacentHTML("beforeend",c)})):n.insertAdjacentHTML("beforeend",'\n            <div\n            id="noFilesToBeShown"\n            href="#"\n          class="list-group-item list-group-item-action flex-column align-items-start bg-secondary"\n            style="display: block;\n            padding: 0.7rem 0.1rem;"\n            >\n            <div class="row">\n                <div class="col-lg-12">\n                <div class="row">\n                <div class="col-12">\n                <h5 class="mb-1 name">No files available...</h5>         \n                </div>\n                </div>\n      </div>\n      </div>\n      </div>\n            \n            '),z.updateListeners(e)}}catch(e){console.log(e)}}static async search(e){await J.search(e)}static async createFolder(e){await J.createFolder(e)}static updateListeners(e){!function(e,t){const n=document.getElementById(e.id);["dragenter","dragover","dragleave","drop"].forEach((e=>{n.addEventListener(e,Y,!1),document.body.addEventListener(e,Y,!1)})),["dragenter","dragover"].forEach((t=>{n.addEventListener(t,(t=>{V=!0,K(0,e)}),!1)})),["dragleave","drop"].forEach((t=>{n.addEventListener(t,(t=>{V=!1,Z(0,e)}),!1)})),n.addEventListener("drop",(e=>{Q(e,t.filter((e=>!!e.isSelected)))}),!1)}(document.getElementById(`fileList-${e._id}`),e),document.querySelectorAll(".folderAction").forEach((t=>{t.addEventListener("click",(async n=>{const r=await I.getPrinter(e._id);await z.openFolder(t.id,n.target,r)}))})),document.querySelectorAll("[id*='*fileAction']").forEach((t=>{t.addEventListener("click",(async n=>{const r=await I.getPrinter(e._id);await z.actionBtnGate(r,t.id)}))})),document.querySelectorAll("[id*='*folderAction']").forEach((t=>{t.addEventListener("click",(async n=>{const r=await I.getPrinter(e._id);await z.actionBtnGate(r,t.id)}))}))}static async multiUpload(){let e=null,t="",n=!0,r=null;await O.create(document.getElementById("multiPrinterSection")),document.getElementById("multiFileSelectedNow").innerHTML="",document.getElementById("multiPrinterBtn").disabled=!1,document.getElementById("multiFolder").disabled=!0,document.getElementById("multiFile").disabled=!0,document.getElementById("multiPrinterSection").classList.remove("hidden"),document.getElementById("multiFolderSection").classList.add("hidden"),document.getElementById("multiFileSection").classList.add("hidden"),document.getElementById("multiUploadFooter").innerHTML='<button id="multiUpSubmitBtn" type="button" class="btn btn-warning float-right">Next</button>',document.getElementById("multiUpSubmitBtn").addEventListener("click",(i=>{e=O.getSelected(),e.length<2?d.createAlert("error",`Please select MORE than ${e.length} printer(s)!`,2e3,"clicked"):async function(){const i=document.getElementById("multi-UploadFolderSelect"),o=document.getElementById("multi-UploadNewFolderNew");o.classList.remove("is-invalid"),o.classList.remove("is-valid"),i.classList.remove("is-invalid"),i.classList.remove("is-valid"),o.value="",i.innerHTML="",(await I.getOctoPrintUniqueFolders()).forEach((e=>{i.insertAdjacentHTML("beforeend",`\n          <option value=${e}>${e}</option>\n        `)})),document.getElementById("multiPrinterBtn").disabled=!0,document.getElementById("multiFolder").disabled=!1,document.getElementById("multiPrinterSection").classList.add("hidden"),document.getElementById("multiFolderSection").classList.remove("hidden"),document.getElementById("multiSelectedPrinters2").innerHTML="",document.getElementById("multiFolder").disabled=!1,document.getElementById("multiFile").disabled=!0,document.getElementById("multiFolderSection").classList.remove("hidden"),document.getElementById("multiFileSection").classList.add("hidden"),document.getElementById("multiUploadFooter").innerHTML='<button id="multiUpSubmitBtn" type="button" class="btn btn-success float-right">Next</button>',document.getElementById("multiUpSubmitBtn").addEventListener("click",(async a=>{t=document.getElementById("multiNewFolder").value;let s=document.getElementById("multiNewFolderNew").value,l=await I.listPrinters();e.forEach(((t,n)=>{if(t){const r=_.findIndex(l,(function(e){return e._id==t.value.toString()})),i=l[r]._id,o=l[r].printerName;document.getElementById("multiSelectedPrinters2").insertAdjacentHTML("beforeend",`\n            <div class="card col-2 px-1 py-1">\n             <div class="card-header px-1 py-1">\n               <small>${o}</small> \n              </div>\n              <div class="card-body px-1 py-1" id="folderCheckBody-${i}">\n                <small><i class="fas fa-spinner fa-pulse"></i> Checking Folder Exists...</small>\n              </div>\n            </div>\n            `),e[n]={value:l[r]._id,printerInfo:l[r]}}})),""!==s&&("/"===s[0]&&s.replace("/",""),t=t+"/"+s),""===t&&(t="local"),"/"===t[0]&&(t=t.replace("/","")),new RegExp("\\/[a-zA-Z0-9_\\/-]*[^\\/]$").exec("/"+t.replace(/ /g,"_"))?(o.classList.remove("is-invalid"),o.classList.add("is-valid"),i.classList.remove("is-invalid"),i.classList.add("is-valid"),await async function(){for(let n=0;n<e.length;n++){const r=e[n].printerInfo;200===await x.checkFile(r,t)?(document.getElementById("folderCheckBody-"+r._id).innerHTML='<i class="fas fa-folder-plus text-success"></i> Folder exists!',e[n].folderExists=!0):(document.getElementById("folderCheckBody-"+r._id).innerHTML='<i class="fas fa-folder-minus text-warning"></i> Folder will be created!',e[n].folderExists=!1)}document.getElementById("multiFileUploadBtn").disabled=!1,document.getElementById("multiFileUploadBtnLabel").classList.remove("disabled")}(),await async function(){document.getElementById("multiSelectedFolder").innerHTML=t,document.getElementById("multiFolder").disabled=!0,document.getElementById("multiFile").disabled=!1,document.getElementById("multiFileSection").classList.remove("hidden"),document.getElementById("multiFolderSection").classList.add("hidden"),document.getElementById("multiUploadFooter").innerHTML='<button id="multiUpSubmitBtn" type="button" class="btn btn-success float-right" data-dismiss="modal">Start!</button>',document.getElementById("multiUpSubmitBtn").addEventListener("click",(i=>{!async function(){H.MESSAGE.innerHTML='<i class="fas fa-info"></i> Please wait whilst OctoFarm runs through your action!',$("#bulkActionProgressModal").modal("show"),U(0,e.length);const i=[];e.forEach((e=>{i.push(e.printerInfo)})),function(e){H.ERROR_COUNT.innerHTML=0,H.SKIPPED_COUNT.innerHTML=0,H.COMPLETE_COUNT.innerHTML=0,H.WARNING_COUNT.innerHTML=0,H.TABLE.innerHTML="",e.forEach(((e,t)=>{var n;e.index=t,H.TABLE.insertAdjacentHTML("beforeend",`\n    <tr>\n      <th scope="row">${(n=e).index}</th>\n      <td>${n.printerName}</td>\n      <td id="result-${n._id}"><i class="fas fa-circle-notch fa-spin text-warning"></i></td>\n      <td id="message-${n._id}"></td>\n    </tr>\n  `)})),$("#bulkActionProgressModal").modal("handleUpdate")}(i);for(let o=0;o<e.length;o++){const a=e[o];if(e[o].folderExists){const e={status:"skipped",message:"Folder exists, skipped!"};j(i[o]._id,e.status,e.message)}else{const e=await J.multiUploadCreateFolders(a.printerInfo,t);j(i[o]._id,e.status,e.message)}r.forEach((r=>{const s={},l=a.value;s.file=r,s.index=l,s.printerInfo=a.printerInfo,s.upload=z.fileUpload,s.currentFolder="local/"+t,n&&(s.print=!0),q.add(s);const c="success",u="Your file has been added to the upload queue";j(i[o]._id,c,u),U(o,e.length)}))}U(e.length,e.length)}()})),document.getElementById("printOnLoadBtn").addEventListener("click",(e=>{let t=null;t=e.target.checked;const r=document.getElementById("multiFileUploadBtn"),i=document.getElementById("multiFileUploadBtnLabel");t?(r.removeAttribute("multiple",""),r.setAttribute("single",""),i.innerHTML='<i class="fas fa-file-import"></i> Upload File',n=!0):(r.setAttribute("multiple",""),r.removeAttribute("single",""),i.innerHTML='<i class="fas fa-file-import"></i> Upload Files',n=!1)})),document.getElementById("multiFileUploadBtn").addEventListener("change",(function(){!function(e){e=[...e],r=e;const t=document.getElementById("multiFileSelectedNow");t.innerHTML="",r.forEach((e=>{t.insertAdjacentHTML("beforeend",`\n           <div class="card col-2 px-1 py-1">\n             <div class="card-header px-1 py-1">\n               <small>${e.name}</small> \n              </div>\n            </div>\n        `)}))}(this.files)}))}()):(i.classList.add("is-invalid"),o.classList.add("is-invalid"))}))}()}))}}class J{static async search(e){let t=await I.getPrinter(e);const n=document.getElementById(`fileList-${e}`);let r=document.getElementById("searchFiles").value.toUpperCase();if(r=r.replace(/ /g,"_"),""===r?(document.getElementById("currentFolder").value="local/",await A.loadSort(t._id)):(document.getElementById("currentFolder").value="local/",await A.loadSort(t._id,"recursive")),n){const e=n.querySelectorAll('*[id^="file-"]');for(let t=0;t<e.length;t++)e[t].id.replace("file-","").toUpperCase().indexOf(r)>-1?e[t].style.display="":e[t].style.display="none"}}static async createFolder(e){let t=document.getElementById("currentFolder").innerHTML;const n=new FormData;"local"===t?t="":t.includes("local/")&&(t=t.replace("local/","")),bootbox.prompt("What would you like to name your folder?",(async function(r){if(r){n.append("foldername",r),n.append("path",`${t}/`);const i=await x.folder(e,"local",n);if(201===i.status||200===i.status){const n={i:e._id,foldername:r,path:t};await I.post("printers/newFolder",n),await A.loadSort(e._id),d.createAlert("success","Successfully created your new folder...",3e3,"clicked")}else d.createAlert("error","Sorry your folder couldn't be saved...",3e3,"clicked")}}))}static async multiUploadCreateFolders(e,t){const n=t.split("/");for(let t=0;t<n.length;t++){const r=new FormData;let i;0===t?(i="",r.append("foldername",n[t]),r.append("path","")):(i=n[t-1],r.append("foldername",n[t]),r.append("path",n[t-1]));const o=await x.folder(e,"local",r);if(201===o.status){const r={i:e._id,foldername:n[t],path:i};return await I.post("printers/newFolder",r),await A.loadSort(o.files),{status:"success",message:"Successfully created your missing folder!"}}return{status:"danger",message:"Successfully created your missing folder!"}}}static grabUsage(e){if(void 0===e.length)return null===e.length||e.length.length,"No Length";const t={totalLength:[],totalGrams:[],usage:[]};return e.length.forEach((e=>{const n=parseFloat(1.75)/2,r=e/1e3*Math.PI*n*n*parseFloat(1.24);t.totalLength.push(e/1e3),t.totalGrams.push(r),t.usage.push(`${(e/1e3).toFixed(2)}m / ${r.toFixed(2)}g`)})),t.totalLength=t.totalLength.reduce(((e,t)=>e+t),0),t.totalGrams=t.totalGrams.reduce(((e,t)=>e+t),0),t}static async startPrint(e,t){await x.file(e,t,"load",!1);const n=await x.jobAction(e,{command:"start"});200===n?.status||201===n?.status?d.createAlert("success",`${e.printerName}: Successfully started printing ${t}`):409===n?.status?d.createAlert("warning",`${e.printerName}: Could not start file... ${t} OctoPrint reported a conflict!`):d.createAlert("danger",`${e.printerName}: Error occured starting: ${t} is your printer contactable?`)}static async selectFile(e,t){await x.file(e,t,"load",!0)}static async updateFile(e,t,n){const r=document.getElementById(t);r.innerHTML='<i class="fas fa-sync fa-spin"></i> Syncing...';const i=await I.post("printers/resyncFile",{i:e._id,fullPath:n});i&&await A.loadSort(e._id),r.innerHTML='<i class="fas fa-sync"></i> Re-Sync';const o=function(){r.classList="btn btn-dark"};i?(r.classList="btn btn-sm btn-success",setTimeout(o,500)):(r.classList="btn btn-sm btn-danger",setTimeout(o,500))}static moveFile(e,t){const n=[];n.push({text:"local",value:"/"}),e.fileList.folderList.forEach((e=>{const t={text:e.name,value:e.name};n.push(t)})),bootbox.prompt({title:"Where would you like to move the file?",inputType:"select",inputOptions:n,async callback(n){if(n){const r={command:"move",destination:n},i=await x.post(e,`files/local/${t}`,r);if(404===i.status)d.createAlert("error","We could not find the location, does it exist?",3e3,"clicked");else if(409===i.status)d.createAlert("error","There was a conflict, file already exists or is in use...",3e3,"clicked");else{const t=await i.json(),r={index:e._id,newPath:n,fileName:t.name,newFullPath:t.path};d.createAlert("warning","Moving file... please wait.",3e3,"clicked"),await I.post("printers/moveFile",r),await A.loadSort(e._id),setTimeout((function(){d.createAlert("success","Successfully moved your file...",3e3,"clicked")}),3e3)}}}})}static deleteFile(e,t){bootbox.confirm({message:`Are you sure you want to delete ${t}?`,buttons:{cancel:{label:'<i class="fa fa-times"></i> Cancel'},confirm:{label:'<i class="fa fa-check"></i> Confirm'}},async callback(n){if(n){await x.file(e,t,"delete");const n={i:e._id,fullPath:t};await I.post("printers/removefile",n),document.getElementById(`file-${t}`).remove()}}})}static deleteFolder(e,t){bootbox.confirm({message:`Are you sure you want to delete ${t}?`,buttons:{cancel:{label:'<i class="fa fa-times"></i> Cancel'},confirm:{label:'<i class="fa fa-check"></i> Confirm'}},async callback(n){const r={index:e._id,fullPath:t};n&&(await x.delete(e,`files/local/${t}`),await I.post("printers/removefolder",r),document.getElementById(`file-${t}`).remove())}})}static moveFolder(e,t){const n=[];n.push({text:"local",value:"/"}),e.fileList.folderList.forEach((e=>{const t={text:e.name,value:e.name};n.push(t)})),bootbox.prompt({title:"Where would you like to move the folder?",inputType:"select",inputOptions:n,async callback(n){if(n){const r={command:"move",destination:n},i=await x.post(e,`files/local/${t}`,r);if(404===i.status)d.createAlert("error","We could not find the location, does it exist?",3e3,"clicked");else if(409===i.status)d.createAlert("error","There was a conflict, file already exists or is in use...",3e3,"clicked");else{const r=await i.json(),o={index:e._id,oldFolder:t,newFullPath:n,folderName:r.path};d.createAlert("warning","Moving folder please wait...",3e3,"clicked"),await I.post("printers/moveFolder",o),await A.loadSort(e._id),d.createAlert("success","Successfully moved your file...",3e3,"clicked")}}}})}}r(3059);let V=!1;function G(e,t){const n=document.getElementById(e.id);["dragenter","dragover","dragleave","drop"].forEach((e=>{n.addEventListener(e,Y,!1),document.body.addEventListener(e,Y,!1)})),["dragenter","dragover"].forEach((t=>{n.addEventListener(t,(t=>{V=!0,K(0,e)}),!1)})),["dragleave","drop"].forEach((t=>{n.addEventListener(t,(t=>{V=!1,Z(0,e)}),!1)})),n.addEventListener("drop",(e=>{!function(e,t,n){const r=e.dataTransfer,{files:i}=r;ee(i,[t])}(e,t)}),!1)}function Y(e){e.preventDefault(),e.stopPropagation()}function K(e,t){t.classList.add("highlight")}function Z(e,t){t.classList.remove("highlight")}function Q(e,t,n){const r=e.dataTransfer,{files:i}=r;ee(i,t)}function X(e,t,n,r){d.createAlert("warning",`${class{static URL(e){let t;return t||(t=document.createElement("input"),t.setAttribute("type","url")),t.value=e,t.validity.valid}static IP(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}static JSON(e){return!!/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}static getName(e){return void 0!==e.settingsAppearance?""===e.settingsAppearance.name||null===e.settingsAppearance.name?e.printerURL:e.settingsAppearance.name:e.printerURL}static stripHTML(e){var t=document.createElement("DIV");t.innerHTML=e;var n=t.textContent||t.innerText||"";return n.replace("​",""),n.trim()}}.getName(r)}: started upload`,3e3,"Clicked"),t&&e?z.handleFiles(n,r,"print"):z.handleFiles(n,r)}function ee(e,t){t&&0!==t.length&&(1===e.length?bootbox.confirm({message:"Would you like to print upon upload?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback(n){t.forEach((t=>{X(!0,n,e,t)}))}}):t.forEach((t=>{X(!1,!1,e,t)})))}async function te(e){try{let t=await I.get("filament/get/dropDownList");return e?t.selected.historyDropDown:t.selected.normalDropDown}catch(e){console.error(e),d.createAlert("error","Issue contacting server, please check the logs...")}}async function ne(e,t,n){if(e.innerHTML="",(await te()).forEach((t=>{e.insertAdjacentHTML("beforeend",t)})),Array.isArray(t.selectedFilament)&&0!==t.selectedFilament.length)for(let n=0;n<t.selectedFilament.length;n++)t.selectedFilament[n]&&(e.value=t.selectedFilament[n]._id);e.addEventListener("change",(e=>{!async function(e,t){const n={printers:e,spoolId:t};try{await I.post("filament/assign",n)}catch(e){d.createAlert("error","Issue changing your spool, please check the logs...")}}([{printer:t._id,tool:n}],e.target.value)}))}class re{static getButton(e){let t="success";return e?.buttonColour&&(t=e.buttonColour),`\n    <button id="gcode-${e._id}" title="${e.description}" type="button" class="btn btn-${t}">${e.name}</button>\n    `}static async generateButtons(e){let t=await I.getCustomGcode(e._id),n=document.getElementById("customGcodeCommandsArea");n&&(t.length>0&&n.classList.contains("d-none")&&n.classList.remove("d-none"),t.forEach((t=>{let r=re.getButton(t);n.insertAdjacentHTML("beforeend",r),document.getElementById("gcode-"+t._id).addEventListener("click",(n=>{204===re.fireCommand(t._id,t.gcode,e).status?d.createAlert("success","Your gcode commands have successfully been sent!",3e3,"Clicked"):d.createAlert("danger","Your gcode failed to send! Please check the printer is able to receive these commands.",3e3,"Clicked")}))})))}static fireCommand(e,t,n){const r={commands:t};return x.post(n,"printer/command",r)}}let ie=document.getElementById("printerSelection");const oe=document.getElementById("printerSelectionWrapper");function ae(e,t,n,r){r&&ie&&(ie.remove(),oe.insertAdjacentHTML("beforeend",'\n      <select class="custom-select p-1" id="printerSelection">\n\n      </select>\n  '),ie=document.getElementById("printerSelection"),t.forEach((e=>{"Offline"!==e.state.category&&ie.insertAdjacentHTML("beforeend",`\n                <option value="${e.printerID}">${e.printerName}</option>\n            `)}))),ie.value=e,null===ie.getAttribute("listener")&&(ie.addEventListener("change",(e=>{document.getElementById("printerControls")&&(document.getElementById("printerControls").innerHTML=""),document.getElementById("pmStatus").innerHTML='<i class="fas fa-spinner fa-spin"></i>',document.getElementById("pmStatus").className="btn btn-secondary mb-2",document.getElementById("printerPortDrop").innerHTML="",document.getElementById("printerBaudDrop").innerHTML="",document.getElementById("printerProfileDrop").innerHTML="",document.getElementById("printerConnect").innerHTML="",n(e.target.value)}),!1),ie.setAttribute("listener","true"))}let se=0,le=null,ce=!1;$("#connectionModal").on("hidden.bs.modal",(function(e){document.getElementById("connectionAction")&&document.getElementById("connectionAction").remove()}));class ue{static async init(e,t,n){try{if(""!==e){document.getElementById("printerControlCamera")&&(document.getElementById("printerControlCamera").src=""),se=e;const r=_.findIndex(t,(function(t){return t._id==e}));le=t[r];const i=function(e){ue.init(e,t,n)};ae(le._id,n,i,!0),await ue.loadPrinter(le,n);const o=ue.grabPage();o.printerControls["step"+le.stepRate].className="btn btn-dark active",ue.applyState(le,o),ue.applyTemps(le,o),ue.applyListeners(o,t)}else{const e=_.findIndex(t,(function(e){return e._id==se}));le=t[e];const n=await ue.grabPage();ue.applyState(le,n),ue.applyTemps(le,n),document.getElementById("printerManagerModal").style.overflow="auto"}}catch(e){d.createAlert("danger","The volatility of this is astounding... Error:"+JSON.stringify(e),0,"Clicked")}}static async loadPrinter(e,t){try{const t=document.getElementById("printerPortDrop"),n=document.getElementById("printerBaudDrop"),r=document.getElementById("printerProfileDrop"),i=document.getElementById("printerConnect");t.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardSerialPort">Port:</label> </div> <select class="custom-select bg-secondary text-light" id="pmSerialPort"></select></div>\n    ',n.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardBaudrate">Baudrate:</label> </div> <select class="custom-select bg-secondary text-light" id="pmBaudrate"></select></div>\n    ',r.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardPrinterProfile">Profile:</label> </div> <select class="custom-select bg-secondary text-light" id="pmProfile"></select></div>\n    ',e.connectionOptions.baudrates.forEach((e=>{0!==e?document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`):document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">AUTO</option>`)})),null!=e.connectionOptions.baudratePreference&&(document.getElementById("pmBaudrate").value=e.connectionOptions.baudratePreference),e.connectionOptions.ports.forEach((e=>{document.getElementById("pmSerialPort").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)})),null!=e.connectionOptions.portPreference&&(document.getElementById("pmSerialPort").value=e.connectionOptions.portPreference),e.connectionOptions.printerProfiles.forEach((e=>{document.getElementById("pmProfile").insertAdjacentHTML("beforeend",`<option value="${e.id}">${e.name}</option>`)})),null!=e.connectionOptions.printerProfilePreference&&(document.getElementById("pmProfile").value=e.connectionOptions.printerProfilePreference),"Disconnected"===e.printerState.state||"Error!"===e.printerState.state?(i.innerHTML='<center> <button id="pmConnect" class="btn btn-success inline" value="connect">Connect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="powerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1):(i.innerHTML='<center> <button id="pmConnect" class="btn btn-danger inline" value="disconnect">Disconnect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="pmPowerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0);let o="",a="",s="";null!==e.otherSettings&&(e.otherSettings.webCamSettings.flipH&&(o="rotateY(180deg)"),e.otherSettings.webCamSettings.flipV&&(a="rotateX(180deg)"),e.otherSettings.webCamSettings.rotate90&&(s="rotate(90deg)"));let l=await I.getClientSettings(),c=await I.getServerSettings();ce=c.filamentManager,l.controlSettings;let u="d-none";e?.currentJob?.thumbnail&&(u="col-md-12 col-lg-4"),document.getElementById("printerControls").innerHTML=`\n\n\n\n            <div class="row">\n                \x3c!-- Camera --\x3e\n                <div class="col-md-4 col-lg-3 text-center">\n                  <span id="cameraRow">  \n                    <h5>Camera</h5><hr>\n                    <div class="row">\n                       <div class="col-12">\n                          <img style="transform: ${o} ${a} ${s};" id="printerControlCamera" width="100%" src=""/>\n                        </div>\n                    </div>\n                  </span>\n                  <h5>Operation</h5><hr>\n                  <button id="pmPrintStart" type="button" class="btn btn-success" role="button"><i class="fas fa-print"></i> Print</button>\n                  <button id="pmPrintPause" type="button" class="btn btn-light" role="button" disabled><i class="fas fa-pause"></i> Pause</button>\n                  <button id="pmPrintRestart" type="button" class="btn btn-danger" role="button"><i class="fas fa-undo"></i> Restart</button>\n                  <button id="pmPrintResume" type="button" class="btn btn-success" role="button"><i class="fas fa-redo"></i> Resume</button>\n                  <button id="pmPrintStop" type="button" class="btn btn-danger" disabled><i class="fas fa-square"></i> Cancel</button>\n                  <span id="customGcodeCommandsArea" class="d-none">\n                     <h5 class="mt-2">Custom Gcode</h5><hr>\n                  </span>\n                </div>\n                \x3c!-- Print Status --\x3e\n                <div class="col-md-4 col-lg-6 text-center">\n                    <h5>Print Status</h5><hr>                               \n                    <div class="row">\n                       <div class="col-12">       \n                           <div class="progress mb-2">\n                             <div id="pmProgress" class="progress-bar" role="progressbar progress-bar-striped" style="width:100%" aria-valuenow="100%" aria-valuemin="0" aria-valuemax="100">Loading... </div>\n                           </div>\n                           <div class="row">\n                             <div class="col-md-6 col-lg-8">\n                                 <b class="mb-1">File Name: </b><br><p title="Loading..." class="tag mb-1" id="pmFileName">Loading...</p>\n                             </div>\n                             <div class="col-md-6 col-lg-4">\n                                <b>Expected Completion Date: </b><p class="mb-1" id="pmExpectedCompletionDate">Loading...</p>\n                             </div>\n                           </div>\n                  \n                       </div>    \n                    </div>\n                    <div class="row">\n                        <div id="fileThumbnail" class="${u}">\n  \n                        </div>\n                        <div class="col">\n                            <div class="row">\n                                <div class="col-md-4 col-lg-4">\n                                    <b>Expected Time: </b><p class="mb-1" id="pmExpectedTime">Loading...</p>\n                                </div>\n                                <div class="col-md-4 col-lg-4">\n                                    <b>Time Elapsed: </b><p class="mb-1" id="pmTimeElapsed">Loading...</p>\n                                </div>\n                                <div class="col-md-4 col-lg-4">\n                                    <b>Time Remaining: </b><p class="mb-1" id="pmTimeRemain">Loading...</p>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-4 col-lg-4">                             \n                                  <b>Current Z: </b><p class="mb-1" id="pmCurrentZ">Loading...</p>\n                                </div>\n                                <div class="col-md-4 col-lg-4">\n                                  <b id="resentTitle" class="mb-1 d-none">Resend Statistics: </b><br><p title="Current job resend ratio" class="tag mb-1 d-none" id="printerResends">Loading...</p>                          \n                                </div>\n                                <div class="col-md-4 col-lg-4">                    \n                                  <b id="dlpPluginDataTitle" class="mb-1 d-none">Layer Progress: </b><br><p title="Current job resend ratio" class="tag mb-1 d-none" id="dlpPluginDataData">Loading...</p>            \n                                </div>\n                            </div>\n                        </div>\n                    </div>    \n                    <h5>Expected Costs</h5><hr>        \n                    <div class="row">\n                      <div class="col-md-2 col-lg-3">\n                        <b>Job Cost: </b><p class="mb-1" id="pmJobCosts">Loading...</p></center>          \n                      </div>\n                      <div class="col-md-4 col-lg-3"><b class="mb-1">Units Consumed: </b><br><p class="tag mb-1" id="pmExpectedWeight">Loading...</p></div>\n                      <div class="col-md-2 col-lg-3"><b class="mb-1">Printer Costs: </b><br><p class="tag mb-1" id="pmExpectedPrinterCost">Loading...</p></div>\n                      <div class="col-md-3 col-lg-3"><b class="mb-1">Material Costs: </b><br><p class="tag mb-1" id="pmExpectedFilamentCost">Loading...</p></div>\n                    </div> \n                </div>\n                \x3c!-- Tools --\x3e\n                <div class="col-md-4 col-lg-3 text-center">\n                    <h5>Tools</h5><hr>\n                    <div class="row">\n                      <div class="col-12">\n                          <button id="pmTempTime" type="button" class="btn btn-secondary btn-sm float-right" disabled>Updated: <i class="far fa-clock"></i> Never</button>\n                      </div>\n                      </div>\n                    <div class="row" id="pmToolTemps">\n      \n                    </div>\n                    <div class="row" id="pmOtherTemps">\n                    </div>\n                    <h5>Extrusion</h5><hr>\n                    <div class="row">\n                    <div class="col-4">\n                            <div class="input-group">\n                                <input id="pcExtruder" type="number" class="form-control" placeholder="0" aria-label="Recipient's username" aria-describedby="basic-addon2">\n                                <div class="input-group-append">\n                                    <span class="input-group-text" id="basic-addon2">mm</span>\n                                </div>\n                            </div>\n                    </div>\n                     <div class="col-8">\n                      <div class="btn-group" role="group" aria-label="Basic example">\n                        <button id="pcExtrude" class="btn btn-light"><i class="fas fa-redo"></i> Extrude</button> \n                        <button id="pcRetract" class="btn btn-light"><i class="fas fa-undo"></i> Retract</button>\n                      </div>\n            </div>\n            </div>\n                </div>\n                \x3c!-- Control --\x3e\n                <div class="col-md-4 col-lg-4 text-center">\n                    <h5>Control</h5><hr>    \n                    <div class="row">\n                        <div class="col-3"></div>\n                        <div class="col-3">\n                            <center><button id="pcYpos" type="button" class="btn btn-light"><i class="fas fa-arrow-up"></i></button></center>\n                        </div>\n                        <div class="col-3"></div>\n                        <div class="col-3">\n                            <center><button id="pcZpos"type="button" class="btn btn-light"><i class="fas fa-arrow-up"></i></button></center>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-3">\n                            <center><button id="pcXneg" type="button" class="btn btn-light"><i class="fas fa-arrow-left"></i></button></center>\n                        </div>\n                        <div class="col-3">\n                            <center><button id="pcXYhome" type="button" class="btn btn-light"><i class="fas fa-home"></i></button></center>\n                        </div>\n                        <div class="col-3">\n                            <center><button id="pcXpos" type="button" class="btn btn-light"><i class="fas fa-arrow-right"></i></button></center>\n                        </div>\n                        <div class="col-3">\n                            <center><button id="pcZhome" type="button" class="btn btn-light"><i class="fas fa-home"></i></button></center>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-3"></div>\n                        <div class="col-3">\n                            <center><button id="pcYneg" type="button" class="btn btn-light"><i class="fas fa-arrow-down"></i></button></center>\n                        </div>\n                        <div class="col-3"></div>\n                        <div class="col-3">\n                            <center><button id="pcZneg" type="button" class="btn btn-light"><i class="fas fa-arrow-down"></i></button></center>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-12">\n                            <center>\n                                <div id="pcAxisSteps" class="btn-group" role="group">\n                                    <button id="pcAxisSteps01" type="button" class="btn btn-light" value="01">0.1</button>\n                                    <button id="pcAxisSteps1" type="button" class="btn btn-light" value="1">1</button>\n                                    <button id="pcAxisSteps10" type="button" class="btn btn-light" value="10">10</button>\n                                    <button id="pcAxisSteps100" type="button" class="btn btn-light" value="100">100</button>\n                                </div>\n                            </center>\n                        </div>\n                    </div>\n                  </div>\n                \x3c!-- Feed/Flow --\x3e\n                <div class="col-md-4 col-lg-4 text-center">\n                  <h5>Feed/Flow Rate</h5><hr>\n                  <div class="row">\n                      <div class="col-10 col-lg-8 col-xl-8">\n                          <label for="pcFeed">Feed Rate: <span id="pcFeedValue">${e.feedRate}%</span></label>\n                          <input type="range" class="octoRange custom-range" min="10" max="300" step="1" id="pcFeed" value="${e.feedRate}">\n                      </div>\n                      <div class="col-2 col-lg-4 col-xl-4">\n                          <button id="pcFeedRate" type="button" class="btn btn-light">Update</button>\n                      </div>\n                  </div>\n                  <div class="row">\n                      <div class="col-10 col-lg-8 col-xl-8">\n                          <label for="pcFlow">Flow Rate: <span id="pcFlowValue">${e.flowRate}%</span></label>\n                          <input type="range" class="octoRange custom-range" min="75" max="125" step="1" id="pcFlow" value="${e.flowRate}">\n                      </div>\n                      <div class="col-2 col-lg-4 col-xl-4">\n                          <button id="pcFlowRate" type="button" class="btn btn-light">Update</button>\n                      </div>\n                  </div>\n               </div>\n                \x3c!-- Motors/Fans --\x3e\n                <div class="col-md-4 col-lg-4 text-center">\n                  <h5>Motors / Fans</h5><hr>\n                  <div class="row">\n                    <div class="col-12">\n                        <center><button id="pcMotorTog" class="btn btn-light" type="submit">Motors Off</button></center>\n                    </div>\n                </div>\n                  <div class="row">\n                    <div class="col-12">\n                    <label for="pcFlow">Fan Percent: <span id="pcFanPercent">100%</span></label>\n                    <input type="range" class="octoRange custom-range" min="0" max="100" step="1" id="pcFanPercent" value="100">\n                        <center><button id="pcFanOn" class="btn btn-light" type="submit">Set Fans</button> <button id="pcFanOff" class="btn btn-light" type="submit">Fans Off</button></center>\n                    </div>\n                </div>\n               </div>\n\n            </div>\n            `;let d="";d=void 0!==e.camURL&&e.camURL.includes("http")?e.camURL:"../../../images/noCamera.jpg";const p=document.getElementById("cameraRow");e.otherSettings.webCamSettings.webcamEnabled?(document.getElementById("printerControlCamera").src=d,p.classList.contains("d-none")&&p.classList.remove("d-none")):p.classList.contains("d-none")||p.classList.add("d-none");const f=document.getElementById("pmToolTemps");if(document.getElementById("pmOtherTemps").innerHTML="",f.innerHTML="",void 0!==e.currentProfile&&null!==e.currentProfile){const t=Object.keys(e.currentProfile);for(let n=0;n<t.length;n++)if(t[n].includes("extruder"))for(let r=0;r<e.currentProfile[t[n]].count;r++){f.insertAdjacentHTML("beforeend",`\n                                <div class="col-8">\n                                   <div class="md-form input-group mb-3">\n       \n                                      <div title="Actual Tool temperature" class="input-group-prepend">\n                                          <span class="input-group-text"><span>${r}: </span><span id="tool${r}Actual"> 0°C</span></span>\n                                      </div>\n                                      <input title="Set your target Tool temperature" id="tool${r}Target" type="number" class="form-control col" placeholder="0°C" aria-label="Recipient's username" aria-describedby="MaterialButton-addon2">\n                                      <div class="input-group-append">\n                                          <button class="btn btn-md btn-light m-0 p-1" type="button" id="tool${r}Set">Set</button>\n                                      </div>\n                                  </div>\n                                </div>\n                                <div class="col-4">\n                                 <div class="input-group mb-1"> <select class="custom-select bg-secondary text-light" id="tool${r}FilamentManagerFolderSelect"><option value="" selected></option></select></div>\n                                </div>\n                                `);const t=document.getElementById(`tool${r}FilamentManagerFolderSelect`);await ne(t,e,r)}else t[n].includes("heatedBed")?e.currentProfile[t[n]]&&document.getElementById("pmOtherTemps").insertAdjacentHTML("beforeend",'\n                           <div class="col">\n                          <center>\n                              <h5>Bed</h5>\n                          </center>\n                          <hr>\n                          <div class="md-form input-group mb-3">\n                              <div title="Actual Bed temperature" class="input-group-prepend">\n                                  <span id="bedActual" class="input-group-text">0°C</span>\n                              </div>\n                              <input title="Set your target Bed temperature" id="bedTarget" type="number" class="form-control col-lg-12 col-xl-12" placeholder="0°C" aria-label="Recipient\'s username" aria-describedby="MaterialButton-addon2">\n                              <div class="input-group-append">\n                                  <button class="btn btn-md btn-light m-0 p-1" type="button" id="bedSet">Set</button>\n                              </div>\n                          </div>\n                            </div>\n                         '):t[n].includes("heatedChamber")&&e.currentProfile[t[n]]&&document.getElementById("pmOtherTemps").insertAdjacentHTML("beforeend",'\n                         <div class="col">\n                          <center>\n                              <h5>Chamber</h5>\n                          </center>\n                          <hr>\n                          <div class="md-form input-group mb-3">\n                              <div title="Actual Bed temperature" class="input-group-prepend">\n                                  <span id="chamberActual" class="input-group-text">0°C</span>\n                              </div>\n                              <input title="Set your target Bed temperature" id="chamberTarget" type="number" class="form-control col-lg-12 col-xl-12" placeholder="0°C" aria-label="Recipient\'s username" aria-describedby="MaterialButton-addon2">\n                              <div class="input-group-append">\n                                  <button class="btn btn-md btn-light m-0 p-1" type="button" id="chamberSet">Set</button>\n                              </div>\n                          </div>\n                            </div>\n                         ')}return await re.generateButtons(e),!0}catch(e){d.createAlert("error","Something has gone wrong with loading the Printer Manager... Hard Failure, please submit as a bug on github: "+e,0,"clicked"),console.error(e)}}static applyListeners(e,t){if(document.querySelectorAll("input.octoRange").forEach((e=>{e.addEventListener("input",(e=>{e.target.previousSibling.previousSibling.lastChild.innerHTML=`${e.target.value}%`}))})),le.state,e.connectPage.connectButton.addEventListener("click",(t=>{e.connectPage.connectButton.disabled=!0,x.connect(e.connectPage.connectButton.value,le)})),e.printerControls.xPlus.addEventListener("click",(e=>{x.move(e,le,"jog","x")})),e.printerControls.xMinus.addEventListener("click",(e=>{x.move(e,le,"jog","x","-")})),e.printerControls.yPlus.addEventListener("click",(e=>{x.move(e,le,"jog","y")})),e.printerControls.yMinus.addEventListener("click",(e=>{x.move(e,le,"jog","y","-")})),e.printerControls.xyHome.addEventListener("click",(e=>{x.move(e,le,"home",["x","y"])})),e.printerControls.zPlus.addEventListener("click",(e=>{x.move(e,le,"jog","z")})),e.printerControls.zMinus.addEventListener("click",(e=>{x.move(e,le,"jog","z","-")})),e.printerControls.zHome.addEventListener("click",(e=>{x.move(e,le,"home",["z"])})),e.printerControls.step01.addEventListener("click",(t=>{I.post("printers/stepChange",{printer:le._id,newSteps:"01"}),e.printerControls.step01.className="btn btn-dark active",e.printerControls.step1.className="btn btn-light",e.printerControls.step10.className="btn btn-light",e.printerControls.step100.className="btn btn-light"})),e.printerControls.step1.addEventListener("click",(t=>{I.post("printers/stepChange",{printer:le._id,newSteps:"1"}),e.printerControls.step1.className="btn btn-dark active",e.printerControls.step01.className="btn btn-light",e.printerControls.step10.className="btn btn-light",e.printerControls.step100.className="btn btn-light"})),e.printerControls.step10.addEventListener("click",(t=>{I.post("printers/stepChange",{printer:le._id,newSteps:"10"}),e.printerControls.step10.className="btn btn-dark active",e.printerControls.step1.className="btn btn-light",e.printerControls.step01.className="btn btn-light",e.printerControls.step100.className="btn btn-light"})),e.printerControls.step100.addEventListener("click",(t=>{I.post("printers/stepChange",{printer:le._id,newSteps:"100"}),e.printerControls.step100.className="btn btn-dark active",e.printerControls.step1.className="btn btn-light",e.printerControls.step10.className="btn btn-light",e.printerControls.step01.className="btn btn-light"})),null!==le.currentProfile){const t=Object.keys(le.currentProfile);for(let n=0;n<t.length;n++)if(t[n].includes("extruder"))for(let e=0;e<le.currentProfile[t[n]].count;e++){const t=async function(t){const n=function(){document.getElementById("tool"+e+"Set").className="btn btn-md btn-light m-0 p-1"};let{value:r}=document.getElementById("tool"+e+"Target");document.getElementById("tool"+e+"Target").value="","Off"===r&&(r=0);const i={command:"target",targets:{["tool"+e]:parseInt(r)}};204===(await x.post(le,"printer/tool",i)).status?(document.getElementById("tool"+e+"Set").className="btn btn-md btn-success m-0 p-1",setTimeout(n,500)):(document.getElementById("tool"+e+"Set").className="btn btn-md btn-danger m-0 p-1",setTimeout(n,500))};document.getElementById("tool"+e+"Target").addEventListener("change",(async t=>{document.getElementById("tool"+e+"Target").value<=0&&(document.getElementById("tool"+e+"Target").value="0")})),document.getElementById("tool"+e+"Target").addEventListener("keypress",(async e=>{"Enter"===e.key&&t(e)})),document.getElementById("tool"+e+"Set").addEventListener("click",(async e=>{t(e)}))}else if(t[n].includes("heatedBed")){if(le.currentProfile[t[n]]){const t=async function(t){let{value:n}=e.temperatures.bed[1];e.temperatures.bed[1].value="","Off"===n&&(n=0);const r={command:"target",target:parseInt(n)};(await x.post(le,"printer/bed",r)).status,e.temperatures.bed[2].className="btn btn-md btn-success m-0 p-1",e.temperatures.bed[2].value="",setTimeout((function(){e.temperatures.bed[2].classList="btn btn-md btn-light m-0 p-1"}),500)};e.temperatures.bed[1]&&e.temperatures.bed[1].addEventListener("change",(async t=>{e.temperatures.bed[1].value<=0&&(e.temperatures.bed[1].value="")})),e.temperatures.bed.forEach((e=>{e.id.includes("Target")&&e&&e.addEventListener("keypress",(async e=>{"Enter"===e.key&&t(e)})),e.id.includes("Set")&&e&&e.addEventListener("click",(async e=>{t(e)}))}))}}else if(t[n].includes("heatedChamber")&&le.currentProfile[t[n]]){const t=async function(t){let{value:n}=e.temperatures.chamber[1];e.temperatures.chamber[1].value="","Off"===n&&(n=0);const r={command:"target",target:parseInt(n)};(await x.post(le,"printer/chamber",r)).status,e.temperatures.chamber[2].className="btn btn-md btn-success m-0 p-1",setTimeout((function(){e.temperatures.chamber[2].classList="btn btn-md btn-light m-0 p-1"}),500)};e.temperatures.chamber[1]&&e.temperatures.chamber[1].addEventListener("change",(async t=>{e.temperatures.chamber[1].value<=0&&(e.temperatures.chamber[1].value="")})),e.temperatures.chamber.forEach((e=>{e.id.includes("Target")&&e&&e.addEventListener("keypress",(async e=>{"Enter"===e.key&&t(e)})),e.id.includes("Set")&&e&&e.addEventListener("click",(async e=>{t(e)}))}))}}e.printerControls.feedRate.addEventListener("click",(async t=>{const n=function(){t.target.classList="btn btn-light"};let r=e.printerControls.feedRateValue.innerHTML;r=r.replace("%",""),I.post("printers/feedChange",{printer:le._id,newSteps:r});const i={command:"feedrate",factor:parseInt(r)};204===(await x.post(le,"printer/printhead",i)).status?(t.target.classList="btn btn-success",setTimeout(n,500)):(t.target.classList="btn btn-danger",setTimeout(n,500))})),e.printerControls.flowRate.addEventListener("click",(async t=>{const n=function(){t.target.classList="btn btn-light"};let r=e.printerControls.flowRateValue.innerHTML;r=r.replace("%",""),I.post("printers/flowChange",{printer:le._id,newSteps:r});const i={command:"flowrate",factor:parseInt(r)};204===(await x.post(le,"printer/tool",i)).status?(t.target.classList="btn btn-success",setTimeout(n,500)):(t.target.classList="btn btn-danger",setTimeout(n,500))})),e.printerControls.motorsOff.addEventListener("click",(async e=>{const t=function(){e.target.classList="btn btn-light"};204===(await x.post(le,"printer/command",{commands:["M18"]})).status?(e.target.classList="btn btn-success",setTimeout(t,500)):(e.target.classList="btn btn-danger",setTimeout(t,500))})),e.printerControls.fansOn.addEventListener("click",(async t=>{let n=e.printerControls.fanPercent.innerHTML;n=n.replace("%",""),n/=100,n*=255,n=Math.floor(n);const r=function(){t.target.classList="btn btn-light"},i={commands:[`M106 S${n}`]};204===(await x.post(le,"printer/command",i)).status?(t.target.classList="btn btn-success",setTimeout(r,500)):(t.target.classList="btn btn-danger",setTimeout(r,500))})),e.printerControls.fansOff.addEventListener("click",(async e=>{const t=function(){e.target.classList="btn btn-light"};204===(await x.post(le,"printer/command",{commands:["M107"]})).status?(e.target.classList="btn btn-success",setTimeout(t,500)):(e.target.classList="btn btn-danger",setTimeout(t,500))})),e.printerControls.extrude.addEventListener("click",(async t=>{const n=function(){t.target.classList="btn btn-light"};if(null!=e.printerControls.extruder.value&&""!==e.printerControls.extruder.value){if(x.selectTool(le,"tool0")){const{value:r}=e.printerControls.extruder,i={command:"extrude",amount:parseInt(r)};204===(await x.post(le,"printer/tool",i)).status?(t.target.classList="btn btn-success",setTimeout(n,500)):(t.target.classList="btn btn-danger",setTimeout(n,500))}}else d.createAlert("error","You haven't told octoprint how much you'd like to extrude...",3e3,"clicked")})),e.printerControls.retract.addEventListener("click",(async t=>{const n=function(){t.target.classList="btn btn-light"};if(null!=e.printerControls.extruder.value&&""!==e.printerControls.extruder.value){if(x.selectTool(le,"tool0")){let{value:r}=e.printerControls.extruder;r="-"+r;const i={command:"extrude",amount:parseInt(r)};204===(await x.post(le,"printer/tool",i)).status?(t.target.classList="btn btn-success",setTimeout(n,500)):(t.target.classList="btn btn-danger",setTimeout(n,500))}}else d.createAlert("error","You haven't told octoprint how much you'd like to retract...",3e3,"clicked")})),e.printerControls.printStart.addEventListener("click",(async e=>{e.target.disabled=!0,x.jobAction(le,{command:"start"},e)})),e.printerControls.printPause.addEventListener("click",(e=>{e.target.disabled=!0,x.jobAction(le,{command:"pause",action:"pause"},e)})),e.printerControls.printRestart.addEventListener("click",(e=>{e.target.disabled=!0,x.jobAction(le,{command:"restart"},e)})),e.printerControls.printResume.addEventListener("click",(e=>{e.target.disabled=!0,x.jobAction(le,{command:"pause",action:"resume"},e)})),e.printerControls.printStop.addEventListener("click",(e=>{bootbox.confirm({message:`${le.printerName}: <br>Are you sure you want to cancel the ongoing print?`,buttons:{cancel:{label:'<i class="fa fa-times"></i> Cancel'},confirm:{label:'<i class="fa fa-check"></i> Confirm'}},callback(t){if(t){e.target.disabled=!0;const t={command:"cancel"};x.jobAction(le,t,e)}}})}))}static grabPage(){return{mainPage:{title:document.getElementById("printerSelection"),status:document.getElementById("pmStatus")},jobStatus:{expectedCompletionDate:document.getElementById("pmExpectedCompletionDate"),expectedTime:document.getElementById("pmExpectedTime"),remainingTime:document.getElementById("pmTimeRemain"),elapsedTime:document.getElementById("pmTimeElapsed"),currentZ:document.getElementById("pmCurrentZ"),fileName:document.getElementById("pmFileName"),progressBar:document.getElementById("pmProgress"),expectedWeight:document.getElementById("pmExpectedWeight"),expectedPrinterCost:document.getElementById("pmExpectedPrinterCost"),expectedFilamentCost:document.getElementById("pmExpectedFilamentCost"),expectedTotalCosts:document.getElementById("pmJobCosts"),printerResends:document.getElementById("printerResends"),resendTitle:document.getElementById("resentTitle"),dlpPluginDataTitle:document.getElementById("dlpPluginDataTitle"),dlpPluginDataData:document.getElementById("dlpPluginDataData")},connectPage:{printerPort:document.getElementById("printerPortDrop"),printerBaud:document.getElementById("printerBaudDrop"),printerProfile:document.getElementById("printerProfileDrop"),printerConnect:document.getElementById("printerConnect"),connectButton:document.getElementById("pmConnect"),portDropDown:document.getElementById("pmSerialPort"),baudDropDown:document.getElementById("pmBaudrate"),profileDropDown:document.getElementById("pmProfile")},printerControls:{filamentDrop:document.getElementById("filamentManagerFolderSelect"),fileUpload:document.getElementById("printerManagerUploadBtn"),xPlus:document.getElementById("pcXpos"),xMinus:document.getElementById("pcXneg"),yPlus:document.getElementById("pcYpos"),yMinus:document.getElementById("pcYneg"),xyHome:document.getElementById("pcXYhome"),zPlus:document.getElementById("pcZpos"),zMinus:document.getElementById("pcZneg"),zHome:document.getElementById("pcZhome"),step01:document.getElementById("pcAxisSteps01"),step1:document.getElementById("pcAxisSteps1"),step10:document.getElementById("pcAxisSteps10"),step100:document.getElementById("pcAxisSteps100"),feedRate:document.getElementById("pcFeedRate"),flowRate:document.getElementById("pcFlowRate"),feedRateValue:document.getElementById("pcFeedValue"),flowRateValue:document.getElementById("pcFlowValue"),motorsOff:document.getElementById("pcMotorTog"),fanPercent:document.getElementById("pcFanPercent"),fansOn:document.getElementById("pcFanOn"),fansOff:document.getElementById("pcFanOff"),extruder:document.getElementById("pcExtruder"),extrude:document.getElementById("pcExtrude"),retract:document.getElementById("pcRetract"),progress:document.getElementById("pcAxisSteps100"),printStart:document.getElementById("pmPrintStart"),printPause:document.getElementById("pmPrintPause"),printRestart:document.getElementById("pmPrintRestart"),printResume:document.getElementById("pmPrintResume"),printStop:document.getElementById("pmPrintStop")},temperatures:{tempTime:document.getElementById("pmTempTime"),bed:document.querySelectorAll("[id^='bed']"),chamber:document.querySelectorAll("[id^='chamber']"),tools:document.querySelectorAll("[id^='tool']")},filamentDrops:document.querySelectorAll("[id$=FilamentManagerFolderSelect]")}}static async applyState(e,t){t.mainPage.status.innerHTML=e.printerState.state,t.mainPage.status.className=`btn btn-${e.printerState.colour.name} mb-2`;let n=null;const r=document.getElementById("fileThumbnail");if(void 0!==e.currentJob&&null!=e.currentJob.thumbnail?r.innerHTML!==`<center><img width="100%" src="${e.printerURL}/${e.currentJob.thumbnail}"></center>`&&(r.innerHTML=`<center><img width="100%" src="${e.printerURL}/${e.currentJob.thumbnail}"></center>`):""!==r.innerHTML&&(r.innerHTML=""),void 0!==e.currentJob&&null!==e.currentJob.printTimeRemaining){let t=new Date;if(100===e.currentJob.progress)n="Print Ready for Harvest";else{t=t.getTime();const r=new Date(t+1e3*e.currentJob.printTimeRemaining).toDateString();let i=new Date(t+1e3*e.currentJob.printTimeRemaining).toTimeString();i=i.substring(0,8),n=r+": "+i}}else n="No Active Print";if(t.jobStatus.expectedCompletionDate.innerHTML=n,void 0!==e.resends&&null!==e.resends&&(t.jobStatus.printerResends.classList.contains("d-none")&&(t.jobStatus.printerResends.classList.remove("d-none"),t.jobStatus.resendTitle.classList.remove("d-none")),t.jobStatus.printerResends.innerHTML=`\n      ${e.resends.count} / ${e.resends.transmitted/1e3}K (${e.resends.ratio.toFixed(0)})\n      `),e?.layerData&&(t.jobStatus.dlpPluginDataTitle.classList.contains("d-none")&&(t.jobStatus.dlpPluginDataTitle.classList.remove("d-none"),t.jobStatus.dlpPluginDataData.classList.remove("d-none")),t.jobStatus.dlpPluginDataData.innerHTML=`${e.layerData.currentLayer} / ${e.layerData.totalLayers} (${e.layerData.percentComplete}%)`),void 0!==e.currentJob&&null!==e.currentJob.progress?(t.jobStatus.progressBar.innerHTML=e.currentJob.progress.toFixed(0)+"%",t.jobStatus.progressBar.style.width=e.currentJob.progress.toFixed(2)+"%"):(t.jobStatus.progressBar.innerHTML="0%",t.jobStatus.progressBar.style.width="0%"),t.jobStatus.expectedTime.innerHTML=b.generateTime(e.currentJob.expectedPrintTime),t.jobStatus.remainingTime.innerHTML=b.generateTime(e.currentJob.printTimeRemaining),t.jobStatus.elapsedTime.innerHTML=b.generateTime(e.currentJob.printTimeElapsed),null===e.currentJob.currentZ?t.jobStatus.currentZ.innerHTML="No Active Print":t.jobStatus.currentZ.innerHTML=e.currentJob.currentZ+"mm",void 0===e.currentJob){t.jobStatus.fileName.setAttribute("title","No File Selected");const e="No File Selected";t.jobStatus.fileName.innerHTML=e}else{t.jobStatus.fileName.setAttribute("title",e.currentJob.filePath);let n=e.currentJob.fileDisplay;n.length>49&&(n=n.substring(0,49)+"..."),t.jobStatus.fileName.innerHTML=e.currentJob.fileDisplay;let r="",i="";null!==e.currentJob.expectedTotals?(r+=`<p class="mb-0"><b>Total: </b>${e.currentJob.expectedTotals.totalLength.toFixed(2)}m / ${e.currentJob.expectedTotals.totalWeight.toFixed(2)}g</p>`,t.jobStatus.expectedTotalCosts.innerHTML=e.currentJob.expectedTotals.totalCost):(r="No File Selected",t.jobStatus.expectedTotalCosts.innerHTML="No File Selected"),"object"==typeof e.currentJob.expectedFilamentCosts?null!==e.currentJob.expectedFilamentCosts?(e.currentJob.expectedFilamentCosts.forEach((e=>{const t=Object.keys(e)[0];let n=parseFloat(e[t].length),i=parseFloat(e[t].weight);r+=`<p class="mb-0"><b>${e[t].toolName}: </b>${n.toFixed(2)}m / ${i.toFixed(2)}g</p>`})),i+=`<p class="mb-0"><b>Total: </b>${e.currentJob.expectedTotals.spoolCost.toFixed(2)}</p>`,e.currentJob.expectedFilamentCosts.forEach((e=>{const t=Object.keys(e)[0];i+=`<p class="mb-0"><b>${e[t].toolName}: </b>${e[t].cost}</p>`}))):i="No length estimate":i="No File Selected",t.jobStatus.expectedWeight.innerHTML=r,t.jobStatus.expectedFilamentCost.innerHTML=i;const o=e.currentJob.expectedPrinterCosts;t.jobStatus.expectedPrinterCost.innerHTML=o}"Active"===e.printerState.colour.category?(ue.controls(!0,!0),t.printerControls.printStart.disabled=!0,t.printerControls.printStart.style.display="inline-block",t.printerControls.printPause.disabled=!1,t.printerControls.printPause.style.display="inline-block",t.printerControls.printStop.disabled=!1,t.printerControls.printStop.style.display="inline-block",t.printerControls.printRestart.disabled=!0,t.printerControls.printRestart.style.display="none",t.printerControls.printResume.disabled=!0,t.printerControls.printResume.style.display="none"):"Idle"===e.printerState.colour.category||"Complete"===e.printerState.colour.category?(ue.controls(!1),t.connectPage.connectButton.value="disconnect",t.connectPage.connectButton.innerHTML="Disconnect",t.connectPage.connectButton.classList="btn btn-danger inline",t.connectPage.connectButton.disabled=!1,t.connectPage.printerPort.disabled=!0,t.connectPage.printerBaud.disabled=!0,t.connectPage.printerProfile.disabled=!0,void 0!==e.job&&"No File Selected"===e.job.filename?(t.printerControls.printStart.disabled=!0,t.printerControls.printStart.style.display="inline-block",t.printerControls.printPause.disabled=!0,t.printerControls.printPause.style.display="inline-block",t.printerControls.printStop.disabled=!0,t.printerControls.printStop.style.display="inline-block",t.printerControls.printRestart.disabled=!0,t.printerControls.printRestart.style.display="none",t.printerControls.printResume.disabled=!0,t.printerControls.printResume.style.display="none"):"Paused"===e.printerState.state?(ue.controls(!1),t.printerControls.printStart.disabled=!0,t.printerControls.printStart.style.display="none",t.printerControls.printPause.disabled=!0,t.printerControls.printPause.style.display="none",t.printerControls.printStop.disabled=!1,t.printerControls.printStop.style.display="inline-block",t.printerControls.printRestart.disabled=!1,t.printerControls.printRestart.style.display="inline-block",t.printerControls.printResume.disabled=!1,t.printerControls.printResume.style.display="inline-block"):(t.printerControls.printStart.disabled=!1,t.printerControls.printStart.style.display="inline-block",t.printerControls.printPause.disabled=!0,t.printerControls.printPause.style.display="inline-block",t.printerControls.printStop.disabled=!0,t.printerControls.printStop.style.display="inline-block",t.printerControls.printRestart.disabled=!0,t.printerControls.printRestart.style.display="none",t.printerControls.printResume.disabled=!0,t.printerControls.printResume.style.display="none")):"Offline"!==e.printerState.colour.category&&"Disconnected"!==e.printerState.colour.category||("Error!"===e.printerState.state&&(document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1),t.connectPage.connectButton.value="connect",t.connectPage.connectButton.innerHTML="Connect",t.connectPage.connectButton.classList="btn btn-success inline",t.connectPage.connectButton.disabled=!1,ue.controls(!0),t.printerControls.printStart.disabled=!0,t.printerControls.printStart.style.display="inline-block",t.printerControls.printPause.disabled=!0,t.printerControls.printPause.style.display="inline-block",t.printerControls.printStop.disabled=!0,t.printerControls.printStop.style.display="inline-block",t.printerControls.printRestart.disabled=!0,t.printerControls.printRestart.style.display="none",t.printerControls.printResume.disabled=!0,t.printerControls.printResume.style.display="none","Offline"!==e.printerState.state.category&&"Shutdown"!==e.state&&"Searching..."!==e.state||$("#printerManagerModal").modal("hide"))}static async applyTemps(e,t){if(null!==e.tools){const n=e.tools[0];t.temperatures.tempTime.innerHTML='Updated: <i class="far fa-clock"></i> '+(new Date).toTimeString().substring(1,8),null!==n.bed.actual&&(t.temperatures.bed[0].innerHTML=n.bed.actual+"°C",t.temperatures.bed[1].placeholder=n.bed.target+"°C"),null!==n.chamber.actual&&(t.temperatures.chamber[0].innerHTML=n.chamber.actual+"°C",t.temperatures.chamber[1].placeholder=n.chamber.target+"°C");let r=Object.keys(n);r=r.reverse(),r.forEach((e=>{e.includes("tool")&&t.temperatures.tools.forEach((t=>{t.id.includes(e)&&t.id.includes("Actual")&&(t.innerHTML=n[e].actual+"°C"),t.id.includes(e)&&t.id.includes("Target")&&(t.placeholder=n[e].target+"°C")}))}))}}static async controls(e,t){let n=await ue.grabPage();const{filamentDrops:r}=n;n=n.printerControls;let i=!0;ce||(i=!1),void 0!==t&&t?(n.feedRate.disabled=!t,n.flowRate.disabled=!t,n.fansOn.disabled=!t,n.fansOff.disabled=!t,r.forEach((e=>{e.disabled=i}))):(n.feedRate.disabled=e,n.flowRate.disabled=e,n.fansOn.disabled=e,n.fansOff.disabled=e,r.forEach((t=>{t.disabled=e}))),n.xPlus.disabled=e,n.xMinus.disabled=e,n.yPlus.disabled=e,n.yMinus.disabled=e,n.xyHome.disabled=e,n.zPlus.disabled=e,n.zMinus.disabled=e,n.zHome.disabled=e,n.step01.disabled=e,n.step1.disabled=e,n.step10.disabled=e,n.step100.disabled=e,n.motorsOff.disabled=e,n.extrude.disabled=e,n.retract.disabled=e}}let de=0,pe=null;$("#connectionModal").on("hidden.bs.modal",(function(e){document.getElementById("connectionAction")&&document.getElementById("connectionAction").remove()}));class fe{static async init(e,t,n){if(""!==e){de=e;const r=_.findIndex(t,(function(t){return t._id==e}));pe=t[r];const i=function(e){fe.init(e,t,n)};ae(pe._id,n,i,!0);const o=await te();await fe.loadPrinter(pe);const a=fe.grabPage();fe.applyState(pe,a),fe.applyListeners(a,t,o)}else{const e=_.findIndex(t,(function(e){return e._id==de}));pe=t[e];const n=await fe.grabPage();fe.applyState(pe,n),document.getElementById("printerManagerModal").style.overflow="auto"}return!0}static async loadPrinter(e){try{const t=document.getElementById("printerPortDrop"),n=document.getElementById("printerBaudDrop"),r=document.getElementById("printerProfileDrop"),i=document.getElementById("printerConnect");t.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardSerialPort">Port:</label> </div> <select class="custom-select bg-secondary text-light" id="pmSerialPort"></select></div>\n    ',n.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardBaudrate">Baudrate:</label> </div> <select class="custom-select bg-secondary text-light" id="pmBaudrate"></select></div>\n    ',r.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardPrinterProfile">Profile:</label> </div> <select class="custom-select bg-secondary text-light" id="pmProfile"></select></div>\n    ',e.connectionOptions.baudrates.forEach((e=>{0!==e?document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`):document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">AUTO</option>`)})),null!=e.connectionOptions.baudratePreference&&(document.getElementById("pmBaudrate").value=e.connectionOptions.baudratePreference),e.connectionOptions.ports.forEach((e=>{document.getElementById("pmSerialPort").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)})),null!=e.connectionOptions.portPreference&&(document.getElementById("pmSerialPort").value=e.connectionOptions.portPreference),e.connectionOptions.printerProfiles.forEach((e=>{document.getElementById("pmProfile").insertAdjacentHTML("beforeend",`<option value="${e.id}">${e.name}</option>`)})),null!=e.connectionOptions.printerProfilePreference&&(document.getElementById("pmProfile").value=e.connectionOptions.printerProfilePreference),"Disconnected"===e.printerState.state||"Error!"===e.printerState.state?(i.innerHTML='<center> <button id="pmConnect" class="btn btn-success inline" value="connect">Connect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="powerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1):(i.innerHTML='<center> <button id="pmConnect" class="btn btn-danger inline" value="disconnect">Disconnect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="pmPowerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0),document.getElementById("printerControls").innerHTML=`\n          <div class="row">\n            <div id="customGcodeCommandsArea" class="col-lg-12"></div>\n          </div>\n          <div class="row bg-secondary rounded-top">\n                <div class="col-12">\n                     <h5 class="float-left  mb-0">\n                      <button id="printerFileCount" type="button" class="btn btn-secondary float-right d-block" href="#" aria-expanded="false" disabled="">\n                        <i class="fas fa-file"></i> Loading... <i class="fas fa-folder"></i> Loading...\n                      </button>\n                      <button id="printerStorage" type="button" class="btn btn-secondary float-right d-block" href="#" aria-expanded="false" disabled="">\n  \n                        <i class="fas fa-hdd"></i> Loading...\n                      </button>\n                    </h5>\n                    <h5 class="float-left mb-0">\n                      <button type="button" class="btn btn-secondary float-right d-block" href="#" aria-expanded="false" disabled="">\n                        <i class="fas fa-file-code"></i> Files: <span id="currentFolder">local</span>/\n                      </button>\n                    </h5>\n                    <div class="btn btn-secondary form-group float-right  mb-0">\n                      <form class="form-inline">\n                        <div class="form-group">\n                          <label for="searchFiles">\n                            <i class="fas fa-search pr-1"></i>\n                          </label>\n                          <input id="searchFiles" type="text" placeholder="File Search..." class="search-control search-control-underlined">\n                        </div>\n                      </form>\n                    </div>\n                   </div>\n                  </div>\n          <div class="row bg-secondary rounded-bottom">\n              <div class="col-lg-2">\n                <i class="fas fa-file-upload ml-2 mb-1"></i><span id="fileCounts-${e._id}"> 0 </span>\n              </div>\n              <div class="col-lg-10">\n                <div class="progress">\n                  <div id="fileProgress-${e._id}" class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">\n                    0%\n                  </div>\n                </div>\n              </div>\n            </div>\n          <div class="row mb-1">\n                <div class="col-12">\n                 <button id="fileBackBtn" type="button" class="btn btn-success float-right">\n                  <i class="fas fa-chevron-left"></i> Back\n                </button>\n                \x3c!-- Split dropright button --\x3e\n                <div class="float-right mr-3 btn-group">\n                    <div id="fileSortDropdownMenu" class="btn bg-secondary">Sort</div>\n                    <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                      <span class="sr-only">Toggle Dropdown</span>\n                    </button>\n                    <div class="dropdown-menu">\n                      \n                 <a class="dropdown-item" id="sortFileNameDown"><i class="fas fa-sort-alpha-down"></i> File Name</a>\n\n                <a class="dropdown-item" id="sortFileNameUp"><i class="fas fa-sort-alpha-up"></i> File Name</a>\n                       <div class="dropdown-divider"></div>\n                <a class="dropdown-item" id="sortPrintTimeDown"><i class="fas fa-sort-numeric-down"></i> Print Time</a>\n\n                <a class="dropdown-item" id="sortPrintTimeUp"><i class="fas fa-sort-numeric-up"></i> Print Time</a>\n                       <div class="dropdown-divider"></div>\n                <a class="dropdown-item" id="sortDateDown"><i class="fas fa-sort-numeric-down"></i> Upload Date</a>\n\n                <a class="dropdown-item" id="sortDateUp"><i class="fas fa-sort-numeric-up"></i> Upload Date</a>\n                    </div>\n                  </div>\n                  <label class="btn btn-success float-left mr-1 mb-0 bg-colour-1" for="fileUploadBtn"><i class="fas fa-file-import"></i> Upload File(s)</label>\n                  <input id="fileUploadBtn" multiple accept="${W}" type="file" class="btn btn-success float-left bg-colour-1" id="uploadFileBtn">\n                  <label class="btn btn-info float-left mr-1 mb-0 bg-colour-2" for="fileUploadPrintBtn"><i class="fas fa-file-import"></i> Upload and Print</label>\n                  <input id="fileUploadPrintBtn" accept="${W}" type="file" class="btn btn-success float-left bg-colour-2" id="uploadFileBtn">\n                <button\n                  id="createFolderBtn"\n                  type="button"\n                  class="btn btn-warning float-left mr-1 mb-0 bg-colour-3"\n                  data-toggle="collapse"\n                  href="#createFolder"\n                  role="button"\n                  aria-expanded="false"\n                  aria-controls="createFolder"\n                >\n                  <i class="fas fa-folder-plus"></i> Create Folder\n                </button>\n                <button id="fileReSync" type="button" class="btn btn-primary mb-0 bg-colour-4">\n                  <i class="fas fa-sync"></i> Re-Sync\n                </button>\n                </div>\n\n            </div>\n          <div id="fileList-${e._id}" class="list-group" style="height:500px; min-height:500px;max-height:500px; overflow-y:scroll;">\n\n          </div>\n            `,A.loadSort(e._id),re.generateButtons(e)}catch(e){d.createAlert("error","Something has gone wrong with loading the File Manager... Hard Failure, please submit as a bug on github: "+e,0,"clicked"),console.error(e)}}static applyListeners(e){document.querySelectorAll("input.octoRange").forEach((e=>{e.addEventListener("input",(e=>{e.target.previousSibling.previousSibling.lastChild.innerHTML=`${e.target.value}%`}))})),pe.state,e.connectPage.connectButton.addEventListener("click",(t=>{e.connectPage.connectButton.disabled=!0,x.connect(e.connectPage.connectButton.value,pe)})),e.fileManager.uploadFiles.addEventListener("change",(function(){d.createAlert("warning","Your files for Printer: "+pe.printerName+" has begun. Please do not navigate away from this page.",3e3,"Clicked"),z.handleFiles(this.files,pe)})),e.fileManager.createFolderBtn.addEventListener("click",(e=>{z.createFolder(pe)})),e.fileManager.fileSearch.addEventListener("keyup",(e=>{z.search(pe._id)})),e.fileManager.uploadPrintFile.addEventListener("change",(function(){z.handleFiles(this.files,pe,"print")})),e.fileManager.back.addEventListener("click",(e=>{z.openFolder(void 0,void 0,pe)})),e.fileManager.syncFiles.addEventListener("click",(e=>{z.reSyncFiles(e,pe)}))}static grabPage(){return{mainPage:{title:document.getElementById("printerSelection"),status:document.getElementById("pmStatus")},connectPage:{printerPort:document.getElementById("printerPortDrop"),printerBaud:document.getElementById("printerBaudDrop"),printerProfile:document.getElementById("printerProfileDrop"),printerConnect:document.getElementById("printerConnect"),connectButton:document.getElementById("pmConnect"),portDropDown:document.getElementById("pmSerialPort"),baudDropDown:document.getElementById("pmBaudrate"),profileDropDown:document.getElementById("pmProfile")},printerControls:{filamentDrop:document.getElementById("filamentManagerFolderSelect"),fileUpload:document.getElementById("printerManagerUploadBtn")},fileManager:{printerStorage:document.getElementById("printerStorage"),fileFolderCount:document.getElementById("printerFileCount"),fileSearch:document.getElementById("searchFiles"),uploadFiles:document.getElementById("fileUploadBtn"),uploadPrintFile:document.getElementById("fileUploadPrintBtn"),syncFiles:document.getElementById("fileReSync"),back:document.getElementById("fileBackBtn"),createFolderBtn:document.getElementById("createFolderBtn")}}}static async applyState(e,t){void 0!==e.fileList&&(t.fileManager.fileFolderCount.innerHTML=`<i class="fas fa-file"></i> ${e.fileList.filecount} <i class="fas fa-folder"></i> ${e.fileList.folderCount}`),void 0!==e.storage?t.fileManager.printerStorage.innerHTML=`<i class="fas fa-hdd"></i> ${b.bytes(e.storage.free)} / ${b.bytes(e.storage.total)}`:t.fileManager.printerStorage.innerHTML=`<i class="fas fa-hdd"></i> ${b.bytes(0)} / ${b.bytes(0)}`,t.mainPage.status.innerHTML=e.printerState.state,t.mainPage.status.className=`btn btn-${e.printerState.colour.name} mb-2`}}function me(e,t){return`\n      <div class="btn-group">\n         <button  \n           title="Quickly connect/disconnect your printer"\n           id="printerQuickConnect-${e}"\n           type="button"\n           class="tag btn btn-danger btn-sm"\n           >\n              <i class="fas fa-toggle-off"></i>\n        </button>\n        <button title="Toggle your printers power"\n              id="printerPowerToggle-${e}"\n              class="btn btn-outline-danger btn-sm d-none" type="button"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>\n          <i id="printerStatus-${e}" class="fas fa-power-off" style="color: black;"></i>\n        </button>\n        <button type="button" class="btn btn-outline-info btn-sm dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n         <i class="fas fa-bars"></i>\n        </button>\n        <div class="dropdown-menu">\n            <h6 class="dropdown-header d-none"><i class="fas fa-print"></i> Actions</h6>\n            <a  \n             title="Runs a pre-configured gcode sequence so you can detect which printer this is."\n             id="printerFindMe-${e}"\n             type="button"\n             class="dropdown-item d-none"\n          >\n              <i class="fas fa-search"></i> Find Printer!\n          </a> \n          <a  \n             title="Uses the values from your selected filament and pre-heats to those values."\n             id="printerPreHeat-${e}"\n             type="button"\n         class="dropdown-item d-none"\n          >\n            <i class="fas fa-fire"></i> Pre-Heat\n          </a> \n          <h6 class="dropdown-header"><i class="fas fa-cogs"></i> Manage</h6>\n          <a title="Open OctoPrint"\n               id="printerWeb-${e}"\n               type="button"\n               class="dropdown-item"\n               target="_blank"\n               href="${t}" role="button"><i class="fas fa-globe-europe"></i> OctoPrint Web</a>\n            <a  \n               title="Terminate and reconnect OctoPrints Socket connection."\n               id="printerSyncButton-${e}"\n               type="button"\n               class="dropdown-item"\n            >\n                <i class="fas fa-sync"></i> Re-Connect Socket\n            </a> \n          <h6 id="printerPowerDivider" class="dropdown-header d-none"><i class="fas fa-print"></i> Printer Power</h6>\n          <a id="printerPowerOn-${e}" title="Turn on your printer" class="dropdown-item d-none" href="#"><i class="text-success fas fa-power-off"></i> Power On Printer</a>\n          <a id="printerPowerOff-${e}" title="Turn off your printer" class="dropdown-item d-none" href="#"><i class="text-danger fas fa-power-off"></i> Power Off Printer</a>\n          <h6 id="octoPrintPowerDivider" class="dropdown-header d-none"><i class="fab fa-octopus-deploy"></i> OctoPrint Power</h6>\n          <a id="printerRestartOctoPrint-${e}" title="Restart OctoPrint Service" class="dropdown-item d-none" href="#"><i class="text-warning fas fa-redo"></i> Restart OctoPrint</a>\n          <a id="printerRestartHost-${e}" title="Reboot OctoPrint Host" class="dropdown-item d-none" href="#"><i class="text-warning fas fa-sync-alt"></i> Reboot Host</a>\n          <a id="printerWakeHost-${e}" title="Wake up OctoPrint Host" class="dropdown-item d-none" href="#"><i class="text-success fas fa-power-off"></i> Wake Host</a>\n          <a id="printerShutdownHost-${e}" title="Shutdown OctoPrint Host" class="dropdown-item d-none" href="#"><i class="text-danger fas fa-power-off"></i> Shutdown Host</a>\n\n        </div>\n      </div>\n  `}function ge(e){let t=document.getElementById("printerQuickConnect-"+e);t.innerHTML='<i class="fas fa-toggle-on"></i>',t.classList.remove("btn-danger"),t.classList.add("btn-success"),t.title="Press to connect your printer!"}function he(e){let t=document.getElementById("printerQuickConnect-"+e);t.innerHTML='<i class="fas fa-toggle-off"></i>',t.classList.remove("btn-success"),t.classList.add("btn-danger"),t.title="Press to connect your printer!"}function be(e,t){document.getElementById(t).innerHTML=`\n    ${me(e._id,e.printerURL)}\n  `,class{static revealBulkPower(){let e=document.getElementById("bulkPowerBtn");e&&e.classList.contains("d-none")&&e.classList.remove("d-none")}static async powerButtons(e){}static async applyBtn(e){}}.applyBtn(e),null!=e.currentConnection&&null!=e.currentConnection.port&&"Offline"!=e.printerState.colour.category?ge(e._id):he(e._id),document.getElementById("printerQuickConnect-"+e._id).disabled="Offline"===e.printerState.colour.category,document.getElementById("printerWeb-"+e._id).href=e.printerURL,function(e){document.getElementById(`printerQuickConnect-${e._id}`).addEventListener("click",(async t=>{if(t.disabled=!0,document.getElementById("printerQuickConnect-"+e._id).classList.contains("btn-danger")){let t={};void 0!==e.connectionOptions?t={command:"connect",port:e.connectionOptions.portPreference,baudrate:parseInt(e.connectionOptions.baudratePreference),printerProfile:e.connectionOptions.printerProfilePreference}:(d.createAlert("warning",`${e.printerName} has no preferences saved, defaulting to AUTO...`,8e3,"Clicked"),t.command="connect",t.port="AUTO",t.baudrate=0,t.printerProfile="_default");let n=await x.post(e,"connection",t);void 0!==n?204===n.status?d.createAlert("success",`Successfully made connection attempt to ${e.printerName}...`,3e3,"Clicked"):d.createAlert("error",`There was an issue connecting to ${e.printerName} it's either not online, or the connection options supplied are not available...`,3e3,"Clicked"):d.createAlert("error",`No response from ${e.printerName}, is it online???`,3e3,"Clicked")}else bootbox.confirm({message:"Are you sure you want to disconnect your printer?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:async function(t){if(t){let t={command:"disconnect"},n=await x.post(e,"connection",t);void 0!==n?204===n.status?d.createAlert("success",`Successfully made disconnect attempt to ${e.printerName}...`,3e3,"Clicked"):d.createAlert("error",`There was an issue disconnecting to ${e.printerName} are you sure it's online?`,3e3,"Clicked"):d.createAlert("error",`No response from ${e.printerName}, is it online???`,3e3,"Clicked")}}})})),document.getElementById(`printerSyncButton-${e._id}`).addEventListener("click",(async t=>{t.target.disabled=!0;const n={id:e._id};let r=await I.post("printers/reSyncSockets",n);"error"!==r.status?d.createAlert("success",r.msg,3e3,"clicked"):d.createAlert("error",r.msg,3e3,"clicked"),t.target.disabled=!1}))}(e)}function ye(e,t,n,r,i){if(t=parseFloat(t),n=parseFloat(n),isNaN(t)&&(t=0),isNaN(n)&&(n=0),"Complete"===i)if(t>parseFloat(r.coolDown)){const r=`<i class="far fa-circle toolUnder"></i> ${t}°C <i class="fas fa-bullseye"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}else{const r=`<i class="far fa-circle toolUnder"></i> ${t}°C <i class="fas fa-bullseye toolUnder"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}else if("Active"===i)if(t>n-parseFloat(r.heatingVariation)&&t<n+parseFloat(r.heatingVariation)){const r=`<i class="far fa-circle toolOn"></i> ${t}°C <i class="fas fa-bullseye toolOn"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}else if(t<parseFloat(r.heatingVariation)){const r=`<i class="far fa-circle"></i> ${t}°C <i class="fas fa-bullseye"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}else{const r=`<i class="far fa-circle toolOut"></i> ${t}°C <i class="fas fa-bullseye toolOut"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}else{const r=`<i class="far fa-circle"></i> ${t}°C <i class="fas fa-bullseye"></i> ${n}°C`;e&&e.innerHTML!==r&&(e.innerHTML=r)}}const ve=({url:e,flipV:t,flipH:n,rotate90:r})=>`<img\n        loading="lazy"\n        class="camImg"\n        id="camera-${printer._id}"\n        width="100%"\n        style="transform: ${n} ${t} ${r}";\n        src="${e}"\n     alt=""/>`;function we(e){let t=`background-color: ${e} !important;`,n="btn-outline-dark";return"default"===e?(t="",n="btn-secondary"):"black"===e&&(n="btn-outline-light"),{colourStyle:t,buttonStyle:n}}function Ee(e,t){let n="";return("Offline"===e&&t.views.showOffline||"Disconnected"===e&&t.views.showDisconnected)&&(n="hidden"),n}function _e(e){const t=function(e){let t="",n="",r="";return e&&(e.webCamSettings.flipH&&(t="rotateY(180deg)"),e.webCamSettings.flipV&&(n="rotateX(180deg)"),e.webCamSettings.rotate90&&(r="rotate(90deg)")),{flipH:t,flipV:n,rotate90:r}}(e.otherSettings),{flipH:n,flipV:r,rotate90:i}=t;return e.otherSettings?""!==e.camURL?ve({url:e.camURL,flipV:r,flipH:n,rotate90:i}):void 0!==e.currentJob&&null!=e.currentJob.thumbnail?ve({url:e.printerURL+"/"+e.currentJob.thumbnail,flipV:r,flipH:n,rotate90:i}):ve({url:"../images/noCamera.jpg",flipV:r,flipH:n,rotate90:i}):void 0!==e.currentJob&&null!=e.currentJob.thumbnail?ve({url:e.printerURL+"/"+e.currentJob.thumbnail,flipV:r,flipH:n,rotate90:i}):ve({url:"",flipV:r,flipH:n,rotate90:i})}function Le(e,t){const n=Ee(e,t),r=e.printerName;let i=_e(e),o="",a="";if(e.currentProfile){for(let t=0;t<e.currentProfile.extruder.count;t++)o+='<div class="btn-group btn-block mb-1" role="group" aria-label="Basic example">',o+=`<button type="button" class="btn btn-secondary btn-sm" disabled><b>Tool ${t} </b></button><button disabled id="${e._id}-spool-${t}" type="button" class="btn btn-secondary  btn-sm"> No Spool </button><button id="${e._id}-temperature-${t}" type="button" class="btn btn-secondary btn-sm" disabled><i class="far fa-circle "></i> 0°C <i class="fas fa-bullseye"></i> 0°C</button>`,o+="</div>";e.currentProfile.heatedBed&&(a+='<div class="btn-group btn-block mb-1" role="group" aria-label="Basic example">',a+=`<button type="button" class="btn btn-secondary btn-sm" disabled><b>Bed: </b></button><button type="button" class="btn btn-secondary btn-sm" disabled><span id="badTemp-${e._id}"><i class="far fa-circle "></i> 0°C <i class="fas fa-bullseye"></i> 0°C</span></button>`,a+="</div>"),e.currentProfile.heatedChamber&&(a+='<div class="btn-group btn-block mb-1" role="group" aria-label="Basic example">',a+=`<button type="button" class="btn btn-secondary btn-sm" disabled><b>Chamber: </b></button><button type="button" class="btn btn-secondary btn-sm" disabled><span  id="chamberTemp-${e._id}"><i class="far fa-circle "></i> 0°C <i class="fas fa-bullseye"></i> 0°C</span></button>`,a+="</div>")}const s=function(e){return e.otherSettings&&""!==e.camURL||void 0!==e.currentJob&&null!=e.currentJob.thumbnail}(e),l={cameraColumn:"col-sm-12 col-md-5 col-lg-4 col-xl-3",mainColumn:"col-sm-12 col-md-7 col-lg-8 col-xl-9"};s||(l.cameraColumn="d-none",l.mainColumn="col-12");const{buttonStyle:c,colourStyle:u}=we(e.settingsAppearance.color);return`\n     <div class="card ${n} mb-3" id="panel-${e._id}">\n        <div class="d-none index">${e.sortIndex}</div>\n        <div class="col-12">\n            <div class="row">\n             \n                <div class="${l.cameraColumn}">\n                   <div id="cameraContain-${e._id}" class="noBlue text-center">\n                      <div style="width:90%;" class=" m-auto">\n                        ${i}\n                      </div>\n                    </div>\n                </div>\n                <div class="${l.mainColumn}">\n     \n                   <div class="row">\n                        <div class="col-sm-12 col-md-12 col-lg-6">\n                          <button\n                            id="name-${e._id}"\n                            type="button"\n                            class="btn btn-block ${c} btn-sm text-left"\n                            role="button"\n                            style="${u}"\n                            disabled\n                          >\n                            ${r}\n                          </button>\n                        </div>\n                        <div class="col-sm-6 col-md-6 col-lg-4">\n                          <button\n                            id="state-${e._id}"\n                            type="button"\n                            class="btn btn-block btn-sm ${e.printerState.colour.category}"\n                            role="button"\n                            disabled\n                          >\n                            ${e.printerState.state}\n                          </button>\n                        </div>\n                        <div class="col-sm-6 col-md-6 col-lg-2">\n                         <small class="float-right" id="printerActionBtns-${e._id}">\n\n                          </small>\n                        </div>\n                    </div>\n            \n                   <div class="row">\n                     <div class="col-12">\n                        <div class="progress">\n                        <div\n                          id="progress-${e._id}"\n                          class="progress-bar progress-bar-striped bg-${e.printerState.colour.name} percent"\n                          role="progressbar progress-bar-striped"\n                          style="width: 0%"\n                          aria-valuenow="0"\n                          aria-valuemin="0"\n                          aria-valuemax="100"\n                        >\n                          0%\n                        </div>\n                      </div>\n                     </div> \n                   </div> \n                   <div class="row">\n                      <div class="col-sm-12 col-md-12 col-lg-8">\n                        <button\n                                id="currentFile-${e._id}"\n                                type="button"\n                                class="btn btn-block btn-secondary text-truncate btn-sm"\n                                role="button"\n                                title="Loading..."\n                                disabled\n                        >\n                            <i class="fas fa-file-code" ></i> No File Selected\n                        </button>\n                        <div id="filesViewProgressWrapper-${e._id}" class="progress d-none">\n                            <div id="filesViewProgressBar-${e._id}" class="progress-bar progress-bar-striped bg-success" role="progressbar" style="width: 0%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">0%</div>\n                        </div>\n                        <div class="row">\n                        <div class="col-sm-12 col-md-6 col-lg-6 text-center">\n                          <button\n                            title="Start your currently selected print"\n                            id="play-${e._id}"\n                            type="button"\n                            class="tag btn btn-success mt-1 mb-1 btn-sm"\n                            role="button"\n                            disabled\n                          >\n                            <i class="fas fa-play-circle"></i> Print\n                          </button>\n                          <button\n                                  title="Pause your current print"\n                            id="pause-${e._id}"\n                            type="button"\n                            class="tag btn btn-light mt-1 mb-1 btn-sm"\n                            role="button"\n                            disabled\n                          >\n                            <i class="fas fa-pause"></i> Pause\n                          </button>\n                          <button\n                            title="Restart your current print"\n                            id="restart-${e._id}"\n                            type="button"\n                            class="tag btn btn-danger mt-1 mb-1 hidden btn-sm"\n                            role="button"\n                            disabled\n                          >\n                            <i class="fas fa-undo"></i> Restart\n                          </button>\n                          <button\n                                  title="Resume your current print"\n                            id="resume-${e._id}"\n                            type="button"\n                            class="tag btn btn-success mt-1 mb-1 hidden btn-sm"\n                            role="button"\n                            disabled\n                          >\n                            <i class="fas fa-redo"></i> Resume\n                          </button>\n                          <button\n                                  title="Stop your current print"\n                            id="cancel-${e._id}"\n                            type="button"\n                            class="tag btn btn-danger mt-1 mb-1 btn-sm"\n                            role="button"\n                            disabled\n                          >\n                            <i class="fas fa-square"></i> Cancel\n                          </button> <br>\n                          <button\n                            title="Select and Manager your printers files"\n                            id="printerFilesBtn-${e._id}"\n                            type="button"\n                            class="tag btn btn-outline-warning mt-1 mb-1 btn-sm"\n                            role="button"\n                            data-toggle="modal"\n                            data-target="#printerManagerModal"\n                          >\n                            <i class="fas fa-file-code"></i> Files\n                          </button>\n                          <button\n                                  title="Control your printer"\n                            id="printerButton-${e._id}"\n                            type="button"\n                            class="tag btn btn-outline-success mt-1 mb-1 btn-sm"\n                            role="button"\n                            data-toggle="modal"\n                            data-target="#printerManagerModal"\n                          >\n                            <i class="fas fa-print"></i> Control\n                          </button>\n                          <button  \n                           title="Printers Terminal"\n                           id="printerTerminalButton-${e._id}"\n                           type="button"\n                           class="tag btn btn-outline-info btn-sm"\n                           data-toggle="modal"\n                           data-target="#printerManagerModal"\n                           >\n                              <i class="fas fa-terminal"></i> Terminal\n                        </button>\n                        </div>\n                        <div class="col-sm-12 col-md-6 col-lg-6 text-center">\n                           <div class="row">\n                            <div class="col-12">\n                              <small id="displayLayerProgressData-${e._id}"></small>\n                             </div>\n                            <div class="col-6">\n                                <span id="printTimeElapsed-${e._id}">Loading...</span>\n                            </div>\n                            <div class="col-6">\n                                      <span id="remainingTime-${e._id}">\n                                Loading...\n                            </span>\n                            </div> \n                          </div>\n                        </div>  \n                        </div>\n                      </div>\n                      <div class="col-sm-12 col-md-12 col-lg-4">\n                        <div\n                          id="listFilament-${e._id}" disabled\n                          class="bg-dark"\n                        >\n                          ${o}\n                        </div>\n                        <div>\n                          ${a}\n                        </div>\n                      </div>\n                   </div>\n                </div>\n            </div>\n        </div>\n     </div>   \n    `}let Be=0,Te=null,Se=!1;$("#printerManagerModal").on("hidden.bs.modal",(function(e){document.getElementById("printerControlCamera")&&(document.getElementById("printerControlCamera").src="")})),$("#connectionModal").on("hidden.bs.modal",(function(e){document.getElementById("connectionAction")&&document.getElementById("connectionAction").remove()}));class Ie{static async init(e,t,n){if(""!==e){document.getElementById("printerControlCamera")&&(document.getElementById("printerControlCamera").src=""),Be=e;const r=_.findIndex(t,(function(t){return t._id==e}));Te=t[r];const i=function(e){Ie.init(e,t,n)};ae(Te._id,n,i,!0);const o=await te();await Ie.loadPrinter(Te,n,o);const a=Ie.grabPage();a.terminal.terminalWindow.innerHTML="",Ie.applyState(Te,a),Ie.applyListeners(a,t,o)}else if(document.getElementById("terminal")){const e=_.findIndex(t,(function(e){return e._id==Be}));Te=t[e];const n=Ie.grabPage();Ie.applyState(Te,n),document.getElementById("printerManagerModal").style.overflow="auto"}}static async loadPrinter(e,t,n){try{const t=document.getElementById("printerPortDrop"),n=document.getElementById("printerBaudDrop"),r=document.getElementById("printerProfileDrop"),i=document.getElementById("printerConnect");t.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardSerialPort">Port:</label> </div> <select class="custom-select bg-secondary text-light" id="pmSerialPort"></select></div>\n    ',n.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardBaudrate">Baudrate:</label> </div> <select class="custom-select bg-secondary text-light" id="pmBaudrate"></select></div>\n    ',r.innerHTML='\n    <div class="input-group mb-1"> <div class="input-group-prepend"> <label class="input-group-text bg-secondary text-light" for="dashboardPrinterProfile">Profile:</label> </div> <select class="custom-select bg-secondary text-light" id="pmProfile"></select></div>\n    ',e.connectionOptions.baudrates.forEach((e=>{0!==e?document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`):document.getElementById("pmBaudrate").insertAdjacentHTML("beforeend",`<option value="${e}">AUTO</option>`)})),null!=e.connectionOptions.baudratePreference&&(document.getElementById("pmBaudrate").value=e.connectionOptions.baudratePreference),e.connectionOptions.ports.forEach((e=>{document.getElementById("pmSerialPort").insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)})),null!=e.connectionOptions.portPreference&&(document.getElementById("pmSerialPort").value=e.connectionOptions.portPreference),e.connectionOptions.printerProfiles.forEach((e=>{document.getElementById("pmProfile").insertAdjacentHTML("beforeend",`<option value="${e.id}">${e.name}</option>`)})),null!=e.connectionOptions.printerProfilePreference&&(document.getElementById("pmProfile").value=e.connectionOptions.printerProfilePreference),"Disconnected"===e.printerState.state||"Error!"===e.printerState.state?(i.innerHTML='<center> <button id="pmConnect" class="btn btn-success inline" value="connect">Connect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="powerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1):(i.innerHTML='<center> <button id="pmConnect" class="btn btn-danger inline" value="disconnect">Disconnect</button><a title="Open your Printers Web Interface" id="pmWebBtn" type="button" class="tag btn btn-info ml-1" target="_blank" href="'+e.printerURL+'" role="button"><i class="fas fa-globe-europe"></i></a><div id="pmPowerBtn-'+e._id+'" class="btn-group ml-1"></div></center>',document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0);let o=await I.getServerSettings();return Se=o.filamentManager,document.getElementById("printerControls").innerHTML='\n          <div class="row">\n                <div class="col-12">\n                    <center>\n                        <h5>Custom Gocde Scripts</h5>\n                    </center>\n                    <hr>\n                </div>\n              <div id="customGcodeCommandsArea" class="col-lg-12 text-center">\n              </div>\n          </div>\n          <div class="row">\n                <div class="col-12">\n                    <center>\n                        <h5>Terminal</h5>\n                    </center>\n                    <hr>\n                </div>\n                </div>\n                <div class="row">\n                 <div id="terminal" class="terminal-window bg-secondary">\n                  </div>\n                    <div class="input-group">\n                      <textarea id="terminalInput" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="basic-addon2"></textarea>\n                      <div class="input-group-append">\n                        <button class="btn btn-secondary" id="terminalInputBtn" type="submit">Send</button>\n                      </div>\n                    </div>\n                    <form class="was-validated">\n                      <div class="custom-control custom-checkbox mb-3">\n                        <input \n                        type="checkbox" class="custom-control-input" id="tempMessages" required checked>\n                        <label class="custom-control-label" for="tempMessages">Temperature Messages</label>\n                        <div class="valid-feedback">Showing temperature messages</div>\n                        <div class="invalid-feedback">Not showing temperature messages</div>\n                      </div>\n                      </form>\n                      <form class="was-validated">\n                       <div class="custom-control custom-checkbox mb-3">\n                        <input\n                        type="checkbox" class="custom-control-input" id="sdMessages" required checked>\n                        <label class="custom-control-label" for="sdMessages">SD Messages</label>\n                        <div class="valid-feedback">Showing sd messages</div>\n                        <div class="invalid-feedback">Not showing sd messages</div>\n                      </div>\n                      </form>\n                      <form class="was-validated">\n                      <div class="custom-control custom-checkbox mb-3">\n                        <input\n                        type="checkbox" class="custom-control-input" id="waitMessages" required checked>\n                        <label class="custom-control-label" for="waitMessages">Wait Responses</label>\n                        <div class="valid-feedback">Showing wait responses</div>\n                        <div class="invalid-feedback">Not showing wait responses</div>\n                      </div>\n                      </form>\n                </div>\n            </div>\n            ',re.generateButtons(e),!0}catch(e){d.createAlert("error","Something has gone wrong with loading the Printer Manager... Hard Failure, please submit as a bug on github: "+e,0,"clicked"),console.error(e)}}static applyListeners(e){Te.state,e.connectPage.connectButton.addEventListener("click",(t=>{e.connectPage.connectButton.disabled=!0,x.connect(e.connectPage.connectButton.value,Te)}));const t=async function(t){let n=e.terminal.input.value.match(/[^\r\n]+/g);if(null===n)return null;n=n.map((function(e){return e.includes("=")?e:e.toLocaleUpperCase()})),e.terminal.input.value="";const r=function(){e.terminal.sendBtn.classList="btn btn-secondary"},i={commands:n};204===(await x.post(Te,"printer/command",i)).status?(e.terminal.sendBtn.classList="btn btn-success",setTimeout(r,500)):(e.terminal.sendBtn.classList="btn btn-danger",setTimeout(r,500))};e.terminal.input.addEventListener("keypress",(async e=>{"Enter"!==e.key||e.shiftKey||t()})),e.terminal.sendBtn.addEventListener("click",(async e=>{t()}))}static grabPage(){return{mainPage:{title:document.getElementById("printerSelection"),status:document.getElementById("pmStatus")},jobStatus:{expectedCompletionDate:document.getElementById("pmExpectedCompletionDate"),expectedTime:document.getElementById("pmExpectedTime"),remainingTime:document.getElementById("pmTimeRemain"),elapsedTime:document.getElementById("pmTimeElapsed"),currentZ:document.getElementById("pmCurrentZ"),fileName:document.getElementById("pmFileName"),progressBar:document.getElementById("pmProgress"),expectedWeight:document.getElementById("pmExpectedWeight"),expectedPrinterCost:document.getElementById("pmExpectedPrinterCost"),expectedFilamentCost:document.getElementById("pmExpectedFilamentCost"),expectedTotalCosts:document.getElementById("pmJobCosts"),printerResends:document.getElementById("printerResends"),resendTitle:document.getElementById("resentTitle"),dlpPluginDataTitle:document.getElementById("dlpPluginDataTitle"),dlpPluginDataData:document.getElementById("dlpPluginDataData")},connectPage:{printerPort:document.getElementById("printerPortDrop"),printerBaud:document.getElementById("printerBaudDrop"),printerProfile:document.getElementById("printerProfileDrop"),printerConnect:document.getElementById("printerConnect"),connectButton:document.getElementById("pmConnect"),portDropDown:document.getElementById("pmSerialPort"),baudDropDown:document.getElementById("pmBaudrate"),profileDropDown:document.getElementById("pmProfile")},terminal:{terminalWindow:document.getElementById("terminal"),sendBtn:document.getElementById("terminalInputBtn"),input:document.getElementById("terminalInput")},printerControls:{filamentDrop:document.getElementById("filamentManagerFolderSelect"),fileUpload:document.getElementById("printerManagerUploadBtn"),xPlus:document.getElementById("pcXpos"),xMinus:document.getElementById("pcXneg"),yPlus:document.getElementById("pcYpos"),yMinus:document.getElementById("pcYneg"),xyHome:document.getElementById("pcXYhome"),zPlus:document.getElementById("pcZpos"),zMinus:document.getElementById("pcZneg"),zHome:document.getElementById("pcZhome"),step01:document.getElementById("pcAxisSteps01"),step1:document.getElementById("pcAxisSteps1"),step10:document.getElementById("pcAxisSteps10"),step100:document.getElementById("pcAxisSteps100"),feedRate:document.getElementById("pcFeedRate"),flowRate:document.getElementById("pcFlowRate"),feedRateValue:document.getElementById("pcFeedValue"),flowRateValue:document.getElementById("pcFlowValue"),motorsOff:document.getElementById("pcMotorTog"),fanPercent:document.getElementById("pcFanPercent"),fansOn:document.getElementById("pcFanOn"),fansOff:document.getElementById("pcFanOff"),extruder:document.getElementById("pcExtruder"),extrude:document.getElementById("pcExtrude"),retract:document.getElementById("pcRetract"),progress:document.getElementById("pcAxisSteps100"),printStart:document.getElementById("pmPrintStart"),printPause:document.getElementById("pmPrintPause"),printRestart:document.getElementById("pmPrintRestart"),printResume:document.getElementById("pmPrintResume"),printStop:document.getElementById("pmPrintStop")},fileManager:{printerStorage:document.getElementById("printerStorage"),fileFolderCount:document.getElementById("printerFileCount"),fileSearch:document.getElementById("searchFiles"),uploadFiles:document.getElementById("fileUploadBtn"),uploadPrintFile:document.getElementById("fileUploadPrintBtn"),syncFiles:document.getElementById("fileReSync"),back:document.getElementById("fileBackBtn"),createFolderBtn:document.getElementById("createFolderBtn")},temperatures:{tempTime:document.getElementById("pmTempTime"),bed:document.querySelectorAll("[id^='bed']"),chamber:document.querySelectorAll("[id^='chamber']"),tools:document.querySelectorAll("[id^='tool']")},filamentDrops:document.querySelectorAll("[id$=FilamentManagerFolderSelect]")}}static async applyState(e,t){const n=t.terminal.terminalWindow.scrollHeight-t.terminal.terminalWindow.clientHeight<=t.terminal.terminalWindow.scrollTop+1;if(t.terminal.terminalWindow.innerHTML="",void 0!==e.terminal){const n=document.getElementById("waitMessages").checked,r=document.getElementById("tempMessages").checked,i=document.getElementById("sdMessages").checked;for(let o=0;o<e.terminal.length;o++){const a=/(Send: (N\d+\s+)?M105)|(Recv:\s+(ok\s+)?.*(B|T\d*):\d+)/,s=/(Send: (N\d+\s+)?M27)|(Recv: SD printing byte)/,l=/Recv: Not SD printing/,c=/Recv: wait/;e.terminal[o].match(a)?r?t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine temperatureMessage">${e.terminal[o]}</div>\n        `):t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine temperatureMessage d-none">${e.terminal[o]}</div>\n        `):e.terminal[o].match(s)||e.terminal[o].match(l)?i?t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine sdMessage">${e.terminal[o]}</div>\n        `):t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine sdMessage d-none">${e.terminal[o]}</div>\n        `):e.terminal[o].match(c)?n?t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine waitMessage">${e.terminal[o]}</div>\n        `):t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine waitMessage d-none">${e.terminal[o]}</div>\n        `):t.terminal.terminalWindow.insertAdjacentHTML("beforeend",`\n          <div id="logLine${o}" class="logLine">${e.terminal[o]}</div>\n        `)}}n&&(t.terminal.terminalWindow.scrollTop=t.terminal.terminalWindow.scrollHeight-t.terminal.terminalWindow.clientHeight),t.mainPage.status.innerHTML=e.printerState.state,t.mainPage.status.className=`btn btn-${e.printerState.colour.name} mb-2`}}let xe=[],Pe=[],Ce=2e4,ke=document.getElementById("printerManagerModal");const Me=document.getElementById("printerManagerModalTitle");let Ae,$e=document.getElementById("printerArea");document.getElementById("filterStates").addEventListener("change",(e=>{$e.innerHTML="",xe=[],Pe=[],Ae=!1,I.get("client/updateFilter/"+e.target.value)})),document.getElementById("sortStates").addEventListener("change",(e=>{$e.innerHTML="",xe=[],Pe=[],Ae=!1,I.get("client/updateSorting/"+e.target.value)}));const Oe=e=>{const t=a();return void 0!==e?t[_.findIndex(t,(function(t){return t._id==e}))]:t};function He(e){document.getElementById(`printerButton-${e._id}`).addEventListener("click",(async()=>{Me.innerHTML="Printer Control: ";const t=a(),n=s();await ue.init(e._id,t,n)})),document.getElementById(`printerFilesBtn-${e._id}`).addEventListener("click",(async()=>{Me.innerHTML="Printer Files: ";const t=a(),n=s();await fe.init(e._id,t,n)})),document.getElementById(`printerTerminalButton-${e._id}`).addEventListener("click",(async()=>{Me.innerHTML="Printer Terminal: ";const t=a(),n=s();await Ie.init(e._id,t,n)}));let t=document.getElementById("play-"+e._id);t&&t.addEventListener("click",(t=>{t.target.disabled=!0;const n=Oe(e._id);x.jobAction(n,{command:"start"},t)}));let n=document.getElementById("cancel-"+e._id);n&&n.addEventListener("click",(t=>{const n=Oe(e._id),r=e.printerName;bootbox.confirm({message:`${r}: <br>Are you sure you want to cancel the ongoing print?`,buttons:{cancel:{label:'<i class="fa fa-times"></i> Cancel'},confirm:{label:'<i class="fa fa-check"></i> Confirm'}},callback(e){if(e){t.target.disabled=!0;const e={command:"cancel"};x.jobAction(n,e,t)}}})}));let r=document.getElementById("restart-"+e._id);r&&r.addEventListener("click",(t=>{t.target.disabled=!0;const n=Oe(e._id);x.jobAction(n,{command:"restart"},t)}));let i=document.getElementById("pause-"+e._id);i&&i.addEventListener("click",(t=>{t.target.disabled=!0;const n=Oe(e._id);x.jobAction(n,{command:"pause",action:"pause"},t)}));let o=document.getElementById("resume-"+e._id);o&&o.addEventListener("click",(t=>{t.target.disabled=!0;const n=Oe(e._id);x.jobAction(n,{command:"pause",action:"resume"},t)}));let l=document.getElementById("cameraContain-"+e._id);return l&&l.addEventListener("dblclick",(e=>{var t;"submit"!=(t=e.target).type&&(t.requestFullscreen(),document.fullscreenElement&&document.exitFullscreen())})),"done"}function Re(e){return void 0!==xe[e._id]||(xe[e._id]={row:document.getElementById("panel-"+e._id),name:document.getElementById("name-"+e._id),control:document.getElementById("printerButton-"+e._id),files:document.getElementById("printerFilesBtn-"+e._id),terminal:document.getElementById("printerTerminalButton-"+e._id),connect:document.getElementById("printerQuickConnect-"+e._id),start:document.getElementById("play-"+e._id),stop:document.getElementById("cancel-"+e._id),pause:document.getElementById("pause-"+e._id),restart:document.getElementById("restart-"+e._id),resume:document.getElementById("resume-"+e._id),camera:document.getElementById("camera-"+e._id),currentFile:document.getElementById("currentFile-"+e._id),currentFilament:document.getElementById("currentFilament-"+e._id),state:document.getElementById("state-"+e._id),layerData:document.getElementById("displayLayerProgressData-"+e._id),printTimeElapsed:document.getElementById("printTimeElapsed-"+e._id),remainingPrintTime:document.getElementById("remainingTime-"+e._id),cameraContain:document.getElementById("cameraContain-"+e._id),progress:document.getElementById("progress-"+e._id),bed:document.getElementById("badTemp-"+e._id),chamber:document.getElementById("chamberTemp-"+e._id)}),xe[e._id]}async function Fe(e,t,n,r){const i=Re(e);if(void 0===i.row)return;if(i.row.style.order=r,!e.display)return void("none"!==i.row.style.display&&(i.row.style.display="none"));if("none"===i.row.style.display)switch(n){case"list":i.row.style.display="table";break;case"panel":case"camera":i.row.style.display="block"}!function(e){const t="Offline"===e.printerState.colour.category||"Disabled"===e.printerState.colour.category;document.getElementById("printerQuickConnect-"+e._id).disabled=t,document.getElementById("printerSyncButton-"+e._id).disabled=t,void 0!==e.connectionOptions&&null!==e.connectionOptions.portPreference&&null!==e.connectionOptions.baudratePreference&&null!==e.connectionOptions.printerProfilePreference||(document.getElementById("printerQuickConnect-"+e._id).disabled=!0),"Offline"!==e.printerState.colour.category&&"Disconnected"===e.printerState.colour.category||"Error!"===e.printerState.colour.category?he(e._id):"Offline"!==e.printerState.colour.category&&"Disconnected"!==e.printerState.colour.category&&"Error!"!==!e.printerState.colour.category?ge(e._id):he(e._id)}(e);const o="Offline"===e.printerState.colour.category;i.control.disabled=o,i.files.disabled=o,i.terminal.disabled=o,d.doesElementNeedUpdating(e.printerState.state,i.state,"innerHTML");let a=e.printerState.colour.category;switch("Error!"===a&&(a="Offline"),d.doesElementNeedUpdating(e.printerName,i.name,"innerHTML"),n){case"list":d.doesElementNeedUpdating(a,i.row,"classList");break;case"panel":d.doesElementNeedUpdating(`btn btn-block ${a} mb-1 mt-1`,i.state,"classList");break;case"camera":d.doesElementNeedUpdating(`card-body cameraContain text-truncate noBlue ${a}`,i.cameraContain,"classList")}if(d.doesElementNeedUpdating(`progress-bar progress-bar-striped bg-${e.printerState.colour.name}`,i.progress,"classList"),void 0!==e.currentJob){let t=0;if("number"==typeof e.currentJob.progress&&(t=e.currentJob.progress),d.doesElementNeedUpdating(t+"%",i.progress,"innerHTML"),i.progress.style.width=t+"%",i.currentFile.setAttribute("title",e.currentJob.filePath),i.currentFile.innerHTML='<i class="fas fa-file-code"></i> '+e.currentJob.fileDisplay,"Active"===e.printerState.colour.category){let t=`\n        <small title="Print Time Elapsed">\n            <i class="fas fa-hourglass-start"></i> ${b.generateTime(e.currentJob.printTimeElapsed)}\n        </small>\n        <br>\n        <small title="Expected Print Time">\n            <i class="fas fa-clock"></i> ${b.generateTime(e.currentJob.expectedPrintTime)}\n        </small>\n      `,n=`\n        <small title="Print Time Remaining">\n            <i class="fas fa-hourglass-end"></i> ${b.generateTime(e.currentJob.printTimeRemaining)}\n        </small>\n        <br>\n        <small title="Estimated Time of Arrival">\n        <i class="fas fa-calendar-alt"></i> ${e.currentJob.expectedCompletionDate}\n        </small>\n      `;d.doesElementNeedUpdating(t,i.printTimeElapsed,"innerHTML"),d.doesElementNeedUpdating(n,i.remainingPrintTime,"innerHTML")}else if("Complete"===e.printerState.colour.category){let t=`\n        <small title="Print Time Elapsed">\n            <i class="fas fa-hourglass-start"></i> ${b.generateTime(e.currentJob.printTimeElapsed)}\n        </small>\n        <br>\n        <small title="Expected Print Time">\n            <i class="fas fa-clock"></i> ${b.generateTime(e.currentJob.expectedPrintTime)}\n        </small>\n      `,n='\n        <small title="Print Time Remaining">\n            <i class="fas fa-hourglass-end"></i> 0\n        </small>\n        <br>\n        <small title="Estimated Time of Arrival">\n        <i class="fas fa-calendar-alt"></i> Complete!\n        </small>\n      ';d.doesElementNeedUpdating(t,i.printTimeElapsed,"innerHTML"),d.doesElementNeedUpdating(n,i.remainingPrintTime,"innerHTML")}else{let e='\n        <small title="Print Time Elapsed">\n            <i class="fas fa-hourglass-start"></i> No Active Print\n        </small>\n        <br>\n        <small title="Expected Print Time">\n            <i class="fas fa-clock"></i> No Active Print\n        </small>\n      ',t='\n        <small title="Print Time Remaining">\n            <i class="fas fa-hourglass-end"></i> No Active Print\n        </small>\n        <br>\n        <small title="Estimated Time of Arrival">\n        <i class="fas fa-calendar-alt"></i> No Active Print\n        </small>\n      ';d.doesElementNeedUpdating(e,i.printTimeElapsed,"innerHTML"),d.doesElementNeedUpdating(t,i.remainingPrintTime,"innerHTML")}}else{let e='\n        <small title="Print Time Elapsed">\n            <i class="fas fa-hourglass-start"></i> No Active Print\n        </small>\n        <br>\n        <small title="Expected Print Time">\n            <i class="fas fa-clock"></i> No Active Print\n        </small>\n      ',t='\n        <small title="Print Time Remaining">\n            <i class="fas fa-hourglass-end"></i> No Active Print\n        </small>\n        <br>\n        <small title="Estimated Time of Arrival">\n        <i class="fas fa-calendar-alt"></i> No Active Print\n        </small>\n      ';d.doesElementNeedUpdating("0%",i.progress,"innerHTML"),i.progress.style.width="0%",d.doesElementNeedUpdating(e,i.printTimeElapsed,"innerHTML"),d.doesElementNeedUpdating(t,i.remainingPrintTime,"innerHTML"),i.currentFile.setAttribute("title","No File Selected"),i.currentFile.innerHTML='<i class="fas fa-file-code"></i> No File Selected'}if(e?.layerData){const t=`<i class="fas fa-layer-group"></i> ${e.layerData.currentLayer} / ${e.layerData.totalLayers} (${e.layerData.percentComplete}%)`;d.doesElementNeedUpdating(t,i.layerData,"innerHTML")}if(e.tools){const t=Object.keys(e.tools[0]);for(let n=0;n<t.length;n++)if(t[n].includes("tool")){const r=t[n].replace("tool","");document.getElementById(e._id+"-temperature-"+r)?ye(document.getElementById(e._id+"-temperature-"+r),e.tools[0][t[n]].actual,e.tools[0][t[n]].target,e.otherSettings.temperatureTriggers,e.printerState.colour.category):ye(document.getElementById(e._id+"-temperature-"+r),0,0,e.otherSettings.temperatureTriggers,e.printerState.colour.category)}else t[n].includes("bed")?i.bed&&ye(i.bed,e.tools[0][t[n]].actual,e.tools[0][t[n]].target,e.otherSettings.temperatureTriggers,e.printerState.colour.category):t[n].includes("chamber")&&i.chamber&&ye(i.chamber,e.tools[0][t[n]].actual,e.tools[0][t[n]].target,e.otherSettings.temperatureTriggers,e.printerState.colour.category)}if(Array.isArray(e.selectedFilament))for(let t=0;t<e.selectedFilament.length;t++){const n=document.getElementById(`${e._id}-spool-${t}`);null!==e.selectedFilament[t]?n&&(n.innerHTML=`${e.selectedFilament[t]?.spools?.profile?.material}`):n&&(n.innerHTML="No Spool")}let s="",l="";t?.views?.showDisconnected||(s="hidden"),t?.views?.showOffline||(l="hidden"),"Active"===e.printerState.colour.category?(i.row.classList.contains(s)&&i.row.classList.remove(s),i.row.classList.contains(l)&&i.row.classList.remove(l),i.start&&(i.start.disabled=!0),i.stop&&(i.stop.disabled=!1),"Pausing"===e.printerState.state?(i.start&&i.start.classList.remove("hidden"),i.stop&&(i.stop.disabled=!1),i.resume&&i.resume.classList.add("hidden"),i.pause&&(i.pause.disabled=!0,i.pause.classList.remove("hidden")),i.restart&&(i.restart.disabled=!0,i.restart.classList.add("hidden"))):"Paused"===e.printerState.state?(i.start&&i.start.classList.add("hidden"),i.resume&&(i.resume.disabled=!1,i.resume.classList.remove("hidden")),i.pause&&(i.pause.disabled=!0,i.pause.classList.add("hidden")),i.restart&&(i.restart.disabled=!1,i.restart.classList.remove("hidden"))):(i.start&&i.start.classList.remove("hidden"),i.resume&&(i.resume.disabled=!0,i.resume.classList.add("hidden")),i.pause&&(i.pause.disabled=!1,i.pause.classList.remove("hidden")),i.restart&&(i.restart.disabled=!0,i.restart.classList.add("hidden")))):"Idle"===e.printerState.colour.category||"Complete"===e.printerState.colour.category?(i.row.classList.contains(s)&&i.row.classList.remove(s),i.row.classList.contains(l)&&i.row.classList.remove(l),e.currentJob&&"No File Selected"!==e.currentJob.fileName?(i.start&&(i.start.disabled=!1),i.stop&&(i.stop.disabled=!0),i.resume&&(i.resume.disabled=!0),i.pause&&(i.pause.disabled=!0),i.restart&&(i.restart.disabled=!0)):(i.start&&(i.start.disabled=!0),i.stop&&(i.stop.disabled=!0),i.resume&&(i.resume.disabled=!0),i.pause&&(i.pause.disabled=!0),i.restart&&(i.restart.disabled=!0)),"Paused"===e.printerState.state?(i.start&&i.start.classList.add("hidden"),i.stop&&(i.stop.disabled=!1),i.resume&&(i.resume.disabled=!1,i.resume.classList.remove("hidden")),i.pause&&(i.pause.disabled=!0,i.pause.classList.add("hidden")),i.restart&&(i.restart.disabled=!1,i.restart.classList.remove("hidden"))):(i.start&&i.start.classList.remove("hidden"),i.resume&&(i.resume.disabled=!0,i.resume.classList.add("hidden")),i.pause&&(i.pause.disabled=!0,i.pause.classList.remove("hidden")),i.restart&&(i.restart.disabled=!0,i.restart.classList.add("hidden")))):"Disconnected"===e.printerState.state?(""!==s&&i.row.classList.add(s),i.start&&(i.start.disabled=!0,i.start.classList.remove("hidden")),i.stop&&(i.stop.disabled=!0),i.resume&&(i.resume.disabled=!0,i.resume.classList.add("hidden")),i.pause&&(i.pause.disabled=!0,i.pause.classList.remove("hidden")),i.restart&&(i.restart.disabled=!0,i.restart.classList.add("hidden"))):"Offline"===e.printerState.colour.category&&(""!==l&&i.row.classList.add(l),i.start&&(i.start.disabled=!0,i.start.classList.remove("hidden")),i.stop&&(i.stop.disabled=!0),i.resume&&(i.resume.disabled=!0,i.resume.classList.add("hidden")),i.pause&&(i.pause.disabled=!0,i.pause.classList.remove("hidden")),i.restart&&(i.restart.disabled=!0,i.restart.classList.add("hidden")))}let Ne=!1;var De;["panel","list","camera","group","current-ops","combined"].includes(De="combined")||console.warn("Monitoring view: Unknown view type set"),t=De,function(t,n){if(window.Worker)try{null===p&&(f=n,m=t,g(t,n))}catch(e){d.createAlert("error","Sorry web workers are not supported in your browser, please check the supported browser list.",0),console.error(`Couldn't create the web worker, please log a github issue... <br> ${e}`)}else d.createAlert("error","Sorry web workers are not supported in your browser, please check the supported browser list.",0),console.error(`Web workers not available... sorry! <br> ${e}`);document.addEventListener("visibilitychange",h,!1)}("/monitoringInfo/get/",(async function(e){if(e){const t=e.printersInformation;if(o(t,e.printerControlList),Ne||(Ne=document.getElementById("printerManagerModal")),await async function(e,t,n){switch(ke.classList.contains("show")){case!0:Me.innerHTML.includes("Files")?await fe.init("",e,s()):Me.innerHTML.includes("Control")?await ue.init("",e,s()):Me.innerHTML.includes("Terminal")&&await Ie.init("",e,s());break;case!1:for(let r=0;r<e.length;r++)if(!e[r].disabled){let i=document.getElementById("panel-"+e[r]._id);if(i)ke.classList.contains("show")||(V||await Fe(e[r],t,n,r),Ce>=2e4?Ce=0:Ce+=500);else{{let n=Le(e[r],t);$e.insertAdjacentHTML("beforeend",n)}i=document.getElementById("panel-"+e[r]._id),await be(e[r],`printerActionBtns-${e[r]._id}`),He(e[r]),await Re(e[r]),await G(i,e[r])}}}}(t,e.clientSettings,"combined"),e.clientSettings.views.currentOperations){const n=e.currentOperations;!function(e,t,n){P=n,0===e.length&&document.querySelectorAll("[id^='currentOpCard-']").forEach((e=>{e.remove()})),document.getElementById("completeCount").innerHTML="Complete: "+t.complete,document.getElementById("idleCount").innerHTML="Idle: "+t.idle,document.getElementById("activeCount").innerHTML="Active: "+t.active,document.getElementById("disconCount").innerHTML="Disconnected: "+t.disconnected,document.getElementById("offlineCount").innerHTML="Offline: "+t.offline,document.getElementById("farmProgress").innerHTML=t.farmProgress+"%",document.getElementById("farmProgress").style=`width: ${t.farmProgress}%`,document.getElementById("farmProgress").classList=`progress-bar progress-bar-striped bg-${t.farmProgressColour}`,e.forEach(((t,n)=>{let r=new Date;r=r.getTime();const i=new Date(r+1e3*t.timeRemaining).toDateString();let o=new Date(r+1e3*t.timeRemaining).toTimeString();o=o.substring(0,8);const a=i+": "+o,s=`<button id='currentHarvest-${t.index}' type='button' title="Clear your finished print from current operations" class='tag btn btn-success btn-sm mt-0 pt-0 pb-0'>Print Harvested?</button>`,l=`<button id='restartCurrentPrint-${t.index}' type='button' title="Restart your current selected print" class='tag btn btn-warning btn-sm mt-0 pt-0 pb-0'>Restart Print</button>`;let c=null;if(void 0!==typeof t.fileName&&(c=t.fileName.replace(".gcode",""),c.length>15&&c.substring(0,16)),document.getElementById("currentOpCard-"+t.index)){100===t.progress?(document.getElementById("finishedPrint-"+t.index).classList.remove("d-none"),document.getElementById("futureDate-"+t.index).classList.add("d-none"),document.getElementById("currentRestart-"+t.index).classList.remove("d-none"),document.getElementById("currentTime-"+t.index).classList.add("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.add("d-none")):(document.getElementById("finishedPrint-"+t.index).classList.add("d-none"),document.getElementById("futureDate-"+t.index).classList.remove("d-none"),document.getElementById("currentRestart-"+t.index).classList.add("d-none"),document.getElementById("currentTime-"+t.index).classList.remove("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.remove("d-none"));const e=document.getElementById("currentProgress-"+t.index);document.getElementById("currentTime-"+t.index).innerHTML=b.generateTime(t.timeRemaining),e.style=`width: ${t.progress}%`,e.innerHTML=t.progress+"%",e.className=`progress-bar progress-bar-striped bg-${t.progressColour}`}else document.getElementById("currentOperationsBody").insertAdjacentHTML("beforeend",`\n                <div id="currentOpCard-${t.index}"\n                class="card card-block text-white bg-secondary d-inline-block  text-truncate"\n                style="min-width: 200px; max-width: 200px;"\n              >\n                  <div class="card-header pb-1 pt-1 pl-2 pr-2">\n                     ${t.name}</div>\n                  <div class="card-body  pb-0 pt-2 pl-2 pr-2">\n                  <h6 id="currentFile-${t.index}" class="pb-0 text-center" style="font-size:0.6rem;"> ${c} </h6>\n                  <h6 id="currentRestart-${t.index}" class="pb-0 text-center d-none" style="font-size:0.6rem;">${l}</h6>\n                  <h6 id="currentTime-${t.index}" class="pb-0 text-center" style="font-size:0.6rem;">${b.generateTime(t.timeRemaining)}</h6>\n        <h6 id="futureDate-${t.index}" class="pb-0 text-center" style="font-size:0.6rem;"> ${a} </h6>\n        <h6 id="finishedPrint-${t.index}" class="pb-0 text-center d-none" style="font-size:0.6rem;"> ${s} </h6>\n                    <div id="currentProgressMain-${t.index}" class="progress">\n                      <div id="currentProgress-${t.index}"\n                        class="progress-bar progress-bar-striped bg-${t.progressColour}"\n                        role="progressbar"\n                        style="width: ${t.progress}%"\n                        aria-valuenow="${t.progress}"\n                        aria-valuemin="0"\n                        aria-valuemax="100"\n                      >\n                      ${t.progress}%\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                `),document.getElementById("currentHarvest-"+t.index).addEventListener("click",(e=>{const n=document.getElementById("currentHarvest-"+t.index).id.split("-");C(n[1])})),document.getElementById("restartCurrentPrint-"+t.index).addEventListener("click",(e=>{const n=document.getElementById("restartCurrentPrint-"+t.index).id.split("-");k(n[1])}));document.getElementById("currentOpCard-"+t.index).style.order=n;const u=document.querySelectorAll("[id^='currentOpCard-']"),d=[];e.forEach((e=>{d.push(e.index)}));const p=[];u.forEach((e=>{const t=e.id.split("-");p.push(t[1])})),_.difference(p,d).forEach((e=>{document.getElementById("currentOpCard-"+e).remove()}))}))}(n.operations,n.count,t)}}}))})()})();
//# sourceMappingURL=combined-view.runner.min.js.map